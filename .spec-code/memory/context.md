---
name: context
description: 项目上下文 - 当前技术栈和项目状态
created_at: 2025-12-19
author: AI Assistant
---

# 项目上下文

## 项目概述

SQL Tool 是一个 MySQL 数据库客户端工具，提供数据库连接管理、SQL 编辑、查询执行和结果展示等功能。

### 核心功能

1. **数据库连接管理**: 新建、编辑、删除连接，连接信息加密存储
2. **SQL 编辑器**: 语法高亮、自动联想、语法错误识别
3. **查询执行**: 批量执行、执行计划、超时控制
4. **结果展示**: 多结果集标签页、消息区、执行计划图

## 活跃技术栈

| 类别 | 技术 | 版本 |
|------|------|------|
| **桌面框架** | Electron | 28.x+ |
| **前端框架** | Vue 3 | 3.4+ |
| **UI 组件库** | Element Plus | 2.4+ |
| **状态管理** | Pinia | 2.x |
| **构建工具** | Vite | 5.x |
| **SQL 编辑器** | Monaco Editor | 0.45+ |
| **MySQL 客户端** | mysql2 | 3.x |
| **加密库** | crypto-js | 4.x |
| **打包工具** | electron-builder | 24.x |

### 打包

- Windows: 免安装包 (portable)
- macOS: DMG 安装包

## 项目结构

```
sql-tool-v2/
├── .codebuddy/              # CodeBuddy 配置
├── .spec-code/              # 项目规范
│   └── memory/              # 项目记忆
├── requirements/            # 需求文档
│   ├── constitution.md      # 项目概述
│   ├── ba-requirements/     # 业务需求
│   └── ui/                  # UI 需求
├── workspace/               # 工作空间
│   └── 2025-12-19-sql-tool/ # 当前变更
│       ├── requirements/    # 需求阶段文档
│       └── design/          # 设计阶段文档
│           └── architecture.md
└── src/                     # 源代码 (待创建)
    ├── main/                # Electron 主进程
    │   ├── database/        # 数据库模块
    │   ├── storage/         # 存储模块
    │   └── ipc/             # IPC 处理
    ├── preload/             # 预加载脚本
    ├── renderer/            # 渲染进程 (Vue 应用)
    │   ├── components/      # 公共组件
    │   ├── config/          # 配置模块 (主题等)
    │   ├── stores/          # Pinia 状态
    │   ├── utils/           # 工具函数
    │   └── styles/          # 样式文件
    └── shared/              # 共享代码
```

## 当前开发阶段

### Phase 1: 需求分析 ✅ 已完成

- [x] 项目概述定义
- [x] 技术栈确定
- [x] 功能需求文档
- [x] UI 需求文档
- [x] UI 原型设计
- [x] 需求澄清
- [x] 需求审查

### Phase 2: 设计阶段 ✅ 已完成

- [x] 架构设计
- [x] 功能详细设计
- [x] 实体设计 - **不需要**（纯客户端应用，无复杂业务领域）

### Phase 3: 开发阶段 ✅ 已完成

- [x] 项目脚手架搭建
- [x] 核心功能开发
- [x] UI 实现
- [ ] 测试

## 当前优先级

1. 安装依赖并运行测试
2. 修复可能的问题
3. 功能测试

## 最近变更

| 日期 | 变更内容 |
|------|----------|
| 2026-01-16 | RC-007-4: 结果表格增加右键"查看"功能，支持原始值/JSON/XML格式化显示 |
| 2026-01-16 | RC-007-3: 结果表格日期格式化，支持 DATE/DATETIME/TIME/TIMESTAMP/YEAR 类型的格式化显示 |
| 2026-01-16 | RC-007-2: 支持 DATETIME/TIME/TIMESTAMP 类型的小数秒精度(fsp)参数，修改 `database.ts` 和 `TableDesignDialog.vue` |
| 2026-01-16 | RC-007-1: Monaco Editor 主题模块化，新增 `src/renderer/config/monaco-theme.ts`，字符串颜色改为橙色 `#f5b801` |
| 2025-12-19 | 创建项目需求文档 |
| 2025-12-19 | 完成 UI 原型设计 |
| 2025-12-19 | 完成需求澄清和审查 |
| 2025-12-19 | 初始化项目记忆 |
| 2025-12-19 | 完成架构设计 |
| 2025-12-19 | 完成功能详细设计 |
| 2025-12-19 | 完成项目脚手架和核心功能开发 |

## 关键决议

### 需求澄清决议

| 编号 | 问题 | 决议 |
|------|------|------|
| 1 | 密码是否必填 | 必填 |
| 2 | 测试连接失败处理 | 允许直接保存，无需测试 |
| 3 | 多 SQL 执行策略 | 批量执行，遇错停止 |
| 4 | 结果显示方式 | 多结果集标签页 |
| 5 | 自动联想触发时机 | 实时自动触发 |
| 6 | 语法错误反馈 | 红色波浪线 + 悬浮提示 |
| 7 | 停止执行行为 | 仅中断，不回滚 |

### 技术决议

| 编号 | 问题 | 决议 |
|------|------|------|
| 1 | 服务地址格式 | host:port |
| 2 | 端口默认值 | 3306 |
| 3 | 执行超时时间 | 默认 10 分钟 |
| 4 | 结果集最大行数 | 默认 5000 行，用户可修改 |
| 5 | 加密算法 | AES 对称加密 |
| 6 | 执行计划展示 | 流程图形式 |

### 架构决议

| 编号 | 决策 | 理由 |
|------|------|------|
| ADR-001 | SQL 编辑器使用 Monaco Editor | VS Code 同款，内置 SQL 支持，社区活跃 |
| ADR-002 | 数据库连接使用 mysql2 | Promise API，性能优于 mysql 包 |

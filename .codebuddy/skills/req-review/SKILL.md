---
name: req-review
description: 对功能需求进行6维度质量扫描（一致性、完整性、清晰性、准确性、无重复性、可验证性），将问题直接嵌入FR确认项
category: requirements
keywords: [需求评审, 质量检查, 完整性检查, 可行性分析, 评审清单]
---

# Skill: 需求审查

对功能需求进行系统化质量扫描，识别问题并嵌入到 FR 确认项中。

## 工作流程

1. **结构化建模** - 将原始需求转化为 FR、BR、数据模型、验收标准
2. **6维度扫描** - 一致性、完整性、清晰性、准确性、无重复性、可验证性
3. **问题归集** - 按 FR 编号嵌入问题到确认项
4. **单文件输出** - 仅维护 `workspace/{变更ID}/requirements/requirement-review.md`

**覆盖范围**: FR、BR、数据模型、验收标准  
**不覆盖**: 非功能需求（性能、安全、SLA、兼容性、可维护性）

## 前置条件

- 用户明确要求进行需求审查
- 已提供原始需求（PRD/TAPD/文档/文本）
- 已提供变更 ID（格式：`YYYY-MM-DD-feature-name`）

## 执行步骤

### 步骤 0: 合规检查

检查：
- [ ] 用户明确要求生成/更新需求文档？
- [ ] 提供变更 ID（格式：YYYY-MM-DD-feature-name）？

**不符合条件响应**:
```
❌ 缺少必要参数，需提供：
1. 需求来源
2. 变更 ID（格式：YYYY-MM-DD-feature-name）

示例: "审查需求: [来源]，变更ID: 2025-11-09-user-management"
```

### 步骤 1: 结构化建模

将原始需求转化为结构化文档：

1. 读取需求来源
2. 按模板提取：FR、BR、数据模型、验收标准
3. 创建 `workspace/{变更ID}/requirements/requirement-review.md`

**文档结构**:

```markdown
---
name: {需求名称}
change_id: {变更ID}
---

# 需求审查文档

## 1. 概述
需求来源、变更ID、利益相关者

## 2. 功能需求（FR）
### FR1: {功能名称}
- 描述、用户故事、输入输出
- 业务规则、验收标准
- **确认项**: 质量问题归集处

## 3. 业务规则（BR）
## 4. 数据模型（DM）
## 5. 异常处理
## 6. 测试策略
```

### 步骤 2: 6维度质量扫描

| 维度 | 检查要点 | 问题示例 |
|------|---------|----------|
| **一致性** | 术语、数据、规则、系统一致性 | 术语"用户"/"客户"混用 |
| **完整性** | 功能、规则、数据、验收完整性 | 缺少异常处理规则 |
| **清晰性** | 描述、术语、验收清晰性 | "尽量快速"→改为"<200ms" |
| **准确性** | 业务、数据、规则准确性 | 计算逻辑未考虑折扣 |
| **无重复性** | 功能、规则无冗余 | FR1/FR3重复定义登录 |
| **可验证性** | 验收标准、测试场景可测试 | 缺少测试用例 |

**问题记录格式**:
```markdown
[P0/P1/P2-维度] {问题描述} - {建议方案}
```

### 步骤 3: 问题分级与映射

**优先级**:
- **P0**: 逻辑矛盾、数据冲突、关键场景缺失（阻塞性）
- **P1**: 需求不清晰、验收标准不可测（重要）
- **P2**: 术语不统一、描述不详细（优化）

**映射到 FR 确认项**:
```markdown
### FR1: 用户注册

**确认项**:
- [ ] [P0-准确性] 手机号验证未验证号段 - 建议补充13x/15x/18x验证
- [ ] [P1-完整性] 缺少邮箱格式验证
- [ ] [P2-清晰性] "密码强度"未明确 - 建议明确长度和字符类型
```

### 步骤 4: 风险评估

评估技术、业务、项目三维度风险，输出：

```markdown
## 7. 风险评估

### 整体评估
- **P0 问题**: {数量}
- **P1 问题**: {数量}  
- **P2 问题**: {数量}
- **整体风险**: 🔴高/🟡中/🟢低
- **建议**: {是否可进入设计阶段}
```

### 步骤 5: 写回结果

**操作**:
1. 更新 `workspace/{变更ID}/requirements/requirement-review.md`
2. 将问题按 FR 编号写入对应确认项
3. 保留原有确认项（不删除）
4. 已确认问题标记为 `[CLARIFIED]`
5. 更新 `updated_at` 时间戳

**写回规则**:
- ❌ 不得删除既有确认项
- ✅ 追加新问题，标记已确认为 `[CLARIFIED]`
- ✅ 更新时间戳

## 核心原则

1. **全面扫描** - 系统化执行6维度扫描
2. **客观评估** - 基于标准清单
3. **结构化输出** - 维护单一文件
4. **可操作建议** - 提供具体改进方案

## 最佳实践

**问题描述要具体**:
```markdown
✅ [P0-准确性] 订单金额=单价×数量，未考虑折扣 - 补充折扣计算逻辑
❌ [P0-准确性] 计算逻辑不完整 - 补充完整
```

**优先级判断要准确**:
```markdown
✅ [P2-清晰性] 术语"用户"/"客户"混用，建议统一
❌ [P0-清晰性] 术语混用
```

**配合需求澄清技能**:
```bash
# 1. 先澄清
/req-clarify "分析需求: {来源}"

# 2. 再审查
/req-review "审查需求: {来源}，变更ID: {变更ID}"

# 3. 将澄清结论写回确认项
```

## 常见错误

| 错误 | 症状 | 解决 |
|------|------|------|
| 忽略合规检查 | 未经要求就生成文档 | 检查用户明确要求和变更ID |
| 扫描维度不全 | 仅检查部分维度 | 严格按6维度清单执行 |
| 优先级不准确 | 所有问题标P0 | 遵循P0/P1/P2定义标准 |
| 删除既有内容 | 更新时删除原确认项 | 只追加不删除，标记已确认 |
| 生成独立报告 | 生成review-report.md | 仅维护单一文件 |
| 涉及非功能需求 | 扫描性能/安全要求 | 明确不覆盖NFR |

## AI执行检查清单

- [ ] 检查用户明确要求生成/更新文档
- [ ] 完成6维度质量扫描
- [ ] 识别问题并分级(P0/P1/P2)
- [ ] 评估技术/业务/项目风险
- [ ] 将问题写入对应FR确认项
- [ ] 未删除既有确认项
- [ ] 已确认问题标记为 `[CLARIFIED]`
- [ ] 更新时间戳
- [ ] 向用户说明主要问题和风险等级

## 使用示例

**命令格式**: 
```
"审查需求: [需求来源]，变更ID: [YYYY-MM-DD-feature-name]"
```

**示例**:
```
"审查需求: https://tapd.xxx/story/1234，变更ID: 2025-11-09-user-management"
"审查需求: ./docs/requirements.md，变更ID: 2025-11-09-payment-feature"
```

## 常见问题

**Q1: 如何判断是否需要生成需求文档？**  
A: 必须满足：1) 用户明确要求；2) 提供有效变更 ID

**Q2: 6维度扫描和需求澄清有什么区别？**  
A: 审查聚焦**质量问题识别**，澄清聚焦**模糊点澄清**，推荐配合使用

**Q3: 如何处理非功能性需求？**  
A: 本技能不覆盖NFR（性能、安全、可用性等），建议使用专门技能

**Q4: 如何避免删除既有内容？**  
A: 遵循"只追加不删除"原则，已确认问题标记 `[CLARIFIED]`

**Q5: 审查后如何判断是否可进入设计阶段？**  
A: P0=0，P1<5，整体风险=🟢/🟡 → 可进入设计

## 相关技能

- [req-clarify](mdc:skills/req-clarify/SKILL.md) - 需求澄清
- [req-breakdown](mdc:skills/req-breakdown/SKILL.md) - 需求拆解
- [design-feature](mdc:skills/design-feature/SKILL.md) - 功能设计

## 版本历史

- **v2.2** (2025-11-10): 最佳实践优化
  - 大幅简化内容，去除过度解释
  - 优化表格呈现，提高信息密度
  - 精简FAQ和示例，保留核心内容
  - 遵循 Claude Skill 最佳实践原则

- **v2.1** (2025-11-09): 综合优化版本
  - 综合 V1 和 V2 优势
  - 精简重复内容，提高可读性
  - 优化表格呈现，提升信息密度
  - 新增 `allowed-tools` 声明

- **v2.0** (2025-11-07): 专业化版本
  - 聚焦功能性需求审查
  - 引入6维度质量扫描
  - 强化项目记忆和规范引用

- **v1.0** (2025-11-04): 初始版本
  - 基础需求审查功能
  - 单文件输出
  - 问题嵌入到 FR 确认项

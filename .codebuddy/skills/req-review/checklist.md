---
title: req-review 检查清单
description: 需求审查完成后的验证清单
---

# 需求审查检查清单

## 前置条件检查

- [ ] 用户明确要求进行需求审查（不得主动生成文档）
- [ ] 已提供需求来源（PRD/TAPD/文档/文本）
- [ ] 已提供变更 ID（格式：`YYYY-MM-DD-feature-name`）
- [ ] 已创建输出目录（`workspace/{变更ID}/requirements/`）
- [ ] 已了解项目规范（参考 [开发指南](mdc:.spec-code/memory/guidelines.md)）

## 步骤 0: 合规检查 - 质量检查

### 必要参数验证

- [ ] 用户明确要求生成或更新需求审查文档
- [ ] 变更 ID 格式正确（YYYY-MM-DD-feature-name）
- [ ] 需求来源已提供（URL/文件路径/文本）

### 不符合条件处理

- [ ] 如缺少参数，输出标准提示（见 SKILL.md 步骤 0）
- [ ] 不得在未经要求时主动生成文档

## 步骤 1: 结构化建模 - 质量检查

### 1.1 读取需求来源

**需求来源类型验证**:
- [ ] TAPD 需求链接（使用 `web_fetch` 或 MCP 工具读取）
- [ ] 本地文件路径（使用 `read_file` 读取）
- [ ] 用户直接提供的文本内容

**读取完整性验证**:
- [ ] 需求内容读取成功
- [ ] 需求内容长度 > 100 字符（避免空需求）
- [ ] 需求内容包含关键信息（功能描述、业务规则等）

### 1.2 提取结构化内容

**功能需求（FR）提取**:
- [ ] 识别所有功能点（至少 1 个 FR）
- [ ] 每个 FR 包含：编号、名称、描述
- [ ] 每个 FR 包含：用户故事、输入、输出
- [ ] 每个 FR 包含：前置条件、后置条件
- [ ] 每个 FR 包含：业务规则引用
- [ ] 每个 FR 包含：验收标准

**业务规则（BR）提取**:
- [ ] 识别所有业务规则（至少 1 个 BR）
- [ ] 每个 BR 包含：编号、名称、描述
- [ ] 每个 BR 包含：验证规则、约束条件
- [ ] BR 编号与 FR 关联正确

**数据模型（DM）提取**:
- [ ] 识别所有实体（至少 1 个实体）
- [ ] 每个实体包含：字段名、类型、约束
- [ ] 实体间关系已定义（一对多、多对多）
- [ ] 索引定义已提取（主键、唯一索引、普通索引）

**验收标准提取**:
- [ ] 每个 FR 至少有 1 个验收标准
- [ ] 验收标准具体可测试
- [ ] 验收标准覆盖正常场景和异常场景

**异常处理提取**:
- [ ] 识别所有异常场景（至少 1 个异常）
- [ ] 每个异常包含：场景、错误码、错误消息、处理方式
- [ ] 异常场景覆盖输入错误、业务错误、系统错误

**测试策略提取**:
- [ ] 定义功能测试策略
- [ ] 定义异常测试策略
- [ ] 定义性能测试策略（如适用）
- [ ] 定义安全测试策略（如适用）

### 1.3 创建需求审查文档

**文档结构完整性**:
- [ ] 文档路径正确（`workspace/{变更ID}/requirements/requirement-review.md`）
- [ ] YAML 元数据完整（name、change_id、created_at、updated_at）
- [ ] 文档标题正确（`# 需求审查文档`）
- [ ] 包含 7 个完整章节：
  - [ ] 1. 概述
  - [ ] 2. 功能需求（FR）
  - [ ] 3. 业务规则（BR）
  - [ ] 4. 数据模型（DM）
  - [ ] 5. 异常处理
  - [ ] 6. 测试策略
  - [ ] 7. 风险评估

**文档格式规范**:
- [ ] Markdown 格式正确（标题、列表、表格、代码块）
- [ ] 每个 FR 有独立的三级标题（`### FR1: {功能名称}`）
- [ ] 每个 FR 包含 `**确认项**:` 章节（用于嵌入问题）
- [ ] 表格格式正确（表头、分隔符、数据行）

**常见错误检查**:
- [ ] ❌ 未创建文档就进行扫描
- [ ] ❌ 文档路径错误（未使用 workspace/{变更ID}/）
- [ ] ❌ YAML 元数据缺失或格式错误
- [ ] ❌ 缺少 FR 确认项章节
- [ ] ❌ 中文乱码（文件编码非 UTF-8）

---

## 步骤 2: 6维度质量扫描 - 质量检查

### 2.1 一致性扫描（Consistency）

**术语一致性**:
- [ ] 扫描所有 FR、BR、DM 中的术语
- [ ] 识别同义词混用（如"用户"/"客户"）
- [ ] 识别术语未定义的情况
- [ ] 识别术语定义冲突的情况

**数据一致性**:
- [ ] 扫描所有数据定义（字段类型、长度、格式）
- [ ] 识别同一数据在不同地方定义不一致
- [ ] 识别数据格式冲突（如日期格式）
- [ ] 识别数据精度冲突（如金额精度）

**规则一致性**:
- [ ] 扫描所有业务规则
- [ ] 识别规则之间的逻辑冲突
- [ ] 识别规则与实现的不一致
- [ ] 识别规则优先级冲突

**系统边界一致性**:
- [ ] 扫描功能边界定义
- [ ] 识别功能职责不清晰的情况
- [ ] 识别跨系统调用未定义的情况
- [ ] 识别接口边界模糊的情况

**问题记录格式验证**:
- [ ] 问题描述格式正确：`[P0/P1/P2-一致性] {问题描述} - {建议方案}`
- [ ] 优先级标注正确（P0/P1/P2）
- [ ] 建议方案具体可操作

**常见问题识别**:
- [ ] [P2-一致性] 术语混用（如"用户"/"客户"）
- [ ] [P1-一致性] 数据定义不一致（如密码长度）
- [ ] [P0-一致性] 规则逻辑冲突（如状态转换冲突）

### 2.2 完整性扫描（Completeness）

**功能完整性**:
- [ ] 扫描所有用户故事
- [ ] 识别关键功能缺失（如"注册后自动登录"缺少登录功能）
- [ ] 识别功能步骤不完整（如缺少异常处理步骤）
- [ ] 识别功能依赖未定义（如依赖第三方服务未说明）

**业务规则完整性**:
- [ ] 扫描所有业务规则
- [ ] 识别规则细节缺失（如手机号验证未明确号段）
- [ ] 识别边界条件缺失（如最大值、最小值）
- [ ] 识别规则例外未定义（如特殊情况处理）

**数据模型完整性**:
- [ ] 扫描所有实体和字段
- [ ] 识别关键字段缺失（如 created_at、updated_at）
- [ ] 识别索引缺失（如唯一索引）
- [ ] 识别关联关系缺失（如外键关系）

**异常处理完整性**:
- [ ] 扫描所有异常场景
- [ ] 识别异常场景缺失（如网络超时、数据库异常）
- [ ] 识别异常处理逻辑缺失（如重试、降级）
- [ ] 识别错误码定义缺失

**验收标准完整性**:
- [ ] 扫描所有验收标准
- [ ] 识别验收标准缺失（如缺少失败场景验收）
- [ ] 识别验收标准不完整（如只覆盖正常场景）
- [ ] 识别验收标准模糊（如"系统响应正常"）

**问题记录格式验证**:
- [ ] 问题描述格式正确：`[P0/P1/P2-完整性] {问题描述} - {建议方案}`

**常见问题识别**:
- [ ] [P0-完整性] 关键功能缺失（如登录功能未定义）
- [ ] [P1-完整性] 业务规则细节缺失（如号段验证）
- [ ] [P1-完整性] 异常场景缺失（如超时处理）
- [ ] [P2-完整性] 可选字段缺失（如 email 字段）

### 2.3 清晰性扫描（Clarity）

**描述清晰性**:
- [ ] 扫描所有描述文本
- [ ] 识别模糊描述（如"尽量快速"、"足够强"）
- [ ] 识别歧义描述（如"可能"、"应该"）
- [ ] 识别专业术语未解释的情况

**术语清晰性**:
- [ ] 扫描所有术语定义
- [ ] 识别术语未定义的情况
- [ ] 识别术语定义模糊的情况
- [ ] 识别术语使用不一致的情况

**验收标准清晰性**:
- [ ] 扫描所有验收标准
- [ ] 识别验收标准模糊（如"系统响应正常"）
- [ ] 识别验收标准不可测试（如"用户满意"）
- [ ] 识别验收标准缺少量化指标（如"响应快"）

**度量标准清晰性**:
- [ ] 扫描所有度量标准
- [ ] 识别度量标准模糊（如"较少"、"较多"）
- [ ] 识别度量标准缺少单位（如时间、数量）
- [ ] 识别度量标准缺少阈值（如最大值、最小值）

**问题记录格式验证**:
- [ ] 问题描述格式正确：`[P0/P1/P2-清晰性] {问题描述} - {建议方案}`
- [ ] 建议方案提供明确的量化标准

**常见问题识别**:
- [ ] [P1-清晰性] 模糊描述（如"密码要求足够强" → "密码8-20位，含字母和数字"）
- [ ] [P1-清晰性] 缺少量化指标（如"响应快" → "< 200ms"）
- [ ] [P0-清晰性] 验收标准模糊（如"系统正常" → "HTTP 200，包含用户信息"）

### 2.4 准确性扫描（Accuracy）

**业务逻辑准确性**:
- [ ] 扫描所有业务逻辑
- [ ] 识别业务逻辑错误（如计算公式错误）
- [ ] 识别业务场景遗漏（如未考虑折扣）
- [ ] 识别业务规则冲突（如优先级冲突）

**数据验证准确性**:
- [ ] 扫描所有数据验证规则
- [ ] 识别验证规则不准确（如正则表达式错误）
- [ ] 识别验证范围不准确（如边界值错误）
- [ ] 识别验证逻辑缺失（如未考虑时区）

**计算逻辑准确性**:
- [ ] 扫描所有计算公式
- [ ] 识别计算公式错误（如金额计算未考虑精度）
- [ ] 识别计算步骤缺失（如未考虑折扣）
- [ ] 识别计算顺序错误（如先折扣后满减）

**状态机准确性**:
- [ ] 扫描所有状态转换
- [ ] 识别状态转换错误（如缺少状态）
- [ ] 识别状态转换条件错误（如缺少前置条件）
- [ ] 识别状态回退未定义（如取消订单后库存恢复）

**并发安全性**:
- [ ] 扫描所有并发场景
- [ ] 识别并发控制缺失（如验证码发送重复）
- [ ] 识别分布式锁缺失（如库存扣减）
- [ ] 识别事务隔离级别不准确

**问题记录格式验证**:
- [ ] 问题描述格式正确：`[P0/P1/P2-准确性] {问题描述} - {建议方案}`

**常见问题识别**:
- [ ] [P0-准确性] 并发控制缺失（如验证码发送重复）
- [ ] [P1-准确性] 业务逻辑错误（如计算公式错误）
- [ ] [P1-准确性] 验证规则不准确（如正则表达式错误）
- [ ] [P2-准确性] 边界条件未考虑（如国际号码）

### 2.5 无重复性扫描（Non-Redundancy）

**功能重复**:
- [ ] 扫描所有功能需求（FR）
- [ ] 识别功能定义重复（如 FR1 和 FR3 都定义登录）
- [ ] 识别功能步骤重复（如多处定义同一验证）
- [ ] 识别功能描述冗余（如重复说明同一规则）

**业务规则重复**:
- [ ] 扫描所有业务规则（BR）
- [ ] 识别规则定义重复（如 BR1 和 BR6 都定义格式验证）
- [ ] 识别规则约束重复（如多处定义同一约束）
- [ ] 识别规则描述冗余（如重复说明同一逻辑）

**数据模型重复**:
- [ ] 扫描所有数据模型（DM）
- [ ] 识别字段定义重复（如多个表定义同一字段）
- [ ] 识别实体定义重复（如重复定义同一实体）
- [ ] 判断数据冗余是否合理（如冗余缓存）

**验收标准重复**:
- [ ] 扫描所有验收标准
- [ ] 识别验收条件重复（如多处定义同一验收）
- [ ] 识别测试用例重复（如重复测试同一场景）

**问题记录格式验证**:
- [ ] 问题描述格式正确：`[P0/P1/P2-无重复性] {问题描述} - {建议方案}`
- [ ] 建议方案提供合并或统一的方案

**常见问题识别**:
- [ ] [P2-无重复性] 功能重复（如 FR1/FR2 都提到手机号验证）
- [ ] [P2-无重复性] 业务规则重复（如 BR1/BR6 都提到格式验证）
- [ ] [P2-无重复性] 描述冗余（如多处重复说明同一逻辑）

### 2.6 可验证性扫描（Testability）

**验收标准可测试性**:
- [ ] 扫描所有验收标准
- [ ] 识别验收标准不可测试（如"用户满意"）
- [ ] 识别验收标准缺少测试数据（如测试手机号）
- [ ] 识别验收标准缺少测试步骤（如操作流程）

**测试场景覆盖**:
- [ ] 扫描所有测试策略
- [ ] 识别测试场景缺失（如并发测试）
- [ ] 识别测试场景不完整（如只测正常场景）
- [ ] 识别测试场景冗余（如重复测试）

**测试数据准备**:
- [ ] 扫描所有测试数据要求
- [ ] 识别测试数据未定义（如测试手机号）
- [ ] 识别测试数据不可用（如需要真实验证码）
- [ ] 识别测试数据清理未定义（如测试后清理）

**自动化测试**:
- [ ] 扫描自动化测试策略
- [ ] 识别自动化测试缺失（如未定义单元测试）
- [ ] 识别自动化测试不可实现（如依赖外部服务）
- [ ] 识别自动化测试成本高（如需要复杂环境）

**问题记录格式验证**:
- [ ] 问题描述格式正确：`[P0/P1/P2-可验证性] {问题描述} - {建议方案}`

**常见问题识别**:
- [ ] [P1-可验证性] 验收标准不可测试（如"系统响应正常"）
- [ ] [P1-可验证性] 测试场景缺失（如并发测试）
- [ ] [P2-可验证性] 测试数据未定义（如测试手机号）

### 2.7 扫描完整性验证

**6维度扫描完整性**:
- [ ] 一致性扫描已完成（术语、数据、规则、系统边界）
- [ ] 完整性扫描已完成（功能、规则、数据、异常、验收）
- [ ] 清晰性扫描已完成（描述、术语、验收、度量）
- [ ] 准确性扫描已完成（业务逻辑、数据验证、计算逻辑、状态机、并发安全）
- [ ] 无重复性扫描已完成（功能、规则、数据、验收）
- [ ] 可验证性扫描已完成（验收标准、测试场景、测试数据、自动化测试）

**问题识别数量验证**:
- [ ] 至少识别 1 个问题（如果需求完美，标注"无问题"）
- [ ] 问题数量合理（通常 10-50 个）
- [ ] P0 问题数量 <= 5（否则需求质量太差）
- [ ] P1 问题数量 <= 20（否则需求质量太差）

**问题分布验证**:
- [ ] 每个维度至少扫描（6 个维度都要扫描）
- [ ] 问题分布合理（不是所有问题都集中在一个维度）
- [ ] 高优先级问题有理由（P0 问题必须是阻塞性的）

**常见错误检查**:
- [ ] ❌ 只扫描部分维度（如只扫描一致性）
- [ ] ❌ 所有问题标 P0（优先级不准确）
- [ ] ❌ 问题描述不具体（如"逻辑不完整"）
- [ ] ❌ 缺少建议方案（问题描述后没有建议）

---

## 步骤 3: 问题分级与映射 - 质量检查

### 3.1 问题统计

**统计数据准确性**:
- [ ] P0 问题数量正确
- [ ] P1 问题数量正确
- [ ] P2 问题数量正确
- [ ] 总计 = P0 + P1 + P2

**统计表格格式**:
```markdown
| 优先级 | 数量 | 占比 |
|--------|------|------|
| P0 | {数量} | {占比}% |
| P1 | {数量} | {占比}% |
| P2 | {数量} | {占比}% |
| **总计** | **{总计}** | **100%** |
```

- [ ] 表格格式正确
- [ ] 占比计算正确（占比 = 数量 / 总计 * 100%）
- [ ] 占比总和 = 100%

### 3.2 问题映射到 FR 确认项

**映射规则验证**:
- [ ] 每个问题都映射到对应的 FR/BR/DM 确认项
- [ ] 问题格式正确：`- [ ] [P0/P1/P2-维度] {问题描述} - {建议方案}`
- [ ] 问题排序正确（P0 在前，P2 在后）
- [ ] 同一 FR 的问题归集在一起

**确认项完整性**:
- [ ] 每个 FR 都有确认项章节（即使无问题）
- [ ] 确认项格式正确（Markdown 复选框）
- [ ] 确认项描述具体可操作

**映射示例验证**:

```markdown
### FR1: 手机号注册

**确认项**:
- [ ] [P0-完整性] 注册成功后自动登录，缺少登录逻辑定义 - 建议补充登录功能 FR
- [ ] [P1-一致性] 密码存储格式未明确 - 建议补充BCrypt加密说明
- [ ] [P1-清晰性] "注册成功后自动登录"未定义登录状态 - 明确"返回 JWT Token"
- [ ] [P2-无重复性] FR1/FR2 均提到"手机号格式验证" - 合并到 BR1
```

- [ ] 确认项格式正确
- [ ] 优先级标注正确（P0/P1/P2）
- [ ] 维度标注正确（一致性/完整性/清晰性/准确性/无重复性/可验证性）
- [ ] 问题描述具体
- [ ] 建议方案可操作

**常见错误检查**:
- [ ] ❌ 问题未映射到 FR 确认项（孤立问题）
- [ ] ❌ 确认项格式错误（如缺少 `[ ]`）
- [ ] ❌ 优先级标注错误（如 P0 问题标为 P2）
- [ ] ❌ 建议方案缺失或不具体

### 3.3 优先级判断验证

**P0 问题（阻塞性）验证**:
- [ ] P0 问题数量 <= 5（如果 > 5，需求质量太差）
- [ ] 每个 P0 问题都是阻塞性的（逻辑矛盾、数据冲突、关键场景缺失）
- [ ] P0 问题必须立即解决（否则无法进入设计阶段）

**P1 问题（重要）验证**:
- [ ] P1 问题数量 <= 20（如果 > 20，需求质量太差）
- [ ] 每个 P1 问题都是重要的（需求不清晰、验收标准不可测）
- [ ] P1 问题影响开发进度（需要澄清后才能开发）

**P2 问题（优化）验证**:
- [ ] 每个 P2 问题都是优化性的（术语不统一、描述不详细）
- [ ] P2 问题不影响功能实现（可以在开发过程中优化）

**优先级判断标准**:

| 优先级 | 定义 | 示例 |
|--------|------|------|
| P0 | 逻辑矛盾、数据冲突、关键场景缺失 | 登录功能缺失、并发控制缺失 |
| P1 | 需求不清晰、验收标准不可测 | 密码强度未明确、验证码有效期未定义 |
| P2 | 术语不统一、描述不详细 | 术语混用、可选字段缺失 |

- [ ] 所有问题符合优先级定义标准

**常见错误检查**:
- [ ] ❌ 所有问题标 P0（优先级不准确）
- [ ] ❌ P0 问题不是阻塞性的（如术语混用标为 P0）
- [ ] ❌ P1 问题太多（> 20 个，需优化需求质量）

---

## 步骤 4: 风险评估 - 质量检查

### 4.1 问题分析

**P0 问题分析**:
- [ ] 列出所有 P0 问题（编号 + 简要描述）
- [ ] 每个 P0 问题有详细分析（影响范围、解决方案）
- [ ] P0 问题数量 <= 5

**P1 问题分析**:
- [ ] 按维度分组统计 P1 问题（一致性、完整性、清晰性、准确性、可验证性）
- [ ] 每个维度的 P1 问题数量
- [ ] P1 问题数量 <= 20

**P2 问题分析**:
- [ ] 按维度分组统计 P2 问题
- [ ] P2 问题不影响功能实现

### 4.2 风险等级判断

**技术风险评估**:
- [ ] 评估技术复杂度（🔴 高 / 🟡 中 / 🟢 低）
- [ ] 列出技术难点（如并发控制、分布式锁）
- [ ] 列出技术依赖（如 Redis、第三方服务）

**业务风险评估**:
- [ ] 评估业务复杂度（🔴 高 / 🟡 中 / 🟢 低）
- [ ] 列出业务难点（如状态机、计算逻辑）
- [ ] 列出业务依赖（如外部数据、业务规则）

**项目风险评估**:
- [ ] 评估项目风险（🔴 高 / 🟡 中 / 🟢 低）
- [ ] 列出项目影响（如开发进度、测试成本）
- [ ] 列出资源需求（如开发人员、测试环境）

**风险等级标准**:

| 风险等级 | P0 问题 | P1 问题 | 整体评估 |
|---------|--------|--------|---------|
| 🔴 高 | > 0 | > 10 | 不可进入设计阶段 |
| 🟡 中 | = 0 | 5-10 | 需澄清 P1 问题后进入 |
| 🟢 低 | = 0 | < 5 | 可进入设计阶段 |

- [ ] 风险等级判断符合标准

### 4.3 整体评估

**评估报告结构**:

```markdown
## 7. 风险评估

### 整体评估
- **P0 问题**: {数量}
- **P1 问题**: {数量}
- **P2 问题**: {数量}
- **整体风险**: 🔴高/🟡中/🟢低
- **建议**: {是否可进入设计阶段}

### 关键风险点
1. **{风险点 1}**（{优先级}-{维度}）- {详细描述}
2. **{风险点 2}**（{优先级}-{维度}）- {详细描述}
3. **{风险点 3}**（{优先级}-{维度}）- {详细描述}

### 改进建议
1. **立即澄清 P0 问题**：{具体建议}
2. **优化 P1 问题**：{具体建议}
3. **优化 P2 问题**：{具体建议}

### 进入下一阶段条件
- P0 问题全部解决
- P1 问题解决率 >= {百分比}%
- 整体风险降至 🟢 低 或 🟡 中
```

- [ ] 评估报告结构完整
- [ ] 风险等级判断准确
- [ ] 建议具体可操作
- [ ] 进入下一阶段条件明确

**常见错误检查**:
- [ ] ❌ 风险等级判断不准确（如有 P0 问题但标为🟢低）
- [ ] ❌ 建议不具体（如"优化需求"）
- [ ] ❌ 缺少进入下一阶段条件

---

## 步骤 5: 写回结果 - 质量检查

### 5.1 更新需求审查文档

**文档更新规则**:
- [ ] ✅ 追加新问题到对应 FR 确认项
- [ ] ✅ 已确认问题标记为 `[CLARIFIED]`
- [ ] ✅ 更新时间戳（updated_at）
- [ ] ❌ 不得删除既有确认项

**确认项更新格式**:

```markdown
**确认项**:
- [x] [CLARIFIED] [P0-完整性] 注册成功后自动登录，缺少登录逻辑定义 - ✅ 已补充 FR4: 用户登录
- [ ] [P1-一致性] 密码存储格式未明确 - 建议补充BCrypt加密说明
- [ ] [P1-清晰性] "注册成功后自动登录"未定义登录状态 - 明确"返回 JWT Token"
```

- [ ] 已确认问题标记正确（`[x]` + `[CLARIFIED]`）
- [ ] 已确认问题有澄清说明（✅ + 解决方案）
- [ ] 未确认问题保持待办状态（`[ ]`）

**时间戳更新**:
```markdown
updated_at: 2025-11-10T15:30:00Z
```

- [ ] 时间戳格式正确（ISO 8601）
- [ ] 时间戳为当前时间（不是历史时间）

**常见错误检查**:
- [ ] ❌ 删除既有确认项（违反"只追加不删除"原则）
- [ ] ❌ 已确认问题未标记 `[CLARIFIED]`
- [ ] ❌ 时间戳未更新
- [ ] ❌ 中文乱码（文件编码非 UTF-8）

### 5.2 向用户反馈

**反馈内容结构**:

```
✅ 需求审查完成！

📄 **审查文档**: workspace/{变更ID}/requirements/requirement-review.md

📊 **问题统计**:
- 🔴 P0 问题: {数量} 个（阻塞性）
- 🟡 P1 问题: {数量} 个（重要）
- 🟢 P2 问题: {数量} 个（优化）
- **总计**: {总计} 个问题

⚠️ **整体风险**: 🔴高/🟡中/🟢低

{建议是否进入设计阶段}

💡 **下一步建议**:
1. {建议 1}
2. {建议 2}
3. {建议 3}
```

- [ ] 反馈内容完整（文档路径、问题统计、风险等级、下一步建议）
- [ ] 使用 Emoji 提高可读性（✅、📄、📊、⚠️、💡）
- [ ] 建议具体可操作
- [ ] 明确是否可进入设计阶段

**常见错误检查**:
- [ ] ❌ 反馈内容不完整（如缺少问题统计）
- [ ] ❌ 建议不具体（如"优化需求"）
- [ ] ❌ 未明确是否可进入设计阶段

---

## 最终验证清单

### 功能验证

- [ ] 合规检查已完成（用户明确要求、变更 ID 正确）
- [ ] 结构化建模已完成（FR、BR、DM、验收标准、异常处理、测试策略）
- [ ] 6维度扫描已完成（一致性、完整性、清晰性、准确性、无重复性、可验证性）
- [ ] 问题分级与映射已完成（P0/P1/P2、映射到 FR 确认项）
- [ ] 风险评估已完成（技术/业务/项目风险、整体评估）
- [ ] 写回结果已完成（更新文档、向用户反馈）

### 质量验证

- [ ] 文档结构完整（7 个完整章节）
- [ ] 文档格式正确（Markdown 格式、表格、代码块）
- [ ] 问题识别全面（6 个维度都已扫描）
- [ ] 问题描述具体（问题 + 建议方案）
- [ ] 优先级判断准确（P0/P1/P2 符合定义）
- [ ] 风险评估准确（风险等级符合标准）

### 输出验证

- [ ] 文档路径正确（`workspace/{变更ID}/requirements/requirement-review.md`）
- [ ] 文档编码正确（UTF-8，无中文乱码）
- [ ] 文档可读性好（格式清晰、逻辑连贯）
- [ ] 向用户反馈完整（问题统计、风险等级、下一步建议）

### 规范验证

- [ ] 遵循 [项目宪章](mdc:.spec-code/memory/constitution.md) 的核心原则
- [ ] 遵循 [开发指南](mdc:.spec-code/memory/guidelines.md) 的需求规范
- [ ] 遵循 [文档生成原则](mdc:.codebuddy/spec/global/standards/common/document-generation-rules.md)

---

## 示例检查场景

### 场景 1: 用户注册功能审查（完整流程）

**验证要点**:
- [ ] 合规检查通过（用户明确要求、变更 ID: 2025-11-10-user-registration）
- [ ] 结构化建模完整（FR1-FR3、BR1-BR6、User 表、VerificationCode 表）
- [ ] 6维度扫描完整（识别 23 个问题）
- [ ] 问题分级准确（P0: 3、P1: 14、P2: 6）
- [ ] 问题映射正确（问题归集到对应 FR 确认项）
- [ ] 风险评估准确（🔴 高风险，不可进入设计阶段）
- [ ] 写回结果正确（更新文档、向用户反馈）

### 场景 2: 订单支付功能审查（简化版）

**验证要点**:
- [ ] 识别 P0 问题（支付超时、支付回调）
- [ ] 识别 P1 问题（支付方式优先级、金额精度）
- [ ] 风险评估准确（🔴 高风险）
- [ ] 建议明确（不可进入设计阶段）

### 场景 3: 已澄清问题的标记

**验证要点**:
- [ ] 已确认问题标记 `[CLARIFIED]`（复选框打勾）
- [ ] 已确认问题有澄清说明（✅ + 解决方案）
- [ ] 未确认问题保持待办状态（`[ ]`）
- [ ] 不删除既有确认项

### 场景 4: 迭代审查

**验证要点**:
- [ ] 第一次审查：识别 3 个 P0 问题
- [ ] 第二次审查：标记 P0 问题为 `[CLARIFIED]`，识别新 P1 问题
- [ ] 时间戳更新正确（第二次审查时间 > 第一次审查时间）
- [ ] 不删除第一次审查的确认项

---

## 常见问题排查

### 问题 1: 未经要求就生成文档

**症状**:
- 用户未明确要求进行需求审查
- 变更 ID 缺失或格式错误

**检查点**:
- [ ] 合规检查是否执行？
- [ ] 用户明确要求了吗？
- [ ] 变更 ID 格式正确吗？

**解决方案**:
- 执行步骤 0 合规检查
- 输出标准提示（见 SKILL.md 步骤 0）

### 问题 2: 扫描维度不全

**症状**:
- 只扫描部分维度（如只扫描一致性）
- 某些维度无问题识别

**检查点**:
- [ ] 6 个维度都扫描了吗？
- [ ] 每个维度至少有 1 个检查点？

**解决方案**:
- 严格按 6 维度清单执行（见步骤 2）
- 每个维度至少扫描 4 个检查点

### 问题 3: 优先级不准确

**症状**:
- 所有问题标 P0
- P0 问题不是阻塞性的

**检查点**:
- [ ] P0 问题是逻辑矛盾、数据冲突、关键场景缺失吗？
- [ ] P1 问题是需求不清晰、验收标准不可测吗？
- [ ] P2 问题是术语不统一、描述不详细吗？

**解决方案**:
- 遵循 P0/P1/P2 定义标准（见步骤 3.3）
- 重新评估每个问题的优先级

### 问题 4: 删除既有内容

**症状**:
- 更新时删除原确认项
- 已确认问题消失

**检查点**:
- [ ] 更新时是否只追加新问题？
- [ ] 已确认问题是否标记 `[CLARIFIED]`？
- [ ] 是否删除了任何既有确认项？

**解决方案**:
- 遵循"只追加不删除"原则（见步骤 5.1）
- 已确认问题标记 `[CLARIFIED]`

### 问题 5: 风险评估不准确

**症状**:
- 有 P0 问题但标为🟢低
- 风险等级与问题数量不匹配

**检查点**:
- [ ] P0 问题 = 0 吗？
- [ ] P1 问题 < 5 吗？
- [ ] 风险等级符合标准吗？

**解决方案**:
- 遵循风险等级标准（见步骤 4.2）
- 重新评估风险等级

---

## AI 执行检查清单

在完成需求审查后，AI 应确认以下事项：

- [ ] 检查用户明确要求生成/更新文档
- [ ] 完成 6 维度质量扫描（一致性、完整性、清晰性、准确性、无重复性、可验证性）
- [ ] 识别问题并分级（P0/P1/P2）
- [ ] 评估技术/业务/项目风险
- [ ] 将问题写入对应 FR 确认项
- [ ] 未删除既有确认项
- [ ] 已确认问题标记为 `[CLARIFIED]`
- [ ] 更新时间戳（updated_at）
- [ ] 向用户说明主要问题和风险等级
- [ ] 明确是否可进入设计阶段

# 前端页面重构检查清单

## 目录

- [一、HTML检查](#一html检查)
  - [1.1 语义化检查](#11-语义化检查)
  - [1.2 可访问性检查](#12-可访问性检查)
  - [1.3 结构优化检查](#13-结构优化检查)
- [二、CSS检查](#二css检查)
  - [2.1 重复代码识别](#21-重复代码识别)
  - [2.2 变量体系检查](#22-变量体系检查)
  - [2.3 工具类与组件检查](#23-工具类与组件检查)
  - [2.4 响应式检查](#24-响应式检查)
  - [2.5 现代CSS特性](#25-现代css特性)
- [三、JavaScript检查](#三javascript检查)
  - [3.1 代码质量检查](#31-代码质量检查)
  - [3.2 模块化检查](#32-模块化检查)
  - [3.3 性能检查](#33-性能检查)
- [四、TypeScript检查](#四typescript检查)
  - [4.1 类型安全检查](#41-类型安全检查)
  - [4.2 类型设计检查](#42-类型设计检查)
- [五、Vue检查](#五vue检查)
  - [5.1 Vue 2.x检查](#51-vue-2x检查)
  - [5.2 Vue 3.x检查](#52-vue-3x检查)
  - [5.3 Vue迁移检查](#53-vue迁移检查)
  - [5.4 Composables检查](#54-composables检查)
- [六、可访问性测试](#六可访问性测试)
  - [6.1 自动化测试](#61-自动化测试)
  - [6.2 手动测试](#62-手动测试)
- [七、综合验证](#七综合验证)
  - [7.1 功能验证](#71-功能验证)
  - [7.2 效果评估](#72-效果评估)

---

## 一、HTML检查

### 1.1 语义化检查

- [ ] 页面有且仅有一个 `<h1>`
- [ ] 标题层级正确递进（h1→h2→h3，不跳级）
- [ ] 使用 `<header>/<main>/<footer>` 定义页面结构
- [ ] 导航使用 `<nav>` 标签
- [ ] 独立内容块使用 `<article>` 或 `<section>`
- [ ] 列表内容使用 `<ul>/<ol>/<dl>`
- [ ] 时间日期使用 `<time>` 标签

### 1.2 可访问性检查

- [ ] 所有信息性图片有描述性 `alt` 属性
- [ ] 装饰性图片使用空 `alt=""`
- [ ] 表单控件有关联的 `<label>`
- [ ] 自定义交互元素可键盘操作（tabindex + 键盘事件）
- [ ] 使用了适当的ARIA属性（aria-label/aria-describedby等）
- [ ] 页面有跳过导航的链接
- [ ] 颜色不是传达信息的唯一方式

### 1.3 结构优化检查

- [ ] HTML嵌套层级不超过5层
- [ ] 无冗余的包装元素（单子元素容器）
- [ ] 无 `<div onclick>` 替代按钮
- [ ] 无 `<br><br>` 实现间距
- [ ] 无 `<table>` 实现布局
- [ ] 代码缩进一致

---

## 二、CSS检查

### 2.1 重复代码识别

- [ ] **颜色值重复**：相同色值出现3+次已变量化
- [ ] **间距值重复**：常用padding/margin已变量化
- [ ] **圆角值重复**：border-radius已分层级变量化
- [ ] **阴影值重复**：box-shadow已分层级变量化
- [ ] **渐变定义重复**：渐变已提取为变量

### 2.2 变量体系检查

- [ ] 变量在 `:root` 中定义
- [ ] 遵循3层结构：基础令牌 → 语义令牌 → 组件令牌
- [ ] 命名遵循 `--{scope}-{category}-{property}` 格式
- [ ] 无未使用的变量
- [ ] 变量覆盖率 ≥ 80%

### 2.3 工具类与组件检查

- [ ] 高频布局模式已抽取为工具类（flex-center等）
- [ ] 相似组件已创建基类+变体模式
- [ ] 相同样式的选择器已合并
- [ ] 公共属性已提取
- [ ] 选择器嵌套不超过3层
- [ ] 无 `!important` 滥用

### 2.4 响应式检查

- [ ] 使用 `min-width` 移动优先策略
- [ ] 断点值统一使用变量
- [ ] 媒体查询按断点集中管理
- [ ] 固定像素已替换为弹性单位（%/vw/clamp）
- [ ] 容器有 `max-width` 防止过度拉伸
- [ ] 触摸目标尺寸 ≥ 44px
- [ ] 图片使用 `max-width: 100%` 防止溢出

### 2.5 现代CSS特性

> 详见：[modern-css.md](modern-css.md)

- [ ] 组件级响应式使用 Container Queries
- [ ] 样式优先级使用 CSS Layers 管理
- [ ] 父元素选择使用 `:has()` 选择器
- [ ] 国际化项目使用逻辑属性（margin-inline 等）
- [ ] 移动端全屏使用 dvh/svh 单位
- [ ] 尊重 `prefers-reduced-motion` 偏好
- [ ] 支持 `prefers-color-scheme` 暗色模式
- [ ] 现代特性有 `@supports` 回退方案

---

## 三、JavaScript检查

### 3.1 代码质量检查

- [ ] 函数长度不超过50行
- [ ] 嵌套层级不超过3层
- [ ] 无魔法数字（已提取为常量）
- [ ] 无全局变量污染
- [ ] 使用 `const`/`let` 替代 `var`
- [ ] 使用 `===` 替代 `==`
- [ ] 有适当的错误处理（try-catch）

### 3.2 模块化检查

- [ ] 重复代码已提取为公共函数
- [ ] 模块职责单一
- [ ] 使用ES6模块语法（import/export）
- [ ] 工具函数按类型组织

### 3.3 性能检查

- [ ] 使用事件委托替代多元素绑定
- [ ] 高频事件（scroll/resize/input）有防抖/节流
- [ ] DOM操作已批量化（DocumentFragment）
- [ ] 并行请求使用 `Promise.all`
- [ ] 使用 async/await 替代回调嵌套

---

## 四、TypeScript检查

### 4.1 类型安全检查

- [ ] 无 `any` 类型（或有充分理由）
- [ ] 无不必要的类型断言（`as Type`）
- [ ] 无 `!` 非空断言（正确处理null）
- [ ] 无 `@ts-ignore` 注释
- [ ] 启用了 `strict` 模式

### 4.2 类型设计检查

- [ ] 接口/类型定义清晰完整
- [ ] 无重复的类型定义
- [ ] 使用了适当的泛型
- [ ] 使用了工具类型（Partial/Pick/Omit等）
- [ ] 使用 `import type` 导入纯类型

---

## 五、Vue检查

> 详细检查项请参阅各专项模块：[vue2-refactoring.md](vue2-refactoring.md)、[vue3-refactoring.md](vue3-refactoring.md)、[vue2-to-vue3-migration.md](vue2-to-vue3-migration.md)、[composables-patterns.md](composables-patterns.md)

### 5.1 通用检查

- [ ] 组件行数 ≤ 300
- [ ] 组件有明确的 name 属性
- [ ] Props 有类型定义和验证
- [ ] 无直接修改 Props
- [ ] v-for 有唯一 key
- [ ] v-if 和 v-for 不同时使用
- [ ] 大组件使用异步加载

### 5.2 Vue 2.x 专项

- [ ] 无 Mixins 命名冲突
- [ ] 新增属性使用 `$set`
- [ ] 大型静态数据使用 `Object.freeze`

### 5.3 Vue 3.x 专项

- [ ] 使用 `<script setup>` 语法
- [ ] 通用逻辑提取为 Composable
- [ ] Composable 命名以 `use` 开头
- [ ] 有适当的清理逻辑（定时器/事件监听）
- [ ] Vue 3.4+：使用 `defineModel()` 简化 v-model
- [ ] Vue 3.4+：使用 v-bind 同名简写
- [ ] Vue 3.5+：使用 `useTemplateRef()` 获取模板引用
- [ ] Vue 3.5+：使用 `useId()` 生成唯一 ID

### 5.4 迁移检查

- [ ] 已升级到 Vue 2.7（迁移准备）
- [ ] v-model 改为 modelValue
- [ ] .sync 改为 v-model:propName
- [ ] 事件总线改用 mitt

---

## 六、可访问性测试

> 详见：[accessibility-testing.md](accessibility-testing.md)

### 6.1 自动化测试

- [ ] 配置 axe-core 或 pa11y
- [ ] 集成到 CI/CD 流程
- [ ] 设置可访问性评分阈值（≥90）
- [ ] 定期运行 Lighthouse 审计
- [ ] 关键页面有自动化测试覆盖

### 6.2 手动测试

- [ ] 键盘导航测试（Tab/Enter/Escape）
- [ ] 屏幕阅读器测试（NVDA/VoiceOver）
- [ ] 200% 缩放测试
- [ ] 高对比度模式测试
- [ ] 焦点状态清晰可见
- [ ] 动态内容有 aria-live 通知

---

## 七、综合验证

### 7.1 功能验证

- [ ] 所有页面视觉效果与重构前一致
- [ ] 所有交互状态正常（hover/active/disabled/focus）
- [ ] 响应式布局正常（手机/平板/桌面）
- [ ] 过渡/动画效果正常
- [ ] 表单提交/验证正常
- [ ] 无控制台错误

### 7.2 效果评估

#### 代码质量指标

| 指标 | 目标值 | 实际值 |
|------|--------|--------|
| CSS代码行数减少率 | ≥50% | |
| CSS变量覆盖率 | ≥80% | |
| 选择器复用率 | ≥50% | |
| any类型数量（业务代码） | 0 | |
| 函数平均行数 | ≤30 | |
| 最大嵌套层级 | ≤3 | |

#### 性能指标

| 指标 | 目标值 | 实际值 |
|------|--------|--------|
| LCP | < 2.5s | |
| CLS | < 0.1 | |
| CSS文件大小 (gzip) | < 50KB | |
| 可访问性评分 | ≥ 90 | |

---

## 常见问题速查

### HTML问题
- [ ] 无 `<div class="header">` 替代 `<header>`
- [ ] 无空链接 `<a href="#">`
- [ ] 无空按钮（无文本或aria-label）

### CSS问题
- [ ] CSS变量有回退值（兼容性）
- [ ] Flex/Grid布局有兼容方案
- [ ] 动画使用GPU加速属性（transform/opacity）
- [ ] 现代特性有 `@supports` 检测

### JS问题
- [ ] 无 `eval()` 使用
- [ ] 无同步XHR请求
- [ ] 无 `with` 语句

### TS问题
- [ ] 无导出 `any` 类型
- [ ] 无 `as any` 绕过检查

### 可访问性问题
- [ ] 对比度满足 WCAG AA（4.5:1）
- [ ] 焦点样式使用 `:focus-visible`
- [ ] 模态框有焦点陷阱
- [ ] 动态内容有 aria-live 区域

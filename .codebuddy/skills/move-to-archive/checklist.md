# 归档过时内容 - 验证清单

本文档提供完整的归档前、归档中和归档后的验证清单，确保归档过程完整无误。

## 📋 归档前检查清单

### 业务确认

- [ ] **确认内容确实不再使用**
  - [ ] 功能已完全下线或替换
  - [ ] 监控数据显示无访问记录
  - [ ] 团队确认无人依赖

- [ ] **通知相关团队成员**
  - [ ] 在团队会议中讨论
  - [ ] 发送归档通知邮件
  - [ ] 在 Slack/Teams 中公告
  - [ ] 给出至少 1 周的反馈期

- [ ] **准备替代方案文档**
  - [ ] 新实现已上线并稳定
  - [ ] 迁移指南已完成
  - [ ] 文档清晰易懂

- [ ] **检查依赖关系**
  - [ ] 搜索所有文件引用
  - [ ] 确认无其他模块依赖
  - [ ] 检查数据库依赖
  - [ ] 检查配置文件引用

### 技术准备

- [ ] **验证源路径**
  - [ ] 源路径存在
  - [ ] 路径正确无误
  - [ ] 有足够的访问权限

- [ ] **确认归档分类**
  - [ ] 分类正确 (skills/commands/docs/templates/standards)
  - [ ] 目录结构合理
  - [ ] 命名规范符合要求

- [ ] **准备归档信息**
  - [ ] 归档原因清晰
  - [ ] 准备替代方案说明
  - [ ] 准备相关链接
  - [ ] 准备注意事项

- [ ] **备份当前状态**
  - [ ] Git 提交所有更改
  - [ ] 创建备份分支（可选）
  - [ ] 记录当前状态

### 环境检查

- [ ] **磁盘空间充足**
  - [ ] 归档目录有足够空间
  - [ ] 至少保留源文件大小 2 倍空间

- [ ] **工具和脚本可用**
  - [ ] 归档脚本存在并可执行
  - [ ] 必要的命令行工具已安装 (grep, find, sed)
  - [ ] 权限配置正确

---

## 🔄 归档执行检查清单

### 阶段 1: 验证和准备

- [ ] **源路径验证**
  - [ ] 源路径存在
  - [ ] 路径可访问
  - [ ] 文件完整性检查

- [ ] **归档目录准备**
  - [ ] spec/archive/ 目录存在
  - [ ] 分类目录存在
  - [ ] 目标目录不存在（避免冲突）

- [ ] **用户确认**
  - [ ] 显示归档信息
  - [ ] 用户确认继续
  - [ ] 记录确认时间

### 阶段 2: 创建归档目录

- [ ] **目录命名正确**
  - [ ] 使用正确的日期格式 (YYYY-MM-DD)
  - [ ] 描述性名称清晰
  - [ ] 格式符合规范

- [ ] **目录结构创建**
  - [ ] 归档目录创建成功
  - [ ] 权限设置正确
  - [ ] 路径记录准确

- [ ] **元数据文件生成**
  - [ ] ARCHIVE-INFO.md 创建成功
  - [ ] 基本信息完整
  - [ ] 格式正确

### 阶段 3: 移动内容

- [ ] **文件复制**
  - [ ] 所有文件复制成功
  - [ ] 目录结构保持一致
  - [ ] 文件权限正确
  - [ ] 文件大小一致

- [ ] **文件完整性验证**
  - [ ] 文件数量匹配
  - [ ] 目录数量匹配
  - [ ] 总大小匹配
  - [ ] 校验和一致（可选）

- [ ] **特殊文件处理**
  - [ ] 符号链接处理正确
  - [ ] 隐藏文件包含
  - [ ] 大文件处理成功

### 阶段 4: 链接检查和更新

- [ ] **链接检查完成**
  - [ ] 搜索 MDC 链接
  - [ ] 搜索相对链接
  - [ ] 搜索绝对链接
  - [ ] 搜索代码导入

- [ ] **链接更新记录**
  - [ ] 记录所有找到的链接
  - [ ] 记录更新的链接
  - [ ] 记录需手动处理的链接
  - [ ] 更新详情记录到 ARCHIVE-INFO.md

- [ ] **链接验证**
  - [ ] 更新后的链接有效
  - [ ] 无断链
  - [ ] 路径正确

### 阶段 5: 更新索引

- [ ] **全局索引更新**
  - [ ] spec/archive/README.md 更新
  - [ ] 新归档添加到索引
  - [ ] 统计信息更新
  - [ ] 格式正确

- [ ] **分类索引更新**
  - [ ] 分类索引存在
  - [ ] 新归档添加
  - [ ] 排序正确（按时间）

- [ ] **搜索索引更新**
  - [ ] 提供搜索方法
  - [ ] 示例命令正确
  - [ ] 关键词准确

### 阶段 6: 源文件处理

- [ ] **源文件处理确认**
  - [ ] 用户确认删除/保留
  - [ ] 处理操作记录
  - [ ] 回滚信息记录

- [ ] **删除操作验证**（如果删除）
  - [ ] 源目录已删除
  - [ ] 删除操作可逆
  - [ ] 回滚方法记录

---

## ✅ 归档后验证清单

### 归档完整性验证

- [ ] **归档目录检查**
  - [ ] 归档目录存在
  - [ ] 目录结构完整
  - [ ] 文件完整
  - [ ] 权限正确

- [ ] **元数据完整性**
  - [ ] ARCHIVE-INFO.md 存在
  - [ ] 所有必需字段完整
  - [ ] 格式正确
  - [ ] 信息准确

- [ ] **文件完整性**
  - [ ] 所有原始文件已复制
  - [ ] 无数据丢失
  - [ ] 文件可访问
  - [ ] 内容正确

### 链接和引用验证

- [ ] **链接更新验证**
  - [ ] 所有链接已更新或记录
  - [ ] 更新后的链接有效
  - [ ] 无断链
  - [ ] 手动处理清单完整

- [ ] **代码引用验证**
  - [ ] 代码导入已更新
  - [ ] 测试通过
  - [ ] 无编译错误
  - [ ] 无运行时错误

- [ ] **文档引用验证**
  - [ ] 文档链接已更新
  - [ ] 交叉引用正确
  - [ ] 导航链接有效

### 索引和文档验证

- [ ] **归档索引验证**
  - [ ] 全局索引已更新
  - [ ] 新归档在索引中
  - [ ] 统计信息准确
  - [ ] 分类正确

- [ ] **项目文档验证**
  - [ ] CHANGELOG 已更新（如需要）
  - [ ] README 已更新（如需要）
  - [ ] 架构文档已更新（如需要）
  - [ ] API 文档已更新（如需要）

### 团队协作验证

- [ ] **团队通知完成**
  - [ ] 归档完成通知已发送
  - [ ] 团队成员已知晓
  - [ ] 影响范围已说明
  - [ ] 后续操作已明确

- [ ] **知识转移完成**
  - [ ] 归档原因已记录
  - [ ] 迁移指南已提供
  - [ ] 常见问题已解答
  - [ ] 联系人已指定

### 质量保证验证

- [ ] **测试验证**
  - [ ] 单元测试通过
  - [ ] 集成测试通过
  - [ ] 端到端测试通过
  - [ ] 无回归问题

- [ ] **代码审查**
  - [ ] 链接更新已审查
  - [ ] 代码更改已审查
  - [ ] 文档更新已审查
  - [ ] 无遗漏问题

- [ ] **部署验证**（如需要）
  - [ ] 在测试环境验证
  - [ ] 在预发布环境验证
  - [ ] 在生产环境验证
  - [ ] 监控无异常

---

## 🔧 特殊场景检查清单

### 大型归档（>100MB）

- [ ] **性能考虑**
  - [ ] 分批复制文件
  - [ ] 监控磁盘 I/O
  - [ ] 避免系统过载
  - [ ] 预估所需时间

- [ ] **存储优化**
  - [ ] 考虑压缩归档
  - [ ] 考虑使用 Git LFS
  - [ ] 考虑外部存储
  - [ ] 定期清理计划

### 包含敏感信息的归档

- [ ] **敏感信息处理**
  - [ ] 识别所有敏感信息
  - [ ] 清理密钥和密码
  - [ ] 替换敏感配置
  - [ ] 验证清理完成

- [ ] **安全性验证**
  - [ ] 无敏感信息泄露
  - [ ] 权限设置正确
  - [ ] 访问控制有效
  - [ ] 审计日志完整

### 紧急归档

- [ ] **快速验证**
  - [ ] 核心文件已复制
  - [ ] 关键元数据已记录
  - [ ] 基本链接已检查
  - [ ] 简化流程记录

- [ ] **后续补充**
  - [ ] 计划详细验证
  - [ ] 补充完整元数据
  - [ ] 完善链接更新
  - [ ] 更新文档

### 部分归档（保留源文件）

- [ ] **源文件保留**
  - [ ] 源文件未删除
  - [ ] 保留原因记录
  - [ ] 保留期限明确
  - [ ] 清理计划制定

- [ ] **双重维护预防**
  - [ ] 明确标注已归档
  - [ ] 防止误修改源文件
  - [ ] 定期检查源文件
  - [ ] 到期提醒设置

---

## 📊 归档质量评分

### 评分标准

根据以下维度对归档质量进行评分：

#### 完整性（25分）
- [ ] 所有文件完整复制（10分）
- [ ] 元数据完整准确（10分）
- [ ] 无数据丢失（5分）

#### 准确性（25分）
- [ ] 链接检查准确（10分）
- [ ] 链接更新正确（10分）
- [ ] 信息记录准确（5分）

#### 可追溯性（25分）
- [ ] 归档原因清晰（10分）
- [ ] 替代方案明确（10分）
- [ ] 回滚方法可行（5分）

#### 规范性（25分）
- [ ] 命名规范正确（5分）
- [ ] 目录结构标准（5分）
- [ ] 元数据格式规范（5分）
- [ ] 索引更新完整（5分）
- [ ] 文档记录规范（5分）

**总分**: ___/100

**质量等级**:
- 90-100: 优秀 ⭐⭐⭐⭐⭐
- 80-89: 良好 ⭐⭐⭐⭐
- 70-79: 合格 ⭐⭐⭐
- 60-69: 需改进 ⭐⭐
- <60: 不合格 ⭐

---

## 🚨 常见问题检查

### 问题 1: 归档目录已存在

**检查项**:
- [ ] 检查现有目录内容
- [ ] 确认是否重复归档
- [ ] 决定处理方式（重命名/覆盖/取消）
- [ ] 记录决策和原因

### 问题 2: 链接更新失败

**检查项**:
- [ ] 确认失败原因
- [ ] 生成手动修复清单
- [ ] 提供修复指南
- [ ] 分配修复责任人
- [ ] 设置完成期限

### 问题 3: 文件复制失败

**检查项**:
- [ ] 检查磁盘空间
- [ ] 检查文件权限
- [ ] 检查文件锁定
- [ ] 重试复制操作
- [ ] 记录失败详情

### 问题 4: 团队反馈延迟

**检查项**:
- [ ] 延长反馈期
- [ ] 再次通知团队
- [ ] 一对一沟通
- [ ] 记录反馈情况
- [ ] 调整归档计划

### 问题 5: 测试失败

**检查项**:
- [ ] 分析失败原因
- [ ] 回滚归档操作
- [ ] 修复问题
- [ ] 重新测试
- [ ] 重新执行归档

---

## 📝 归档报告检查

### 归档完成报告必需内容

- [ ] **执行信息**
  - [ ] 归档时间
  - [ ] 执行人
  - [ ] 归档状态

- [ ] **归档详情**
  - [ ] 源路径
  - [ ] 归档路径
  - [ ] 文件统计

- [ ] **链接处理**
  - [ ] 检查结果
  - [ ] 更新记录
  - [ ] 需手动处理项

- [ ] **验证结果**
  - [ ] 完整性验证
  - [ ] 链接验证
  - [ ] 索引验证

- [ ] **后续操作**
  - [ ] 需要手动处理的项
  - [ ] 责任人
  - [ ] 完成期限

- [ ] **回滚信息**
  - [ ] 回滚方法
  - [ ] 回滚条件
  - [ ] 注意事项

---

## ✨ 最佳实践检查

### 归档前最佳实践

- [ ] **充分沟通**
  - [ ] 提前至少 1 周通知
  - [ ] 明确影响范围
  - [ ] 提供足够反馈时间

- [ ] **详细记录**
  - [ ] 归档原因详细
  - [ ] 替代方案明确
  - [ ] 迁移指南完整

- [ ] **备份保护**
  - [ ] Git 提交保护
  - [ ] 创建备份分支
  - [ ] 记录回滚方法

### 归档执行最佳实践

- [ ] **分步执行**
  - [ ] 按阶段执行
  - [ ] 每步验证
  - [ ] 问题及时处理

- [ ] **完整记录**
  - [ ] 记录所有操作
  - [ ] 记录所有决策
  - [ ] 记录所有问题

- [ ] **质量保证**
  - [ ] 多次验证
  - [ ] 交叉检查
  - [ ] 同行审查

### 归档后最佳实践

- [ ] **持续跟进**
  - [ ] 监控无异常
  - [ ] 跟进手动处理项
  - [ ] 收集团队反馈

- [ ] **知识总结**
  - [ ] 记录经验教训
  - [ ] 更新最佳实践
  - [ ] 分享给团队

- [ ] **定期回顾**
  - [ ] 定期检查归档
  - [ ] 评估保留必要性
  - [ ] 及时清理过期归档

---

## 📌 检查清单使用说明

### 如何使用此清单

1. **归档前**: 完成"归档前检查清单"
2. **归档中**: 按顺序完成"归档执行检查清单"
3. **归档后**: 完成"归档后验证清单"
4. **特殊情况**: 参考"特殊场景检查清单"
5. **质量评估**: 使用"归档质量评分"进行评估

### 检查清单定制

根据项目实际情况，可以：
- 添加项目特定的检查项
- 删除不适用的检查项
- 调整检查项的优先级
- 补充更详细的子检查项

### 检查清单维护

- 定期审查和更新清单
- 根据实际经验优化
- 收集团队反馈改进
- 保持与最佳实践同步

---

## 相关资源

- **主 Skill**: [SKILL.md](SKILL.md)
- **详细参考**: [reference.md](reference.md)
- **完整示例**: [examples.md](examples.md)

# å½’æ¡£è¿‡æ—¶å†…å®¹ - è¯¦ç»†å‚è€ƒæ–‡æ¡£

> æœ¬æ–‡æ¡£æä¾›å½’æ¡£åŠŸèƒ½çš„è¯¦ç»†æŠ€æœ¯ç»†èŠ‚ã€é«˜çº§ç”¨æ³•å’Œæœ€ä½³å®è·µ

## ğŸ“– ç›®å½•

1. [å½’æ¡£è§„åˆ™è¯¦è§£](#å½’æ¡£è§„åˆ™è¯¦è§£)
2. [å½’æ¡£ç›®å½•ç»“æ„è¯¦è§£](#å½’æ¡£ç›®å½•ç»“æ„è¯¦è§£)
3. [å…ƒæ•°æ®è§„èŒƒ](#å…ƒæ•°æ®è§„èŒƒ)
4. [é“¾æ¥æ›´æ–°è¯¦è§£](#é“¾æ¥æ›´æ–°è¯¦è§£)
5. [æœ€ä½³å®è·µè¯¦è§£](#æœ€ä½³å®è·µè¯¦è§£)
6. [å½’æ¡£ç­–ç•¥](#å½’æ¡£ç­–ç•¥)
7. [è‡ªåŠ¨åŒ–å½’æ¡£](#è‡ªåŠ¨åŒ–å½’æ¡£)
8. [å·¥å…·é›†æˆ](#å·¥å…·é›†æˆ)
9. [å¸¸è§é—®é¢˜è§£ç­”](#å¸¸è§é—®é¢˜è§£ç­”)

---

## å½’æ¡£è§„åˆ™è¯¦è§£

### åº”è¯¥å½’æ¡£çš„å†…å®¹è¯¦ç»†æ¸…å•

#### 1. åºŸå¼ƒçš„åŠŸèƒ½ä»£ç 

**åˆ¤æ–­æ ‡å‡†**:
- åŠŸèƒ½å·²ä»äº§å“ä¸­ç§»é™¤
- ä»£ç ä¸å†è¢«å¼•ç”¨æˆ–è°ƒç”¨
- å·²æœ‰æ–°çš„å®ç°æ›¿ä»£

**ç¤ºä¾‹**:
```
åºŸå¼ƒçš„è®¤è¯æ¨¡å—:
- skills/session-auth/ (å·²è¢« OAuth2 æ›¿ä»£)
- ä¿ç•™åŸå› : å†å²å‚è€ƒï¼Œäº†è§£æ—§ç³»ç»Ÿè®¾è®¡
```

#### 2. è¿‡æ—¶çš„æ–‡æ¡£

**åˆ¤æ–­æ ‡å‡†**:
- æ–‡æ¡£ç‰ˆæœ¬å·ä½äºå½“å‰ç‰ˆæœ¬
- æè¿°çš„åŠŸèƒ½æˆ–æµç¨‹å·²æ”¹å˜
- è¢«æ–°æ–‡æ¡£å®Œå…¨æ›¿ä»£

**ç¤ºä¾‹**:
```
æ—§ç‰ˆ API æ–‡æ¡£:
- docs/api-v1.md (å·²å‡çº§åˆ° v2)
- ä¿ç•™åŸå› : æ”¯æŒæ—§å®¢æˆ·ç«¯çš„å‚è€ƒ
```

#### 3. ä¸´æ—¶å’Œå®éªŒæ€§æ–‡ä»¶

**åˆ¤æ–­æ ‡å‡†**:
- æ ‡è®°ä¸º "temp" æˆ– "experimental"
- åˆ›å»ºæ—¶é—´è¶…è¿‡ 6 ä¸ªæœˆä¸”æœªæ›´æ–°
- é¡¹ç›®å·²å®Œæˆæˆ–å®éªŒå·²ç»“æŸ

**ç¤ºä¾‹**:
```
ä¸´æ—¶è¿ç§»è„šæœ¬:
- scripts/temp-data-migration.sh (è¿ç§»å·²å®Œæˆ)
- ä¿ç•™åŸå› : äº†è§£è¿ç§»è¿‡ç¨‹ï¼Œä»¥å¤‡å°†æ¥å‚è€ƒ
```

#### 4. æ—§ç‰ˆæœ¬å¿«ç…§

**åˆ¤æ–­æ ‡å‡†**:
- æ ‡è®°ä¸º v1, v2 ç­‰ç‰ˆæœ¬å·
- å·²è¢«æ›´é«˜ç‰ˆæœ¬æ›¿ä»£
- ä¸å†ç»´æŠ¤

**ç¤ºä¾‹**:
```
æ—§ç‰ˆé…ç½®:
- config/v1/ (å·²å‡çº§åˆ° v2)
- ä¿ç•™åŸå› : å›æ»šæ—¶çš„å‚è€ƒ
```

### ä¸åº”è¯¥å½’æ¡£çš„å†…å®¹è¯¦ç»†è¯´æ˜

#### 1. æ´»è·ƒä»£ç 

**åˆ¤æ–­æ ‡å‡†**:
- æœ€è¿‘ 3 ä¸ªæœˆå†…æœ‰ä¿®æ”¹
- ä»åœ¨è¢«å…¶ä»–ä»£ç å¼•ç”¨
- æµ‹è¯•ä»åœ¨é€šè¿‡

#### 2. å½“å‰æ–‡æ¡£

**åˆ¤æ–­æ ‡å‡†**:
- æè¿°å½“å‰ç³»ç»ŸçŠ¶æ€
- ç»å¸¸è¢«æŸ¥é˜…
- å†…å®¹å‡†ç¡®æœ‰æ•ˆ

#### 3. ä¾èµ–é¡¹å’Œå…±äº«èµ„æº

**åˆ¤æ–­æ ‡å‡†**:
- è¢«å¤šä¸ªæ¨¡å—ä¾èµ–
- æä¾›é€šç”¨åŠŸèƒ½
- æœªæ ‡è®°ä¸ºåºŸå¼ƒ

---

## å½’æ¡£ç›®å½•ç»“æ„è¯¦è§£

### ç›®å½•å±‚æ¬¡è¯´æ˜

```
spec/archive/
â”œâ”€â”€ skills/                          # æŠ€èƒ½å½’æ¡£
â”‚   â””â”€â”€ 2024-01-15_old-auth-skill/
â”‚       â”œâ”€â”€ SKILL.md                 # åŸå§‹æŠ€èƒ½æ–‡ä»¶
â”‚       â”œâ”€â”€ scripts/                 # åŸå§‹è„šæœ¬
â”‚       â”œâ”€â”€ ARCHIVE-INFO.md          # å½’æ¡£å…ƒæ•°æ®
â”‚       â””â”€â”€ README.md                # åŸå§‹è¯´æ˜
â”œâ”€â”€ commands/                        # å‘½ä»¤å½’æ¡£
â”‚   â””â”€â”€ 2024-02-20_deprecated-cmd/
â”œâ”€â”€ docs/                            # æ–‡æ¡£å½’æ¡£
â”‚   â””â”€â”€ 2024-03-10_old-design/
â”œâ”€â”€ templates/                       # æ¨¡æ¿å½’æ¡£
â”‚   â””â”€â”€ 2024-04-05_old-template/
â”œâ”€â”€ standards/                       # è§„èŒƒå½’æ¡£
â”‚   â””â”€â”€ 2024-05-15_old-standard/
â”œâ”€â”€ README.md                        # å…¨å±€å½’æ¡£ç´¢å¼•
â””â”€â”€ CHANGELOG.md                     # å½’æ¡£å˜æ›´æ—¥å¿—
```

### ç›®å½•å‘½åè§„èŒƒè¯¦è§£

**æ ¼å¼**: `{YYYY-MM-DD}_{æè¿°æ€§åç§°}/`

**å‘½åè¦æ±‚**:
- æ—¥æœŸä½¿ç”¨ ISO 8601 æ ¼å¼ (YYYY-MM-DD)
- æè¿°æ€§åç§°ä½¿ç”¨å°å†™å­—æ¯å’Œè¿å­—ç¬¦
- åç§°åº”ç®€æ´ä½†èƒ½è¡¨è¾¾æ ¸å¿ƒå«ä¹‰
- é¿å…ç‰¹æ®Šå­—ç¬¦å’Œç©ºæ ¼

**å¥½çš„å‘½åç¤ºä¾‹**:
```
âœ… 2024-01-15_old-authentication-skill
âœ… 2024-03-20_deprecated-api-v1
âœ… 2024-06-10_legacy-database-schema
âœ… 2024-09-05_temp-migration-scripts
```

**ä¸å¥½çš„å‘½åç¤ºä¾‹**:
```
âŒ old-auth (ç¼ºå°‘æ—¥æœŸ)
âŒ 2024-01-15 (ç¼ºå°‘æè¿°)
âŒ 2024_01_15_Old Auth (æ ¼å¼é”™è¯¯)
âŒ 2024-01-15_æ—§è®¤è¯ (ä½¿ç”¨ä¸­æ–‡)
```

---

## å…ƒæ•°æ®è§„èŒƒ

### ARCHIVE-INFO.md æ ‡å‡†æ ¼å¼

```markdown
# å½’æ¡£ä¿¡æ¯

## åŸºæœ¬ä¿¡æ¯

- **å½’æ¡£æ—¥æœŸ**: 2024-01-15
- **åŸå§‹è·¯å¾„**: skills/old-authentication
- **å½’æ¡£åˆ†ç±»**: skills
- **å½’æ¡£æ‰§è¡Œäºº**: zhangsan
- **å½’æ¡£å·¥å…·ç‰ˆæœ¬**: v3.0

## å½’æ¡£åŸå› 

### ä¸»è¦åŸå› 
è®¤è¯æœºåˆ¶å·²å…¨é¢å‡çº§åˆ° OAuth 2.0 æ ‡å‡†ï¼Œæ—§çš„åŸºäº Session çš„è®¤è¯ä¸å†é€‚ç”¨äºç°ä»£åŒ–æ¶æ„ã€‚

### è¯¦ç»†è¯´æ˜
1. **å®‰å…¨æ€§**: OAuth 2.0 æä¾›æ›´å¥½çš„å®‰å…¨æ€§
2. **æ‰©å±•æ€§**: æ”¯æŒç¬¬ä¸‰æ–¹åº”ç”¨æˆæƒ
3. **æ ‡å‡†åŒ–**: ç¬¦åˆè¡Œä¸šæ ‡å‡†

## åŸå§‹å†…å®¹

### æ–‡ä»¶åˆ—è¡¨
- SKILL.md (5.2 KB)
- auth-handler.ts (12.3 KB)
- session-manager.ts (8.7 KB)
- README.md (3.1 KB)
- tests/auth.test.ts (6.5 KB)

### ç›®å½•ç»“æ„
```
old-authentication/
â”œâ”€â”€ SKILL.md
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ auth-handler.ts
â”‚   â””â”€â”€ session-manager.ts
â”œâ”€â”€ tests/
â”‚   â””â”€â”€ auth.test.ts
â””â”€â”€ README.md
```

### ç»Ÿè®¡ä¿¡æ¯
- **æ–‡ä»¶æ€»æ•°**: 5
- **ç›®å½•æ€»æ•°**: 2
- **æ€»å¤§å°**: 35.8 KB
- **ä»£ç è¡Œæ•°**: ~1,200 è¡Œ

## æ›¿ä»£æ–¹æ¡ˆ

### æ–°å®ç°ä½ç½®
- **è·¯å¾„**: skills/oauth2-authentication
- **ç‰ˆæœ¬**: v2.0
- **çŠ¶æ€**: å·²ä¸Šçº¿

### è¿ç§»æŒ‡å—
è¯¦è§ [OAuth 2.0 è¿ç§»æŒ‡å—](mdc:docs/migration/oauth2-migration.md)

### å…³é”®å·®å¼‚
| ç‰¹æ€§ | æ—§å®ç° (Session) | æ–°å®ç° (OAuth 2.0) |
|------|-----------------|-------------------|
| è®¤è¯æ–¹å¼ | Session Cookie | Access Token |
| å®‰å…¨æ€§ | ä¸­ç­‰ | é«˜ |
| æ‰©å±•æ€§ | ä½ | é«˜ |
| ç¬¬ä¸‰æ–¹æ”¯æŒ | å¦ | æ˜¯ |

## ä¾èµ–å…³ç³»

### è¢«ä¾èµ–æƒ…å†µ
- âŒ æ— å…¶ä»–æ¨¡å—ä¾èµ–æ­¤å½’æ¡£å†…å®¹

### ä¾èµ–é¡¹
- express-session (v1.17.0)
- connect-redis (v5.0.0)

## ç›¸å…³é“¾æ¥

### æ¶æ„å†³ç­–
- [ADR-015: OAuth 2.0 è®¤è¯æ ‡å‡†åŒ–](mdc:.codebuddy/spec/memory/architecture-decisions.md#adr-015)

### ç›¸å…³æ–‡æ¡£
- [OAuth 2.0 è®¤è¯å®ç°](mdc:skills/oauth2-authentication/SKILL.md)
- [è¿ç§»æŒ‡å—](mdc:docs/migration/oauth2-migration.md)
- [å®‰å…¨å®¡è®¡æŠ¥å‘Š](mdc:docs/security/audit-2024-01.md)

### ç›¸å…³å½’æ¡£
- [2023-12-10_old-jwt-handler](mdc:.codebuddy/spec/archive/skills/2023-12-10_old-jwt-handler/)

## æ³¨æ„äº‹é¡¹

### é‡è¦æé†’
1. **æ•°æ®æ¸…ç†**: æ—§çš„ Session æ•°æ®å·²ä» Redis ä¸­æ¸…ç†
2. **API å˜æ›´**: `/auth/login` ç«¯ç‚¹ç­¾åå·²å˜æ›´
3. **å®¢æˆ·ç«¯è¿ç§»**: æ‰€æœ‰å®¢æˆ·ç«¯éœ€è¦æ›´æ–°è®¤è¯é€»è¾‘
4. **å…¼å®¹æ€§**: ä¸å†æ”¯æŒ Session è®¤è¯æ–¹å¼

### æ½œåœ¨é—®é¢˜
- æ—§å®¢æˆ·ç«¯å¯èƒ½éœ€è¦å‡çº§
- éƒ¨åˆ†ç¬¬ä¸‰æ–¹é›†æˆéœ€è¦é‡æ–°é…ç½®

## æŠ€æœ¯ä¿¡æ¯

### ç¯å¢ƒè¦æ±‚
- Node.js: 14.x
- Express: 4.17.x
- Redis: 5.x

### ä¾èµ–é“¾æ¥æ£€æŸ¥
- **æ£€æŸ¥æ—¶é—´**: 2024-01-15 10:30:00
- **å‘ç°é“¾æ¥**: 3 ä¸ª
- **å·²æ›´æ–°**: 3 ä¸ª
- **éœ€æ‰‹åŠ¨å¤„ç†**: 0 ä¸ª

### é“¾æ¥æ›´æ–°è¯¦æƒ…
1. docs/api-reference.md:42 - å·²æ›´æ–°åˆ°å½’æ¡£è·¯å¾„
2. README.md:15 - å·²æ›´æ–°åˆ°æ–°å®ç°è·¯å¾„
3. docs/architecture.md:88 - å·²æ ‡æ³¨ä¸ºå†å²å¼•ç”¨

## å›æ»šä¿¡æ¯

### å¦‚ä½•æ¢å¤
å¦‚éœ€æ¢å¤æ­¤å½’æ¡£åˆ°åŸä½ç½®:
```bash
# å¤åˆ¶å½’æ¡£åˆ°åŸä½ç½®
cp -r spec/archive/skills/2024-01-15_old-authentication-skill/ \
     skills/old-authentication/

# æ¢å¤é“¾æ¥å¼•ç”¨
# (éœ€è¦æ‰‹åŠ¨å¤„ç†ï¼Œå‚è€ƒä¸Šé¢çš„é“¾æ¥æ›´æ–°è¯¦æƒ…)
```

### æ³¨æ„äº‹é¡¹
- æ¢å¤åéœ€è¦é‡æ–°å®‰è£…ä¾èµ–
- éœ€è¦é…ç½® Redis è¿æ¥
- å¯èƒ½ä¸å½“å‰ç³»ç»Ÿä¸å…¼å®¹

## å½’æ¡£å†å²

- **åˆ›å»ºæ—¶é—´**: 2024-01-15 10:00:00
- **æœ€åæ›´æ–°**: 2024-01-15 10:30:00
- **å½’æ¡£å·¥å…·**: archiving-content v3.0
- **æ‰§è¡ŒçŠ¶æ€**: âœ… æˆåŠŸ
```

---

## é“¾æ¥æ›´æ–°è¯¦è§£

### é“¾æ¥ç±»å‹

#### 1. MDC é“¾æ¥

**æ ¼å¼**: `[æ–‡æœ¬](mdc:path/to/file.md)`

**ç¤ºä¾‹**:
```markdown
# æ›´æ–°å‰
[æ—§è®¤è¯](mdc:skills/old-authentication/SKILL.md)

# æ›´æ–°å
[æ—§è®¤è¯(å·²å½’æ¡£)](mdc:.codebuddy/spec/archive/skills/2024-01-15_old-authentication-skill/SKILL.md)
```

#### 2. ç›¸å¯¹é“¾æ¥

**æ ¼å¼**: `[æ–‡æœ¬](../path/to/file.md)`

**ç¤ºä¾‹**:
```markdown
# æ›´æ–°å‰ (åœ¨ docs/api.md ä¸­)
[è®¤è¯æ¨¡å—](../skills/old-authentication/README.md)

# æ›´æ–°å
[è®¤è¯æ¨¡å—(å·²å½’æ¡£)](../spec/archive/skills/2024-01-15_old-authentication-skill/README.md)
```

#### 3. ç»å¯¹é“¾æ¥

**æ ¼å¼**: `[æ–‡æœ¬](/absolute/path/to/file.md)`

**ç¤ºä¾‹**:
```markdown
# æ›´æ–°å‰
[é…ç½®](/config/auth.json)

# æ›´æ–°å
[é…ç½®(å·²å½’æ¡£)](/spec/archive/config/2024-01-15_old-auth-config/auth.json)
```

### é“¾æ¥æ£€æŸ¥æµç¨‹

#### æ­¥éª¤ 1: æœç´¢æ‰€æœ‰é“¾æ¥

```bash
# æœç´¢ MDC é“¾æ¥
grep -r "mdc:skills/old-authentication" . \
    --include="*.md" \
    --exclude-dir=".git" \
    --exclude-dir="node_modules" \
    --exclude-dir="spec/archive"

# æœç´¢ç›¸å¯¹é“¾æ¥
grep -r "\.\./.*skills/old-authentication" . \
    --include="*.md" \
    --exclude-dir=".git" \
    --exclude-dir="node_modules" \
    --exclude-dir="spec/archive"

# æœç´¢ç»å¯¹é“¾æ¥
grep -r "/skills/old-authentication" . \
    --include="*.md" \
    --exclude-dir=".git" \
    --exclude-dir="node_modules" \
    --exclude-dir="spec/archive"
```

#### æ­¥éª¤ 2: åˆ†æé“¾æ¥ä¸Šä¸‹æ–‡

å¯¹äºæ¯ä¸ªæ‰¾åˆ°çš„é“¾æ¥ï¼š
1. è¯»å–æ–‡ä»¶å†…å®¹
2. ç¡®å®šé“¾æ¥åœ¨æ–‡æ¡£ä¸­çš„ä½œç”¨
3. å†³å®šæ›´æ–°ç­–ç•¥ (æ›´æ–°è·¯å¾„ vs æ ‡æ³¨å·²å½’æ¡£)

#### æ­¥éª¤ 3: æ‰§è¡Œæ›´æ–°

```bash
# ä½¿ç”¨ sed æ‰¹é‡æ›´æ–°
sed -i 's|mdc:skills/old-authentication|mdc:.codebuddy/spec/archive/skills/2024-01-15_old-authentication-skill|g' file.md
```

#### æ­¥éª¤ 4: éªŒè¯æ›´æ–°

```bash
# æ£€æŸ¥æ›´æ–°åçš„æ–‡ä»¶
grep -r "spec/archive/skills/2024-01-15_old-authentication-skill" . \
    --include="*.md" \
    --exclude-dir=".git"
```

### é“¾æ¥æ›´æ–°ç­–ç•¥

| é“¾æ¥ç±»å‹ | æ›´æ–°ç­–ç•¥ | ç¤ºä¾‹ |
|---------|---------|------|
| æ–‡æ¡£å¼•ç”¨ | æ›´æ–°è·¯å¾„ + æ ‡æ³¨å½’æ¡£ | `[æ–‡æ¡£(å·²å½’æ¡£)](æ–°è·¯å¾„)` |
| ä»£ç ç¤ºä¾‹ | ä¿ç•™åŸè·¯å¾„ + æ·»åŠ è¯´æ˜ | åŸè·¯å¾„ + `<!-- å·²å½’æ¡£ -->` |
| å¯¼èˆªé“¾æ¥ | ç§»é™¤æˆ–æ›´æ–° | ä»ç›®å½•ä¸­ç§»é™¤ |
| å†å²è®°å½• | ä¿ç•™åŸè·¯å¾„ + æ ‡æ³¨ | `~~æ—§è·¯å¾„~~ (å·²å½’æ¡£)` |

---

## æœ€ä½³å®è·µè¯¦è§£

### å½’æ¡£æ—¶æœºæœ€ä½³å®è·µ

#### ç«‹å³å½’æ¡£çš„æƒ…å†µ

1. **åŠŸèƒ½å®Œå…¨ä¸‹çº¿**
   - æ‰€æœ‰ç”¨æˆ·å·²è¿ç§»
   - ç›‘æ§æ•°æ®æ˜¾ç¤ºæ— è®¿é—®
   - ä»£ç å·²ä»ä¸»åˆ†æ”¯ç§»é™¤

2. **å®‰å…¨æ¼æ´ä¿®å¤**
   - æ—§ä»£ç å­˜åœ¨å·²çŸ¥æ¼æ´
   - æ–°ç‰ˆæœ¬å·²ä¿®å¤å¹¶ä¸Šçº¿
   - æ—§ç‰ˆæœ¬éœ€è¦ç¦ç”¨

3. **é‡å¤§æ¶æ„å˜æ›´**
   - æ¶æ„å·²å®Œå…¨é‡æ„
   - æ—§å®ç°ä¸å†é€‚ç”¨
   - æ–°æ¶æ„å·²ç¨³å®šè¿è¡Œ

#### å»¶è¿Ÿå½’æ¡£çš„æƒ…å†µ

1. **æ¸è¿›å¼è¿ç§»ä¸­**
   - éƒ¨åˆ†ç”¨æˆ·ä»åœ¨ä½¿ç”¨
   - è¿ç§»è®¡åˆ’æœªå®Œæˆ
   - éœ€è¦ä¿ç•™å›æ»šé€‰é¡¹

2. **A/B æµ‹è¯•æœŸé—´**
   - æ–°æ—§ç‰ˆæœ¬åŒæ—¶è¿è¡Œ
   - æµ‹è¯•æ•°æ®æ”¶é›†ä¸­
   - æœªåšæœ€ç»ˆå†³ç­–

### å½’æ¡£åˆ†ç±»æœ€ä½³å®è·µ

#### åˆ†ç±»åŸåˆ™

1. **æŒ‰åŠŸèƒ½æ¨¡å—åˆ†ç±»**
   ```
   spec/archive/
   â”œâ”€â”€ auth/           # è®¤è¯ç›¸å…³
   â”œâ”€â”€ payment/        # æ”¯ä»˜ç›¸å…³
   â”œâ”€â”€ notification/   # é€šçŸ¥ç›¸å…³
   ```

2. **æŒ‰æŠ€æœ¯ç±»å‹åˆ†ç±»**
   ```
   spec/archive/
   â”œâ”€â”€ skills/         # æŠ€èƒ½
   â”œâ”€â”€ commands/       # å‘½ä»¤
   â”œâ”€â”€ docs/           # æ–‡æ¡£
   ```

3. **æ··åˆåˆ†ç±»** (æ¨è)
   ```
   spec/archive/
   â”œâ”€â”€ skills/
   â”‚   â”œâ”€â”€ auth/
   â”‚   â””â”€â”€ payment/
   â”œâ”€â”€ docs/
   â”‚   â”œâ”€â”€ api/
   â”‚   â””â”€â”€ design/
   ```

### å›¢é˜Ÿåä½œæœ€ä½³å®è·µ

#### å½’æ¡£å‰æ²Ÿé€š

**æ²Ÿé€šæ£€æŸ¥æ¸…å•**:
- [ ] åœ¨å›¢é˜Ÿä¼šè®®ä¸Šè®¨è®ºå½’æ¡£è®¡åˆ’
- [ ] å‘é€å½’æ¡£é€šçŸ¥é‚®ä»¶
- [ ] åœ¨ Slack/Teams ä¸­å…¬å‘Š
- [ ] æ›´æ–°é¡¹ç›®çœ‹æ¿
- [ ] è®°å½•åœ¨ä¼šè®®çºªè¦ä¸­

**é€šçŸ¥æ¨¡æ¿**:
```markdown
ğŸ“¢ å½’æ¡£é€šçŸ¥

**å½’æ¡£å†…å®¹**: skills/old-authentication
**å½’æ¡£æ—¶é—´**: 2024-01-15
**å½’æ¡£åŸå› **: å·²å‡çº§åˆ° OAuth 2.0
**å½±å“èŒƒå›´**: è®¤è¯æ¨¡å—ï¼ŒAPI ç«¯ç‚¹å˜æ›´
**æ›¿ä»£æ–¹æ¡ˆ**: skills/oauth2-authentication
**è¿ç§»æŒ‡å—**: docs/migration/oauth2-migration.md

è¯·ç›¸å…³å¼€å‘è€…åœ¨å½’æ¡£å‰ç¡®è®¤æ— å½±å“ã€‚
å¦‚æœ‰ç–‘é—®ï¼Œè¯·è”ç³» @zhangsan
```

#### å½’æ¡£åè·Ÿè¿›

1. **æ›´æ–°æ–‡æ¡£**
   - åœ¨ CHANGELOG ä¸­è®°å½•
   - æ›´æ–°æ¶æ„æ–‡æ¡£
   - æ›´æ–° API æ–‡æ¡£

2. **æ¸…ç†ä¾èµ–**
   - ç§»é™¤ä¸å†éœ€è¦çš„ npm åŒ…
   - æ¸…ç†æ•°æ®åº“è¡¨
   - åˆ é™¤ç›¸å…³é…ç½®

3. **çŸ¥è¯†ä¼ æ‰¿**
   - ç»„ç»‡åˆ†äº«ä¼š
   - æ›´æ–°åŸ¹è®­ææ–™
   - è®°å½•ç»éªŒæ•™è®­

---

## å½’æ¡£ç­–ç•¥

### ä¿ç•™ç­–ç•¥è¯¦è§£

| å†…å®¹ç±»å‹ | ä¿ç•™æœŸé™ | æ¸…ç†ç­–ç•¥ | å¤‡æ³¨ |
|---------|---------|---------|------|
| åºŸå¼ƒä»£ç  | 2å¹´ | å¯æ°¸ä¹…ä¿ç•™ | é‡è¦å†å²å‚è€ƒ |
| è¿‡æ—¶æ–‡æ¡£ | 1å¹´ | å®šæœŸè¯„ä¼° | ç‰ˆæœ¬æ–‡æ¡£ä¿ç•™ |
| ä¸´æ—¶è„šæœ¬ | 6ä¸ªæœˆ | ç¡®è®¤ååˆ é™¤ | ä¸€æ¬¡æ€§ä½¿ç”¨ |
| å®éªŒä»£ç  | 3ä¸ªæœˆ | å¤±è´¥åˆ™åˆ é™¤ | æˆåŠŸåˆ™æ­£å¼åŒ– |
| æ—§ç‰ˆæœ¬å¿«ç…§ | æ ¹æ®ç‰ˆæœ¬æ”¿ç­– | ä¿ç•™ä¸»ç‰ˆæœ¬ | å‚è€ƒç‰ˆæœ¬ç­–ç•¥ |
| æµ‹è¯•æ•°æ® | 3ä¸ªæœˆ | å®šæœŸæ¸…ç† | ä¿ç•™å…¸å‹æ¡ˆä¾‹ |
| ä¸´æ—¶é…ç½® | 1ä¸ªæœˆ | ç«‹å³åˆ é™¤ | è¿ç§»å®Œæˆå |

### ç‰ˆæœ¬ä¿ç•™ç­–ç•¥

**è¯­ä¹‰åŒ–ç‰ˆæœ¬ (SemVer)**:
```
- ä¿ç•™æ‰€æœ‰ä¸»ç‰ˆæœ¬ (1.x, 2.x, 3.x)
- ä¿ç•™æœ€è¿‘ 3 ä¸ªæ¬¡ç‰ˆæœ¬ (3.1, 3.2, 3.3)
- åªä¿ç•™æœ€æ–°çš„ä¿®è®¢ç‰ˆ (3.3.5)
```

**ç¤ºä¾‹**:
```
âœ… ä¿ç•™: 1.0.0, 2.0.0, 3.0.0 (ä¸»ç‰ˆæœ¬)
âœ… ä¿ç•™: 3.1.0, 3.2.0, 3.3.0 (æœ€è¿‘æ¬¡ç‰ˆæœ¬)
âœ… ä¿ç•™: 3.3.5 (æœ€æ–°ä¿®è®¢ç‰ˆ)
âŒ åˆ é™¤: 1.1.0, 2.5.0 (æ—§æ¬¡ç‰ˆæœ¬)
âŒ åˆ é™¤: 3.3.0, 3.3.1, 3.3.2 (æ—§ä¿®è®¢ç‰ˆ)
```

### æ¸…ç†æµç¨‹

#### å®šæœŸæ¸…ç†æ£€æŸ¥

```bash
#!/bin/bash
# quarterly-archive-cleanup.sh

echo "å¼€å§‹å­£åº¦å½’æ¡£æ¸…ç†æ£€æŸ¥..."

# æ£€æŸ¥è¶…è¿‡ä¿ç•™æœŸé™çš„å½’æ¡£
find spec/archive -type d -mtime +180 -name "2*_*"

# åˆ†æå½’æ¡£å¤§å°
du -sh spec/archive/*

# ç”Ÿæˆæ¸…ç†å»ºè®®æŠ¥å‘Š
echo "ç”Ÿæˆæ¸…ç†å»ºè®®..."
```

#### æ¸…ç†å†³ç­–æµç¨‹

```mermaid
graph TD
    A[å‘ç°å½’æ¡£] --> B{è¶…è¿‡ä¿ç•™æœŸé™?}
    B -->|å¦| C[ä¿ç•™]
    B -->|æ˜¯| D{æ˜¯å¦æœ‰ä»·å€¼?}
    D -->|æ˜¯| E[å»¶é•¿ä¿ç•™æœŸé™]
    D -->|å¦| F{æ˜¯å¦è¢«å¼•ç”¨?}
    F -->|æ˜¯| G[æ ‡æ³¨ä½†ä¿ç•™]
    F -->|å¦| H[åˆ é™¤]
```

---

## è‡ªåŠ¨åŒ–å½’æ¡£

### è‡ªåŠ¨æ£€æµ‹è„šæœ¬

```bash
#!/bin/bash
# auto-detect-archive-candidates.sh

echo "æ£€æµ‹å½’æ¡£å€™é€‰é¡¹..."

# 1. æ£€æŸ¥æ ‡è®°ä¸º deprecated çš„ä»£ç 
echo "1. æ£€æŸ¥ @deprecated æ ‡è®°..."
grep -r "@deprecated" src/ --include="*.ts" --include="*.js" | \
  awk -F: '{print $1}' | sort | uniq

# 2. æ£€æŸ¥è¶…è¿‡ 6 ä¸ªæœˆæœªä¿®æ”¹çš„ä¸´æ—¶æ–‡ä»¶
echo "2. æ£€æŸ¥ä¸´æ—¶æ–‡ä»¶..."
find workspace/temp -type f -mtime +180 -ls

# 3. æ£€æŸ¥è¿‡æ—¶çš„æ–‡æ¡£ç‰ˆæœ¬
echo "3. æ£€æŸ¥æ—§ç‰ˆæœ¬æ–‡æ¡£..."
find docs/ -name "*-v[0-9]*" -type f

# 4. æ£€æŸ¥æœªè¢«å¼•ç”¨çš„æ–‡ä»¶
echo "4. æ£€æŸ¥æœªå¼•ç”¨æ–‡ä»¶..."
# (éœ€è¦æ›´å¤æ‚çš„ä¾èµ–åˆ†æ)

# ç”Ÿæˆå½’æ¡£å»ºè®®æŠ¥å‘Š
echo "ç”Ÿæˆå½’æ¡£å»ºè®®æŠ¥å‘Š: archive-candidates.md"
```

### Git é’©å­é›†æˆ

#### pre-commit é’©å­

```bash
#!/bin/bash
# .git/hooks/pre-commit

echo "æ£€æŸ¥å½’æ¡£æ ‡è®°..."

# æ£€æŸ¥æ˜¯å¦æœ‰æ–°å¢çš„ @deprecated ä»£ç 
if git diff --cached | grep -i "@deprecated"; then
    echo "âš ï¸  è­¦å‘Š: å‘ç°æ–°å¢çš„ @deprecated æ ‡è®°"
    echo "è€ƒè™‘æ˜¯å¦åº”è¯¥ç›´æ¥å½’æ¡£è€Œä¸æ˜¯æäº¤?"
    read -p "ç»§ç»­æäº¤? (y/n) " confirm
    if [ "$confirm" != "y" ]; then
        exit 1
    fi
fi

# æ£€æŸ¥æ˜¯å¦ä¿®æ”¹äº†å½’æ¡£ç›®å½•
if git diff --cached --name-only | grep "^spec/archive/"; then
    echo "âš ï¸  è­¦å‘Š: æ­£åœ¨ä¿®æ”¹å½’æ¡£ç›®å½•"
    echo "å½’æ¡£ç›®å½•é€šå¸¸ä¸åº”è¯¥è¢«ä¿®æ”¹"
    read -p "ç¡®è®¤ç»§ç»­? (y/n) " confirm
    if [ "$confirm" != "y" ]; then
        exit 1
    fi
fi
```

### å®šæœŸå½’æ¡£ä»»åŠ¡

```bash
#!/bin/bash
# cron-archive-check.sh
# æ·»åŠ åˆ° crontab: 0 0 1 */3 * /path/to/cron-archive-check.sh

echo "æ‰§è¡Œå®šæœŸå½’æ¡£æ£€æŸ¥..."
date

# è¿è¡Œè‡ªåŠ¨æ£€æµ‹
./auto-detect-archive-candidates.sh > /tmp/archive-candidates-$(date +%Y%m%d).log

# å‘é€é€šçŸ¥
if [ -s /tmp/archive-candidates-$(date +%Y%m%d).log ]; then
    echo "å‘ç°å½’æ¡£å€™é€‰é¡¹ï¼Œå·²å‘é€é€šçŸ¥"
    # å‘é€é‚®ä»¶æˆ– Slack é€šçŸ¥
fi
```

---

## å·¥å…·é›†æˆ

### IDE é›†æˆ

#### VS Code ä»»åŠ¡é…ç½®

```json
// .vscode/tasks.json
{
  "version": "2.0.0",
  "tasks": [
    {
      "label": "å½’æ¡£å½“å‰æ–‡ä»¶",
      "type": "shell",
      "command": "./scripts/archive.sh",
      "args": [
        "${relativeFile}",
        "${input:category}",
        "${input:reason}"
      ],
      "problemMatcher": []
    },
    {
      "label": "æ£€æŸ¥å½’æ¡£å€™é€‰",
      "type": "shell",
      "command": "./scripts/auto-detect-archive-candidates.sh",
      "problemMatcher": []
    }
  ],
  "inputs": [
    {
      "id": "category",
      "type": "pickString",
      "description": "é€‰æ‹©å½’æ¡£åˆ†ç±»",
      "options": ["skills", "commands", "docs", "templates", "standards"]
    },
    {
      "id": "reason",
      "type": "promptString",
      "description": "å½’æ¡£åŸå› "
    }
  ]
}
```

#### IntelliJ IDEA å¤–éƒ¨å·¥å…·

```xml
<!-- Settings > Tools > External Tools -->
<tool name="å½’æ¡£æ–‡ä»¶"
      showInMainMenu="true"
      showInEditor="true"
      showInProject="true"
      showInSearchPopup="true"
      disabled="false"
      useConsole="true"
      showConsoleOnStdOut="false"
      showConsoleOnStdErr="false"
      synchronizeAfterRun="true">
  <exec>
    <option name="COMMAND" value="$ProjectFileDir$/scripts/archive.sh" />
    <option name="PARAMETERS" value="$FilePathRelativeToProjectRoot$ $Prompt$ $Prompt$" />
    <option name="WORKING_DIRECTORY" value="$ProjectFileDir$" />
  </exec>
</tool>
```

### æ–‡æ¡£å·¥å…·é›†æˆ

#### Confluence é›†æˆ

```javascript
// confluence-sync-archive.js
const confluence = require('confluence-api');

async function syncArchiveIndex() {
  const archiveIndex = fs.readFileSync('spec/archive/README.md', 'utf-8');
  
  await confluence.putContent({
    spaceKey: 'PROJ',
    pageId: '12345',
    title: 'å½’æ¡£ç´¢å¼•',
    content: archiveIndex,
    version: { number: await getNextVersion() }
  });
}
```

#### Slack é€šçŸ¥

```javascript
// slack-archive-notification.js
const { WebClient } = require('@slack/web-api');
const slack = new WebClient(process.env.SLACK_TOKEN);

async function notifyArchive(archiveInfo) {
  await slack.chat.postMessage({
    channel: '#dev-notifications',
    text: `ğŸ“¦ æ–°å½’æ¡£åˆ›å»º`,
    blocks: [
      {
        type: 'section',
        text: {
          type: 'mrkdwn',
          text: `*å½’æ¡£å†…å®¹*: ${archiveInfo.name}\n*åŸå› *: ${archiveInfo.reason}`
        }
      }
    ]
  });
}
```

---

## å¸¸è§é—®é¢˜è§£ç­”

### Q1: å½’æ¡£åå¦‚ä½•å¿«é€ŸæŸ¥æ‰¾å†…å®¹ï¼Ÿ

**ç­”æ¡ˆ**:

1. **ä½¿ç”¨å½’æ¡£ç´¢å¼•**
   ```bash
   # æŸ¥çœ‹å…¨å±€ç´¢å¼•
   cat spec/archive/README.md
   ```

2. **ä½¿ç”¨ find å‘½ä»¤**
   ```bash
   # æŒ‰åç§°æœç´¢
   find spec/archive -name "*authentication*"
   
   # æŒ‰æ—¥æœŸæœç´¢
   find spec/archive -name "2024-01*"
   ```

3. **ä½¿ç”¨ grep æœç´¢å†…å®¹**
   ```bash
   # æœç´¢å½’æ¡£åŸå› 
   grep -r "OAuth" spec/archive/*/ARCHIVE-INFO.md
   
   # æœç´¢ç‰¹å®šä»£ç 
   grep -r "function login" spec/archive/
   ```

4. **ä½¿ç”¨ IDE å…¨å±€æœç´¢**
   - VS Code: `Ctrl+Shift+F`
   - IntelliJ: `Ctrl+Shift+F`

### Q2: å½’æ¡£ä¼šå½±å“ Git å†å²å—ï¼Ÿ

**ç­”æ¡ˆ**: ä¸ä¼šã€‚

å½’æ¡£æ˜¯åœ¨å½“å‰ Git åˆ†æ”¯ä¸­ç§»åŠ¨æ–‡ä»¶ï¼ŒGit å†å²å®Œæ•´ä¿ç•™ï¼š

```bash
# æŸ¥çœ‹æ–‡ä»¶çš„å®Œæ•´å†å²
git log --follow -- spec/archive/skills/2024-01-15_old-auth/SKILL.md

# æŸ¥çœ‹å½’æ¡£å‰çš„ç‰ˆæœ¬
git log -- skills/old-authentication/SKILL.md
```

### Q3: å¦‚ä½•æ¢å¤å½’æ¡£çš„å†…å®¹ï¼Ÿ

**ç­”æ¡ˆ**:

```bash
# æ–¹æ³• 1: å¤åˆ¶å½’æ¡£åˆ°æ–°ä½ç½®
cp -r spec/archive/skills/2024-01-15_old-auth/ \
     skills/restored-auth/

# æ–¹æ³• 2: ä½¿ç”¨ Git æ¢å¤ç‰¹å®šç‰ˆæœ¬
git checkout <commit-hash> -- skills/old-authentication/

# æ–¹æ³• 3: ä½¿ç”¨å½’æ¡£å…ƒæ•°æ®ä¸­çš„å›æ»šå‘½ä»¤
# (å‚è€ƒ ARCHIVE-INFO.md ä¸­çš„å›æ»šä¿¡æ¯)
```

### Q4: å½’æ¡£ç›®å½•å¤ªå¤§æ€ä¹ˆåŠï¼Ÿ

**ç­”æ¡ˆ**:

1. **å®šæœŸæ¸…ç†**
   ```bash
   # åˆ é™¤è¿‡æœŸå½’æ¡£
   find spec/archive -type d -mtime +730 -exec rm -rf {} \;
   ```

2. **å‹ç¼©å½’æ¡£**
   ```bash
   # å‹ç¼©æ—§å½’æ¡£
   tar -czf archive-2023.tar.gz spec/archive/*/2023-*
   rm -rf spec/archive/*/2023-*
   ```

3. **è¿ç§»åˆ°å¤–éƒ¨å­˜å‚¨**
   ```bash
   # ä¸Šä¼ åˆ°äº‘å­˜å‚¨
   aws s3 sync spec/archive/ s3://project-archives/
   ```

4. **ä½¿ç”¨ Git LFS**
   ```bash
   # é…ç½®å¤§æ–‡ä»¶å­˜å‚¨
   git lfs track "spec/archive/**/*"
   ```

### Q5: å¦‚ä½•å¤„ç†å½’æ¡£ä¸­çš„æ•æ„Ÿä¿¡æ¯ï¼Ÿ

**ç­”æ¡ˆ**:

1. **å½’æ¡£å‰æ¸…ç†**
   ```bash
   # åˆ é™¤æ•æ„Ÿæ–‡ä»¶
   rm -f config/secrets.json
   
   # æ›¿æ¢æ•æ„Ÿä¿¡æ¯
   sed -i 's/password=.*/password=***/' config.ini
   ```

2. **ä½¿ç”¨ .gitignore**
   ```
   # spec/archive/.gitignore
   **/secrets.json
   **/credentials.yml
   **/*.key
   ```

3. **åˆ†ç¦»æ•æ„Ÿæ•°æ®**
   ```
   # å°†æ•æ„Ÿæ•°æ®ç§»åˆ°å®‰å…¨ä½ç½®
   mv spec/archive/skills/2024-01-15_auth/secrets/ \
      /secure/archive/
   ```

### Q6: å½’æ¡£æ˜¯å¦åº”è¯¥æäº¤åˆ° Gitï¼Ÿ

**ç­”æ¡ˆ**: æ˜¯çš„ï¼Œä½†æœ‰é€‰æ‹©æ€§ã€‚

**åº”è¯¥æäº¤**:
- ä»£ç å’Œæ–‡æ¡£å½’æ¡£
- ARCHIVE-INFO.md å…ƒæ•°æ®
- å½’æ¡£ç´¢å¼•æ›´æ–°

**ä¸åº”è¯¥æäº¤**:
- å¤§å‹äºŒè¿›åˆ¶æ–‡ä»¶ï¼ˆä½¿ç”¨ Git LFSï¼‰
- æ•æ„Ÿä¿¡æ¯
- ä¸´æ—¶æ„å»ºäº§ç‰©

```bash
# æäº¤å½’æ¡£
git add spec/archive/skills/2024-01-15_old-auth/
git add spec/archive/README.md
git commit -m "chore: archive old authentication skill"
```

### Q7: å¦‚ä½•æ‰¹é‡å½’æ¡£å¤šä¸ªæ–‡ä»¶ï¼Ÿ

**ç­”æ¡ˆ**:

```bash
#!/bin/bash
# batch-archive.sh

CATEGORY="skills"
REASON="æ‰¹é‡å½’æ¡£æ—§æŠ€èƒ½"

# è¯»å–æ–‡ä»¶åˆ—è¡¨
while read path; do
  echo "å½’æ¡£: $path"
  ./scripts/archive.sh "$path" "$CATEGORY" "$REASON"
done < archive-list.txt
```

### Q8: å½’æ¡£å’Œåˆ é™¤æœ‰ä»€ä¹ˆåŒºåˆ«ï¼Ÿ

**ç­”æ¡ˆ**:

| æ“ä½œ | å½’æ¡£ | åˆ é™¤ |
|------|------|------|
| **æ–‡ä»¶ä¿ç•™** | âœ… ä¿ç•™åœ¨å½’æ¡£ç›®å½• | âŒ å®Œå…¨åˆ é™¤ |
| **å†å²è®°å½•** | âœ… å®Œæ•´ä¿ç•™ | âš ï¸  ä»åœ¨ Git å†å²ä¸­ |
| **å¯æ¢å¤æ€§** | âœ… å®¹æ˜“æ¢å¤ | âš ï¸  éœ€è¦ Git æ“ä½œ |
| **å…ƒæ•°æ®** | âœ… åŒ…å«å½’æ¡£ä¿¡æ¯ | âŒ æ—  |
| **é€‚ç”¨åœºæ™¯** | å¯èƒ½éœ€è¦å‚è€ƒ | ç¡®å®šä¸å†éœ€è¦ |

**å»ºè®®**: é™¤éç¡®å®šæ°¸è¿œä¸éœ€è¦ï¼Œå¦åˆ™ä½¿ç”¨å½’æ¡£è€Œä¸æ˜¯åˆ é™¤ã€‚

---

## å‚è€ƒèµ„æº

- [ä¿¡æ¯ç”Ÿå‘½å‘¨æœŸç®¡ç†](https://en.wikipedia.org/wiki/Information_lifecycle_management)
- [Git Archive æœ€ä½³å®è·µ](https://www.atlassian.com/git/tutorials/git-archive)
- [ä»£ç å®¡æŸ¥æœ€ä½³å®è·µ](https://github.com/joho/awesome-code-review)
- [æŠ€æœ¯å€ºåŠ¡ç®¡ç†](https://martinfowler.com/bliki/TechnicalDebt.html)

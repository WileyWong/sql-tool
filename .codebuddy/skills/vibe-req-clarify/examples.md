---
title: req-clarify 示例
description: 需求澄清的实际应用示例
---

# 需求澄清示例

本文档提供完整的需求澄清示例，展示从识别模糊点到记录决议的全过程。

---

## 示例 1: 电商订单管理（完整流程 - 按模块推进）

### 场景描述

**原始需求**（来自 PRD）:

```
需求标题: 订单管理功能

需求描述:
用户可以在线下单购买商品，系统支持多种支付方式。
订单提交后，系统扣减库存并通知商家发货。
用户可以查看订单详情、申请退款。

业务目标:
完善电商交易闭环，提升用户购物体验。
```

**变更 ID**: `2025-11-07-order-management`

**需求来源**: PRD 文本

---

### 步骤 1: 选择推进方式

**AI 的询问**:

```
您希望如何推进需求澄清？

1️⃣ 单个问题逐一确认 - 适合高精度决策（每个问题单独确认）
2️⃣ 按模块/功能点逐项确认 - 适合结构化推进（推荐，已有功能点清单）
3️⃣ 一次性全部确认 - 适合快速闭环（一次性回答所有问题）

请选择: 1 / 2 / 3
```

**用户回复**: `2`（按模块推进）

**AI 的记录**（写入 `clarifications.md`）:

```markdown
---
变更ID: 2025-11-07-order-management
执行策略: 按模块/功能点逐项确认
创建时间: 2025-11-07 09:00
状态: 进行中
---

# 需求澄清记录

## 执行策略

**推进方式**: 按模块/功能点逐项确认

**优点**:
- 结构化推进，逻辑清晰
- 可按优先级处理不同模块
- 便于团队协作和分工

**适用场景**:
- 需求已拆分为多个功能点（FR）
- 需要分模块澄清业务规则
- 团队成员可并行处理不同模块
```

---

### 步骤 2: 识别问题（4 大维度扫描）

**AI 的分析**:

AI 基于 PRD 识别出 **3 个功能模块**，每个模块有若干待澄清问题：

#### 模块 1: 订单下单（FR-001）

**待澄清问题**（4 个）:
1. **业务规则**: 库存不足时如何处理？
2. **业务规则**: 支付超时订单如何处理？
3. **数据模型**: 订单金额计算规则是什么？
4. **异常边界**: 并发下单同一商品如何处理？

#### 模块 2: 订单查看（FR-002）

**待澄清问题**（2 个）:
1. **权限可见性**: 用户能否查看他人订单？
2. **数据模型**: 订单历史保留多久？

#### 模块 3: 订单退款（FR-003）

**待澄清问题**（3 个）:
1. **业务规则**: 哪些订单状态可以申请退款？
2. **业务规则**: 退款审核流程是什么？
3. **异常边界**: 退款失败如何处理？

**统计**: 共识别 **9 个待澄清问题**

---

### 步骤 3: 生成确认项（按模块组织）

**AI 的操作**: 将 9 个问题写入 `clarifications.md`，按模块分组。

#### 确认项示例（模块 1 的第一个问题）:

```markdown
---

## 模块 1: 订单下单（FR-001）

### [NEEDS CLARIFICATION] 业务规则: 库存不足处理

**当前描述**: 订单提交后，系统扣减库存

**关联功能**: 订单下单功能（FR-001）

**需要澄清的问题**:
1. 库存不足时，是否允许下单？
2. 如何提示用户？
3. 已下单但库存扣减失败如何处理？

**方案选项**（三选一）:

- **方案 A: 拒绝下单**
  - 描述: 库存不足时提示 "库存不足"，不创建订单
  - 优点: 
    - 逻辑简单，避免超卖
    - 用户立即得到反馈
  - 缺点: 
    - 用户体验稍差（无法下单）
    - 可能流失订单

- **方案 B: 支持预下单**
  - 描述: 订单状态为 "待补货"，补货后自动发货
  - 优点: 
    - 用户体验好，不丢失订单
    - 提升转化率
  - 缺点: 
    - 增加状态管理复杂度
    - 需要通知用户补货进度

- **方案 C: 超卖后退款**
  - 描述: 允许下单，库存不足时扣款后自动退款
  - 优点: 
    - 最大化订单数量
  - 缺点: 
    - 用户体验极差（扣款后退款）
    - 可能引发投诉

**建议方案**: **方案 A**（拒绝下单）
- 理由: 初期逻辑简单，避免超卖风险；后期可升级为方案 B

**影响评估**: 
如不澄清，可能导致:
- 业务流程无法确定（开发无法编码）
- 用户体验不一致（不同场景表现不同）
- 后期大量返工（修改业务逻辑成本高）
- 风险等级: 🔴 **P0**（阻塞性问题，必须在设计前澄清）
```

---

### 步骤 4: 提问并记录决议（按模块推进）

**AI 的询问**（模块 1 的 4 个问题）:

```
现在开始澄清 **模块 1: 订单下单（FR-001）** 的问题。

---

**问题 1/4: 库存不足处理**

当前描述: 订单提交后，系统扣减库存

需要澄清的问题:
1. 库存不足时，是否允许下单？
2. 如何提示用户？

方案选项（三选一）:
- 方案 A: 拒绝下单（推荐）
- 方案 B: 支持预下单
- 方案 C: 超卖后退款

请选择方案（A/B/C）或提供其他方案: 
```

**用户回复**: `A`

**AI 的记录**（更新 `clarifications.md`）:

```markdown
### [CLARIFIED] 业务规则: 库存不足处理

**关联功能**: 订单下单功能（FR-001）

**决议**: **方案 A**（拒绝下单）
**理由**: 初期逻辑简单，避免超卖风险；后期可根据业务需要升级为预下单

**验收标准**:
1. 库存不足时提示 "库存不足，请稍后再试"
2. 不创建订单记录
3. 不扣减库存
4. 不扣减用户余额或积分

**影响范围**: 订单功能、库存功能

**决议时间**: 2025-11-07 09:15
**决议人**: 产品经理张三

---
```

**AI 继续询问**（问题 2/4）:

```
**问题 2/4: 支付超时处理**

当前描述: 用户可以在线支付订单

需要澄清的问题:
1. 支付超时时间是多久？
2. 超时后订单如何处理？

方案选项（三选一）:
- 方案 A: 15 分钟超时，自动取消订单并释放库存（推荐）
- 方案 B: 30 分钟超时，自动取消订单并释放库存
- 方案 C: 不设超时，订单永久有效

请选择方案（A/B/C）或提供其他方案: 
```

**用户回复**: `B，但是希望用户可以手动延长一次`

**AI 的记录**:

```markdown
### [CLARIFIED] 业务规则: 支付超时处理

**关联功能**: 订单下单功能（FR-001）

**决议**: **方案 B**（30 分钟超时）+ **用户可手动延长一次**
**理由**: 
- 30 分钟给用户充足的支付时间
- 支持延长功能提升用户体验
- 避免恶意占用库存

**验收标准**:
1. 订单创建后 30 分钟内未支付，自动取消订单
2. 用户可在超时前 5 分钟内点击"延长支付时间"按钮，延长 15 分钟（仅一次）
3. 订单取消后自动释放库存
4. 发送通知提醒用户支付（超时前 5 分钟）

**影响范围**: 订单功能、库存功能、消息通知功能

**决议时间**: 2025-11-07 09:20
**决议人**: 产品经理张三

**额外说明**: 
- 延长功能仅限一次，避免用户无限延长
- 延长按钮在超时前 5 分钟出现
```

---

**AI 继续询问**（问题 3/4、4/4）...

**模块 1 澄清完成后，AI 汇总并询问是否继续**:

```
✅ **模块 1: 订单下单（FR-001）** 澄清完成！

已澄清问题: 4 个
- 库存不足处理 → 方案 A（拒绝下单）
- 支付超时处理 → 方案 B（30 分钟超时 + 手动延长一次）
- 订单金额计算规则 → 商品金额 + 运费 - 优惠券 - 积分
- 并发下单处理 → 数据库行锁 + 乐观锁版本号

---

是否继续澄清 **模块 2: 订单查看（FR-002）**？（是/否）
```

**用户回复**: `是`

**AI 继续澄清模块 2、模块 3...**

---

### 步骤 5: 回填审查文档（可选）

**AI 的操作**: 检查是否存在 `requirement-review.md`。

```
检查路径: workspace/2025-11-07-order-management/requirements/requirement-review.md

状态: ❌ 文件不存在
操作: 跳过回填步骤
```

---

### 步骤 6: 验证闭环

**AI 的操作**: 生成摘要报告。

```markdown
---

## 澄清摘要报告

**变更 ID**: 2025-11-07-order-management
**生成时间**: 2025-11-07 10:00
**澄清状态**: ✅ 已完成

### 统计数据

| 状态 | 数量 | 占比 |
|------|------|------|
| 已澄清（CLARIFIED） | 9 | 100% |
| 待澄清（NEEDS CLARIFICATION） | 0 | 0% |
| 不需澄清（NOT-NEEDED） | 0 | 0% |

### 影响的功能模块

| 模块名称 | FR 编号 | 澄清问题数 | 状态 |
|----------|---------|------------|------|
| 订单下单 | FR-001 | 4 | ✅ 已完成 |
| 订单查看 | FR-002 | 2 | ✅ 已完成 |
| 订单退款 | FR-003 | 3 | ✅ 已完成 |

### 关键决议摘要

**FR-001: 订单下单**
1. 库存不足 → 拒绝下单
2. 支付超时 → 30 分钟超时 + 手动延长一次
3. 订单金额计算 → 商品 + 运费 - 优惠券 - 积分
4. 并发下单 → 数据库行锁 + 乐观锁

**FR-002: 订单查看**
1. 权限控制 → 用户只能查看自己的订单
2. 历史保留 → 保留 3 年，超期归档

**FR-003: 订单退款**
1. 可退款状态 → 已支付、已发货、已签收（7 天内）
2. 退款审核 → 客服人工审核（1 个工作日内）
3. 退款失败 → 自动重试 3 次，失败后人工介入

### 后续行动

✅ 澄清阶段已完成，可以进入下一阶段:
- [ ] 生成正式的需求规格说明书（使用 `req-explain` 技能）
- [ ] 进行 API 设计（使用 `design-api` 技能）
- [ ] 进行数据库设计（使用 `design-db` 技能）

### 相关文档

- 澄清记录: `workspace/2025-11-07-order-management/requirements/clarifications.md`
- 需求审查: `workspace/2025-11-07-order-management/requirements/requirement-review.md`（不存在）
```

---

## 示例 2: 用户注册功能（单个问题逐一确认）

### 场景描述

**原始需求**（来自 TAPD）:

```
需求标题: 用户注册功能

需求描述:
用户可以通过手机号注册账号。注册时需要填写手机号、密码、验证码。
密码需要符合一定的强度要求。
```

**变更 ID**: `2025-11-08-user-registration`

---

### 步骤 1: 选择推进方式

**AI 的询问**:

```
您希望如何推进需求澄清？

1️⃣ 单个问题逐一确认 - 适合高精度决策
2️⃣ 按模块/功能点逐项确认 - 适合结构化推进
3️⃣ 一次性全部确认 - 适合快速闭环

请选择: 1 / 2 / 3
```

**用户回复**: `1`（单个问题逐一确认）

---

### 步骤 2: 识别问题

**AI 的分析**:

识别出 **5 个待澄清问题**:

1. **业务规则**: 密码强度要求具体是什么？
2. **业务规则**: 验证码有效期多久？发送频率限制？
3. **业务规则**: 手机号已注册如何处理？
4. **数据模型**: 用户名是否必填？是否唯一？
5. **异常边界**: 验证码发送失败如何处理？

---

### 步骤 3 + 4: 生成确认项并逐一提问

**AI 的询问**（问题 1/5）:

```markdown
---

**问题 1/5: 密码强度要求**

**当前描述**: 密码需要符合一定的强度要求

**关联功能**: 用户注册功能（FR-001）

**需要澄清的问题**:
1. 密码长度要求是什么？
2. 密码是否必须包含数字、字母、特殊字符？
3. 是否区分大小写？

**方案选项**（四选一）:

- **方案 A: 基础强度**
  - 长度: 6-20 位
  - 组成: 数字 + 字母（不区分大小写）
  - 优点: 用户易记，降低注册门槛
  - 缺点: 安全性较低

- **方案 B: 中等强度**（推荐）
  - 长度: 8-20 位
  - 组成: 数字 + 字母（区分大小写）
  - 优点: 安全性适中，平衡易用性
  - 缺点: 用户需记忆大小写

- **方案 C: 高强度**
  - 长度: 8-20 位
  - 组成: 数字 + 字母（区分大小写）+ 特殊字符（至少 1 个）
  - 优点: 安全性高
  - 缺点: 用户记忆难度大，影响注册转化率

- **方案 D: 自定义强度**
  - 请描述您的要求

**建议方案**: 方案 B（中等强度）
- 理由: 平衡安全性和用户体验

**影响评估**: 
如不澄清，可能导致:
- 开发无法实现密码验证逻辑
- 用户体验不一致（过严或过松）
- 风险等级: 🔴 **P0**（阻塞性问题）

---

请选择方案（A/B/C/D）或描述自定义要求: 
```

**用户回复**: `B`

**AI 的记录**:

```markdown
### [CLARIFIED] 业务规则: 密码强度要求

**关联功能**: 用户注册功能（FR-001）

**决议**: **方案 B**（中等强度）
- 长度: 8-20 位
- 组成: 数字 + 字母（区分大小写）

**验收标准**:
1. 密码长度必须在 8-20 位之间
2. 密码必须包含至少 1 个数字和 1 个字母
3. 密码区分大小写
4. 密码不符合要求时提示 "密码必须包含 8-20 位数字和字母（区分大小写）"

**影响范围**: 用户注册功能

**决议时间**: 2025-11-08 10:00
**决议人**: 产品经理李四
```

---

**AI 继续询问**（问题 2/5）:

```
✅ 问题 1/5 已澄清！

---

**问题 2/5: 验证码有效期和发送频率**

【问题详情...】

请选择方案（A/B/C）或描述自定义要求: 
```

**用户回复**: `A，但是希望发送频率是 60 秒`

**AI 的记录**:

```markdown
### [CLARIFIED] 业务规则: 验证码有效期和发送频率

**关联功能**: 用户注册功能（FR-001）

**决议**: **方案 A**（5 分钟有效期）+ **发送频率 60 秒**
- 验证码有效期: 5 分钟
- 发送频率: 60 秒（用户自定义）

**验收标准**:
1. 验证码 5 分钟后失效
2. 同一手机号 60 秒内只能发送一次验证码
3. 验证码过期时提示 "验证码已过期，请重新获取"
4. 频率限制时提示 "操作过于频繁，请 XX 秒后再试"（倒计时显示）

**影响范围**: 用户注册功能、短信发送功能

**决议时间**: 2025-11-08 10:05
**决议人**: 产品经理李四
```

---

**AI 继续询问问题 3/5、4/5、5/5...**

---

### 步骤 6: 验证闭环

**AI 的操作**: 生成摘要报告。

```markdown
## 澄清摘要报告

**变更 ID**: 2025-11-08-user-registration
**生成时间**: 2025-11-08 10:30
**澄清状态**: ✅ 已完成

### 统计数据

| 状态 | 数量 | 占比 |
|------|------|------|
| 已澄清（CLARIFIED） | 5 | 100% |
| 待澄清（NEEDS CLARIFICATION） | 0 | 0% |

### 关键决议摘要

1. 密码强度 → 8-20 位，数字 + 字母（区分大小写）
2. 验证码 → 5 分钟有效期，60 秒发送频率
3. 手机号已注册 → 提示并引导登录
4. 用户名 → 非必填，可重复，注册后可修改
5. 验证码发送失败 → 自动重试 3 次，失败后提示用户

### 后续行动

✅ 澄清阶段已完成，可以进入下一阶段
```

---

## 示例 3: 一次性全部确认（快速闭环）

### 场景描述

**原始需求**:

```
需求标题: 商品评价功能

需求描述:
用户购买商品后可以对商品进行评价。评价包括星级评分和文字评价。
```

**变更 ID**: `2025-11-09-product-review`

---

### 步骤 1: 选择推进方式

**用户回复**: `3`（一次性全部确认）

---

### 步骤 2-3: 识别问题并生成确认项

**AI 的分析**: 识别出 **4 个待澄清问题**。

---

### 步骤 4: 一次性提问

**AI 的询问**:

```markdown
现在一次性提出所有需要澄清的问题，请逐一回答:

---

**问题 1: 评价时机**

需要澄清的问题:
1. 用户何时可以评价？（下单后/发货后/签收后）
2. 评价时间限制是多久？

方案选项:
- A: 签收后 7 天内可评价（推荐）
- B: 签收后 15 天内可评价
- C: 签收后永久可评价

请选择（A/B/C）: ___

---

**问题 2: 评价内容**

需要澄清的问题:
1. 星级评分范围是什么？（1-5 星 / 1-10 分）
2. 文字评价是否必填？最少/最多字数？

方案选项:
- A: 1-5 星，文字非必填，最多 500 字（推荐）
- B: 1-10 分，文字必填，最少 10 字，最多 500 字
- C: 1-5 星，文字必填，最少 20 字，最多 1000 字

请选择（A/B/C）: ___

---

**问题 3: 评价修改**

需要澄清的问题:
1. 用户是否可以修改已发布的评价？
2. 修改次数限制？

方案选项:
- A: 不允许修改（推荐）
- B: 允许修改 1 次（评价发布后 7 天内）
- C: 允许无限次修改

请选择（A/B/C）: ___

---

**问题 4: 匿名评价**

需要澄清的问题:
1. 是否支持匿名评价？

方案选项:
- A: 不支持匿名，显示用户昵称（推荐）
- B: 支持匿名，隐藏用户昵称
- C: 用户自主选择（是否匿名）

请选择（A/B/C）: ___

---

请提供您的答案（格式: 问题1-A, 问题2-B, 问题3-A, 问题4-C）: 
```

**用户回复**: `问题1-A, 问题2-A, 问题3-B, 问题4-C`

---

### 步骤 5: 批量记录决议

**AI 的操作**: 将所有决议批量写入 `clarifications.md`。

```markdown
### [CLARIFIED] 业务规则: 评价时机

**决议**: 方案 A（签收后 7 天内可评价）

【验收标准...】

---

### [CLARIFIED] 业务规则: 评价内容

**决议**: 方案 A（1-5 星，文字非必填，最多 500 字）

【验收标准...】

---

### [CLARIFIED] 业务规则: 评价修改

**决议**: 方案 B（允许修改 1 次，评价发布后 7 天内）

【验收标准...】

---

### [CLARIFIED] 业务规则: 匿名评价

**决议**: 方案 C（用户自主选择是否匿名）

【验收标准...】
```

---

### 步骤 6: 验证闭环

**AI 的操作**: 生成摘要报告。

```markdown
## 澄清摘要报告

✅ 澄清阶段已完成（一次性全部确认）

已澄清问题: 4 个
```

---

## 示例 4: 迭代澄清（决议引发新问题）

### 场景描述

**原始需求**: 订单退款功能

**变更 ID**: `2025-11-10-order-refund`

---

### 第一轮澄清

**AI 的询问**（问题 1/3）:

```
**问题 1/3: 可退款的订单状态**

方案选项:
- A: 仅"已支付"状态可退款
- B: "已支付"和"已发货"状态可退款（推荐）
- C: "已支付"、"已发货"、"已签收（7 天内）"状态可退款

请选择（A/B/C）: 
```

**用户回复**: `C`

**AI 的记录**:

```markdown
### [CLARIFIED] 业务规则: 可退款的订单状态

**决议**: 方案 C（已支付、已发货、已签收 7 天内可退款）

【验收标准...】
```

---

### 决议引发新问题

**AI 的分析**:

```
⚠️ 检测到新问题:

用户选择了"已签收（7 天内）可退款"，这引发了新的待澄清问题:

1. 如果商品已拆封/已使用，是否仍可退款？
2. 签收时间如何计算？（签收当天算第 1 天 / 签收次日算第 1 天）
3. 退货运费由谁承担？

是否需要澄清这些新问题？（是/否）
```

**用户回复**: `是`

---

### 第二轮澄清

**AI 的询问**（追加问题 1/3）:

```
**追加问题 1/3: 商品状态限制**

需要澄清的问题:
1. 如果商品已拆封/已使用，是否仍可退款？

方案选项:
- A: 未拆封可退款，已拆封不可退款（推荐）
- B: 拆封可退款，但已使用不可退款
- C: 无论是否拆封/使用，均可退款

请选择（A/B/C）: 
```

**用户回复**: `B`

**AI 的记录**:

```markdown
### [CLARIFIED] 业务规则: 商品状态限制（追加）

**关联功能**: 订单退款功能（FR-003）
**关联决议**: 可退款的订单状态（方案 C）

**决议**: 方案 B（拆封可退款，但已使用不可退款）

【验收标准...】

**备注**: 本问题由"可退款的订单状态"决议引发
```

---

**AI 继续询问追加问题 2/3、3/3...**

---

### 最终验证

**AI 的操作**: 生成摘要报告。

```markdown
## 澄清摘要报告

**澄清轮次**: 2 轮
- 第 1 轮: 3 个问题
- 第 2 轮: 3 个追加问题（由第 1 轮决议引发）

已澄清问题: 6 个（含追加问题）
```

---

## 示例 5: 回填审查文档

### 场景描述

**原始需求**: 用户登录功能

**变更 ID**: `2025-11-11-user-login`

**前置条件**: 已存在 `requirement-review.md`（需求审查文档）

---

### 步骤 1-4: 澄清问题

**AI 的操作**: 完成澄清，生成 `clarifications.md`。

---

### 步骤 5: 回填审查文档

**AI 的操作**: 检查 `requirement-review.md` 是否存在。

```
✅ 检测到需求审查文档:
   workspace/2025-11-11-user-login/requirements/requirement-review.md

操作: 将决议同步回填到 requirement-review.md
```

**回填示例**:

**原始 `requirement-review.md`（澄清前）**:

```markdown
## FR-001: 用户登录

### 确认项

#### [NEEDS CLARIFICATION] 登录方式

**问题**: 支持哪些登录方式？（手机号/邮箱/用户名）
**优先级**: P0
**影响**: 影响用户体验和技术实现
```

**更新后 `requirement-review.md`（澄清后）**:

```markdown
## FR-001: 用户登录

### 确认项

#### [CLARIFIED] 登录方式

**问题**: 支持哪些登录方式？（手机号/邮箱/用户名）
**优先级**: P0
**影响**: 影响用户体验和技术实现

**决议**: 支持手机号 + 密码登录（初期）
**理由**: 简化开发，后期可扩展邮箱/第三方登录
**决议时间**: 2025-11-11 14:00
**决议人**: 产品经理王五

**验收标准**:
1. 用户输入手机号 + 密码
2. 验证手机号格式（11 位数字）
3. 验证密码正确性
4. 登录成功后生成 JWT Token
```

**AI 的通知**:

```
✅ 决议已同步回填到 requirement-review.md

更新内容:
- FR-001: 登录方式（NEEDS CLARIFICATION → CLARIFIED）
```

---

## 总结

以上示例展示了需求澄清的完整流程：

1. **示例 1**: 按模块推进（3 个模块，9 个问题）
2. **示例 2**: 单个问题逐一确认（5 个问题）
3. **示例 3**: 一次性全部确认（4 个问题）
4. **示例 4**: 迭代澄清（决议引发新问题）
5. **示例 5**: 回填审查文档（同步到 requirement-review.md）

**核心要点**:
- ✅ 每个问题提供 2-4 个方案（含优缺点和建议）
- ✅ 只澄清业务逻辑，不涉及技术实现
- ✅ 按推进方式组织（单个/按模块/一次性）
- ✅ 所有决议必须记录（含验收标准）
- ✅ 迭代澄清（决议引发新问题时追加）
- ✅ 可选回填审查文档（同步到 requirement-review.md）

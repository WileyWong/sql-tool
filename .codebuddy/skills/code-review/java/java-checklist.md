# Java 代码审查检查清单

完整的 Java 代码审查检查清单，确保审查质量和一致性。

> ⚠️ **Spring Boot 项目**: 请同时参考 [Spring Boot 专项检查清单](springboot-review.md#检查清单)

---

## 🟢 基础审查 (15-30min)

### 编码规范
- [ ] 类名使用大驼峰命名法（PascalCase）
- [ ] 方法名使用小驼峰命名法（camelCase）
- [ ] 常量使用大写字母和下划线（UPPER_SNAKE_CASE）
- [ ] 没有魔法值（使用常量替代）
- [ ] 没有未使用的 import 语句

### 代码格式
- [ ] 缩进使用 4 个空格
- [ ] 单行长度不超过 120 字符
- [ ] 代码通过 Checkstyle/SonarQube 检查

---

## 🟡 标准审查 (45-60min)

**包含基础审查 +**

### 注释完整性
- [ ] 所有公共类有类级 JavaDoc 注释
- [ ] 所有公共方法有方法级 JavaDoc 注释
- [ ] JavaDoc 包含 `@param`、`@return`、`@throws` 标签
- [ ] 没有被注释掉的代码

### 架构设计
- [ ] 服务边界清晰（职责单一）
- [ ] 依赖方向正确（Controller → Service → Repository）
- [ ] 不存在循环依赖
- [ ] 使用构造器注入（避免字段注入）

### 接口设计
- [ ] 接口符合 RESTful 规范
- [ ] URL 使用名词复数（如 `/users`）
- [ ] HTTP 方法语义正确
- [ ] 响应格式统一

### 代码质量
- [ ] Controller 职责单一（只负责参数验证和调用 Service）
- [ ] Service 方法职责单一
- [ ] 使用 `@Transactional` 控制事务
- [ ] 方法长度不超过 50 行

### 安全防护
- [ ] 输入参数有验证（`@NotNull`、`@NotBlank` 等）
- [ ] 敏感接口有权限控制（`@PreAuthorize`）
- [ ] SQL 使用参数化查询（`#{}` 而非 `${}`）
- [ ] 响应不返回密码字段

### Java 8+ 特性检查
- [ ] Optional 不作为字段或方法参数
- [ ] 没有 `optional.get()` 不检查的情况
- [ ] Stream 没有副作用操作
- [ ] 没有多次消费同一个 Stream
- [ ] BigDecimal 使用字符串构造器
- [ ] 时间 API 正确处理时区

---

## 🔴 专业审查 (2-3h)

**包含标准审查 +**

### 安全深度检查（OWASP Top 10）
- [ ] 密码使用 BCrypt 加密
- [ ] 敏感数据脱敏显示
- [ ] 日志不包含敏感信息
- [ ] 配置使用加密存储
- [ ] ⚠️ 无 SSRF 风险（用户 URL 白名单验证）
- [ ] ⚠️ 无 XXE 风险（XML 解析器禁用外部实体）
- [ ] ⚠️ 无 IDOR 风险（验证资源所有权）
- [ ] ⚠️ 无 Mass Assignment（使用 DTO 而非实体绑定）
- [ ] ⚠️ 无日志注入风险（用户输入不直接写日志）

### 性能优化
- [ ] 热点数据使用缓存
- [ ] 避免 N+1 查询
- [ ] 分页查询有索引支持
- [ ] 耗时操作使用异步处理
- [ ] 数据库连接池配置合理
- [ ] Redis 连接池配置合理

### 可维护性
- [ ] 圈复杂度不超过 10
- [ ] 嵌套层级不超过 3 层
- [ ] 参数数量不超过 5 个
- [ ] 关键业务逻辑有单元测试
- [ ] 单元测试覆盖率 > 70%

### 异常处理
- [ ] 不捕获并吞掉异常
- [ ] 不抛出 Exception（使用具体异常）
- [ ] 使用全局异常处理器
- [ ] 异常信息清晰明确

### 日志记录
- [ ] 关键操作有日志
- [ ] 异常有日志（包含堆栈）
- [ ] 日志级别合理

### 资源管理
- [ ] ThreadLocal 在 finally 中清理
- [ ] 数据库连接正确关闭
- [ ] 文件流正确关闭（try-with-resources）

---

## 常见问题检查

### 编码规范问题
- [ ] 没有使用无意义的变量名（a、b、temp）
- [ ] 没有过长的方法（> 50 行）
- [ ] 没有过深的嵌套（> 3 层）
- [ ] 没有过多的参数（> 5 个）

### 安全问题
- [ ] 没有 SQL 注入风险
- [ ] 没有 XSS 攻击风险
- [ ] 没有密码明文存储
- [ ] 没有敏感数据泄露
- [ ] 没有权限绕过风险
- [ ] 没有 SSRF 风险
- [ ] 没有 XXE 风险
- [ ] 没有 IDOR 风险

### 性能问题
- [ ] 没有 N+1 查询问题
- [ ] 没有全表扫描
- [ ] 没有大事务
- [ ] 没有内存泄漏
- [ ] 没有线程安全问题
- [ ] 没有 ThreadLocal 泄漏

### Java 8+ 典型错误
- [ ] 没有 `optional.get()` 不检查
- [ ] 没有并行流滥用（小数据量/IO 操作）
- [ ] 没有 Stream 副作用
- [ ] 没有 BigDecimal double 构造器
- [ ] 没有时区处理错误

---

## 评分计算

| 维度 | 权重 | 得分 |
|------|------|------|
| 编码规范 | 15% | /100 |
| 架构设计 | 20% | /100 |
| 安全防护 | 30% | /100 |
| 性能优化 | 15% | /100 |
| 可维护性 | 10% | /100 |
| Java 8+ 特性 | 10% | /100 |
| **综合得分** | | **/100** |

> 💡 **说明**: 资源管理（ThreadLocal 清理、连接关闭等）归入可维护性维度

**等级**: A级(≥85) / B级(70-84) / C级(60-69) / D级(<60)

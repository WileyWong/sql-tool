# E2E 测试套件数据模板
# 用法: python testsuite_generator.py --data data.yaml --output TestSuite.xlsx
#
# 必填字段：cases, steps, pom
# 可选字段：test_data, execution_plan, users, global_config, mock_scenes, base_url
#
# 自动生成规则：
# - execution_plan: 不传则根据 cases 自动生成
# - users: 不传则使用默认用户 U001
# - global_config: 不传则使用 25 项默认配置
# - mock_scenes: 不传则使用 7 个默认 Mock 场景

# 基础 URL（可选，会更新全局配置中的 baseURL）
base_url: "https://example.com"

# ============================================================
# 必填：用例定义
# 格式: [用例ID, 系统, 用例名称, 模块, 优先级, 前置条件, 标签, 用例状态, 描述]
# ============================================================
cases:
  - ['TC-示例-页面加载-001', '示例系统', '页面加载', '首页', 'P0', '用户已登录', '冒烟,回归', '已审核', '验证首页正常加载']
  - ['TC-示例-搜索功能-002', '示例系统', '搜索功能', '首页', 'P1', '用户已登录', '回归', '已审核', '验证搜索功能正常']

# ============================================================
# 必填：执行步骤
# 格式: [用例ID, 步骤序号, 步骤描述, 操作类型, 目标元素, 输入值, 等待策略, 等待超时, 断言类型, 期望值, API模式, Mock数据, 备注]
# ============================================================
steps:
  # TC-001 步骤
  - ['TC-示例-页面加载-001', 1, '清理浏览器状态', '清理状态', '', 'localStorage,sessionStorage', '', '', '', '', '', '', '确保测试隔离']
  - ['TC-示例-页面加载-001', 2, '打开首页', 'SPA导航', '/', '', '网络空闲', 30000, '', '', '', '', '']
  - ['TC-示例-页面加载-001', 3, '验证页面标题', '断言', 'pageTitle', '', '', '', '文本等于', '首页', '', '', '']
  - ['TC-示例-页面加载-001', 4, '截图', '截图', '', 'TC-001_首页.png', '', '', '', '', '', '', '']
  # TC-002 步骤
  - ['TC-示例-搜索功能-002', 1, '打开首页', 'SPA导航', '/', '', '网络空闲', 30000, '', '', '', '', '']
  - ['TC-示例-搜索功能-002', 2, '输入搜索关键词', '输入', 'searchInput', '测试', '', '', '', '', '', '', '']
  - ['TC-示例-搜索功能-002', 3, '点击搜索按钮', '点击', 'searchBtn', '', '网络空闲', 5000, '', '', '', '', '']
  - ['TC-示例-搜索功能-002', 4, '验证搜索结果', '断言', 'searchResult', '', '', '', '存在', '', '', '', '']

# ============================================================
# 必填：POM 元素定义
# 格式: [页面ID, 页面名称, 页面URL, 元素ID, 元素名称, 定位方式, 定位值, 等待策略, 等待超时, API模式, 描述]
# ============================================================
pom:
  - ['home', '首页', '/', 'pageTitle', '页面标题', 'CSS选择器', 'h1', '可见', 10000, '', '首页标题']
  - ['home', '首页', '/', 'searchInput', '搜索输入框', 'CSS选择器', 'input[type="search"]', '可见', 5000, '', '']
  - ['home', '首页', '/', 'searchBtn', '搜索按钮', 'Text', '搜索', '可点击', 5000, '', '']
  - ['home', '首页', '/', 'searchResult', '搜索结果', 'CSS选择器', '.search-result', '可见', 10000, '', '']

# ============================================================
# 可选：测试数据（不传则为空）
# 格式: [数据集, 字段名, 字段说明, 值]
# ============================================================
test_data:
  - ['default', 'baseUrl', '基础URL', 'https://example.com']
  - ['default', 'keyword', '搜索关键词', '测试']

# ============================================================
# 可选：执行计划（不传则根据 cases 自动生成）
# 格式: [序号, 用例ID, 执行用户, 数据集, Mock场景, 状态隔离, 覆盖配置, 启用, 执行状态, 备注]
# ============================================================
# execution_plan:
#   - [1, 'TC-示例-页面加载-001', 'U001', 'default', '无', '清理所有Storage', '', '是', '待执行', '']
#   - [2, 'TC-示例-搜索功能-002', 'U001', 'default', '无', '无', '', '是', '待执行', '']

# ============================================================
# 可选：用户配置（不传则使用默认用户）
# 格式: [用户ID, 用户名, 密码, 角色, 权限, 状态, 备注]
# ============================================================
# users:
#   - ['U001', 'testuser', '********', '普通用户', '查看权限', '启用', '测试账号']

# ============================================================
# 可选：全局配置（不传则使用 25 项默认配置）
# 格式: [配置分类, 配置项, 配置值, 说明]
# ============================================================
# global_config:
#   - ['基础配置', 'baseURL', 'https://example.com', '应用基础URL']
#   - ...（共 25 项）

# ============================================================
# 可选：Mock 场景（不传则使用 7 个默认场景）
# 格式: [场景ID, 场景名称, API模式, 响应状态, 响应数据, 延迟(ms), 说明]
# ============================================================
# mock_scenes:
#   - ['MOCK001', '成功', '/api/*', 200, '{"success":true}', 0, '正常响应']

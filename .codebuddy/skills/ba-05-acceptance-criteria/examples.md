# 验收标准生成 - 示例

---

## 简单案例：智能访客管理系统

### 输入材料

> 以下输入来自 ba-04 INVEST 评估的 Must Have 用户故事

```
【故事ID】US001
【故事标题】填写预约基本信息
【用户故事】作为 访客，我希望 填写我的基本信息（姓名、手机号、身份证号），以便 系统能够识别我的身份并用于后续签到核验。
【功能要点】
- 输入姓名（必填，2-20个字符）
- 输入手机号（必填，11位手机号格式）
- 输入身份证号（必填，18位身份证格式）
- 系统自动校验格式正确性
【业务规则】
- 手机号格式校验，支持大陆手机号
- 身份证号格式校验，校验最后一位校验码
- 姓名不允许包含特殊字符

【故事ID】US003
【故事标题】搜索并选择被访人
【用户故事】作为 访客，我希望 通过姓名或工号搜索被访人，以便 准确选择我要拜访的企业员工。
【功能要点】
- 支持姓名模糊搜索
- 支持工号精确搜索
- 显示搜索结果列表（姓名、部门、工号）
- 选择被访人后显示确认信息

【故事ID】US005
【故事标题】提交预约申请
【用户故事】作为 访客，我希望 确认信息后提交预约申请，以便 被访人能够收到通知并进行审批。
【功能要点】
- 显示预约信息确认页
- 提交按钮和返回修改按钮
- 提交成功后显示预约单号
- 推送审批通知给被访人

【故事ID】US008
【故事标题】审批访客预约
【用户故事】作为 被访人，我希望 查看访客信息并审批预约，以便 确认是否接待该访客。
【功能要点】
- 查看访客详细信息（姓名、证件、来访事由）
- 审批操作：通过、拒绝
- 拒绝时填写原因（必填）
- 审批后自动通知访客

【故事ID】US010
【故事标题】扫码签到
【用户故事】作为 访客，我希望 在园区入口扫码签到，以便 快速完成入园登记。
【功能要点】
- 扫描预约二维码
- 显示签到成功页面
- 生成访客通行证（电子/打印）
- 记录签到时间

【故事ID】US011
【故事标题】核验访客身份
【用户故事】作为 安保人员，我希望 核验访客的身份信息，以便 确保入园人员与预约信息一致。
【功能要点】
- 扫描访客二维码获取预约信息
- 比对访客证件与预约信息
- 确认放行或标记异常
- 记录核验结果
```

---

### 输出示例

## US001: 填写预约基本信息

### 用户故事
> 作为 访客，
> 我希望 填写我的基本信息（姓名、手机号、身份证号），
> 以便 系统能够识别我的身份并用于后续签到核验。

---

### 验收标准

#### AC1: 成功填写并保存基本信息

**场景描述**: 访客正确填写所有必填信息后，系统保存数据并允许进入下一步

**Given** 前置条件
- 访客已进入预约申请页面
- 基本信息表单已加载完成

**When** 用户操作
- 访客在姓名输入框输入"张三"
- 访客在手机号输入框输入"13800138000"
- 访客在身份证号输入框输入"110101199001011234"
- 访客点击"下一步"按钮

**Then** 预期结果
- 系统校验通过，无错误提示
- 系统保存填写的信息
- 页面跳转到下一步（选择被访人）
- 返回时能看到已填写的信息

---

#### AC2: 手机号格式错误提示

**场景描述**: 访客输入格式错误的手机号时，系统给出明确的错误提示

**Given** 前置条件
- 访客已进入预约申请页面

**When** 用户操作
- 访客在手机号输入框输入"1380013800"（只有10位）
- 访客点击其他输入框（触发校验）

**Then** 预期结果
- 手机号输入框下方显示红色错误提示："请输入11位手机号"
- 输入框边框变为红色
- "下一步"按钮保持可点击状态，但点击后不跳转并提示错误

---

#### AC3: 身份证号校验码错误提示

**场景描述**: 访客输入校验码错误的身份证号时，系统给出错误提示

**Given** 前置条件
- 访客已进入预约申请页面

**When** 用户操作
- 访客在身份证号输入框输入"110101199001011235"（校验码错误）
- 访客点击其他输入框（触发校验）

**Then** 预期结果
- 身份证号输入框下方显示红色错误提示："身份证号格式不正确"
- 输入框边框变为红色

---

#### AC4: 姓名包含特殊字符提示

**场景描述**: 访客输入包含特殊字符的姓名时，系统给出错误提示

**Given** 前置条件
- 访客已进入预约申请页面

**When** 用户操作
- 访客在姓名输入框输入"张@三"
- 访客点击其他输入框（触发校验）

**Then** 预期结果
- 姓名输入框下方显示红色错误提示："姓名不允许包含特殊字符"
- 输入框边框变为红色

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 姓名最小长度 | 输入1个字符 | 提示"姓名长度为2-20个字符" |
| 姓名最大长度 | 输入21个字符 | 只能输入前20个字符 |
| 手机号非数字 | 输入"1380013800a" | 提示"请输入正确的手机号" |
| 身份证号含X | 输入"11010119900101123X" | 校验通过（X为合法校验码） |
| 全部为空 | 不输入任何内容点击下一步 | 三个输入框都显示必填提示 |
| 手机号首位非1 | 输入"23800138000" | 提示"请输入正确的手机号" |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 表单加载时间 | <2秒 | 页面加载完成到表单可交互 |
| 校验响应时间 | <500ms | 从失焦到显示错误提示 |
| 数据保存时间 | <1秒 | 从点击下一步到跳转完成 |

---

### 界面要求

**必要元素**:
- 姓名输入框（带*必填标识）
- 手机号输入框（带*必填标识）
- 身份证号输入框（带*必填标识）
- 下一步按钮
- 返回按钮

**交互行为**:
- 输入框失焦时自动校验
- 错误提示显示在输入框下方
- 输入框获得焦点时清除错误状态
- 手机号输入框限制只能输入数字

---

### 测试建议

**测试类型**: 功能测试 + E2E测试
**测试数据**: 
- 有效数据：真实格式的姓名、手机号、身份证号
- 无效数据：各种格式错误的输入
**自动化建议**: 高优先级，适合自动化回归测试

---

## 场景覆盖检查

| 场景类型 | 最少数量 | 当前数量 | 检查状态 |
|---------|---------|---------|---------|
| Happy Path（正常流程） | 1 | 1 | ✅ |
| 异常处理（格式错误） | 2 | 3 | ✅ |
| 边界条件 | 2 | 6 | ✅ |

---

## US003: 搜索并选择被访人

### 用户故事
> 作为 访客，
> 我希望 通过姓名或工号搜索被访人，
> 以便 准确选择我要拜访的企业员工。

---

### 验收标准

#### AC1: 通过姓名模糊搜索被访人

**场景描述**: 访客输入部分姓名，系统返回匹配的员工列表

**Given** 前置条件
- 访客已完成基本信息填写
- 访客在选择被访人页面
- 系统中存在员工"张三"、"张三丰"、"李四"

**When** 用户操作
- 访客在搜索框输入"张"
- 系统自动触发搜索（输入后500ms）

**Then** 预期结果
- 显示搜索结果列表，包含"张三"和"张三丰"
- 每个结果显示：姓名、部门、工号
- 不显示"李四"
- 显示搜索结果数量"共2条结果"

---

#### AC2: 通过工号精确搜索被访人

**场景描述**: 访客输入完整工号，系统返回精确匹配的员工

**Given** 前置条件
- 访客在选择被访人页面
- 系统中存在工号"EMP001"的员工"张三"

**When** 用户操作
- 访客在搜索框输入"EMP001"
- 访客点击搜索按钮

**Then** 预期结果
- 显示唯一匹配结果"张三"
- 显示员工详细信息：姓名、部门、工号
- 显示"共1条结果"

---

#### AC3: 选择被访人并确认

**场景描述**: 访客从搜索结果中选择被访人，系统显示确认信息

**Given** 前置条件
- 访客已搜索到被访人列表
- 列表中显示"张三 - 技术部 - EMP001"

**When** 用户操作
- 访客点击"张三"所在行

**Then** 预期结果
- 显示被访人确认卡片
- 卡片内容：姓名"张三"、部门"技术部"、工号"EMP001"
- 显示"确认选择"和"重新选择"按钮
- 点击"确认选择"后进入下一步

---

#### AC4: 搜索无结果处理

**场景描述**: 访客搜索的姓名或工号不存在，系统给出友好提示

**Given** 前置条件
- 访客在选择被访人页面
- 系统中不存在"王五"

**When** 用户操作
- 访客在搜索框输入"王五"
- 系统自动触发搜索

**Then** 预期结果
- 显示空状态提示："未找到匹配的员工，请检查姓名或工号"
- 提供"联系前台"链接
- 搜索框保留输入内容，方便修改

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 搜索关键词为空 | 不输入直接搜索 | 提示"请输入姓名或工号" |
| 搜索关键词过短 | 输入1个字符 | 提示"请输入至少2个字符" |
| 搜索结果过多 | 匹配超过50条 | 显示前50条，提示"请输入更精确的关键词" |
| 特殊字符搜索 | 输入"张@三" | 过滤特殊字符，按"张三"搜索 |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 搜索响应时间 | <1秒 | 从输入完成到显示结果 |
| 结果加载时间 | <500ms | 从点击搜索到列表渲染完成 |
| 搜索防抖 | 500ms | 输入停止500ms后自动搜索 |

---

### 界面要求

**必要元素**:
- 搜索输入框（带搜索图标）
- 搜索按钮
- 结果列表区域
- 被访人确认卡片

**交互行为**:
- 输入时显示加载状态
- 结果列表支持点击选择
- 选中项高亮显示
- 支持键盘上下键选择

---

### 测试建议

**测试类型**: 功能测试 + 接口测试
**测试数据**: 
- 准备10-20条员工数据，覆盖同名、同部门等场景
**自动化建议**: 中优先级，搜索逻辑适合接口自动化

---

## US005: 提交预约申请

### 用户故事
> 作为 访客，
> 我希望 确认信息后提交预约申请，
> 以便 被访人能够收到通知并进行审批。

---

### 验收标准

#### AC1: 成功提交预约申请

**场景描述**: 访客确认信息无误后提交申请，系统生成预约单并通知被访人

**Given** 前置条件
- 访客已完成基本信息填写（姓名、手机号、身份证号）
- 访客已选择被访人"张三"
- 访客已选择来访时间"2025-01-15 上午"
- 访客在预约确认页面

**When** 用户操作
- 访客核对所有信息无误
- 访客点击"提交预约"按钮

**Then** 预期结果
- 显示提交成功页面
- 显示预约单号（格式：VIS + 日期 + 4位序号，如VIS202501150001）
- 显示预约状态"待审批"
- 显示预计审批时间"24小时内"
- 被访人"张三"收到审批通知（微信/短信）

---

#### AC2: 返回修改预约信息

**场景描述**: 访客发现信息有误，返回修改

**Given** 前置条件
- 访客在预约确认页面
- 页面显示已填写的所有信息

**When** 用户操作
- 访客点击"返回修改"按钮

**Then** 预期结果
- 返回到上一步（来访时间选择页面）
- 已填写的信息保留
- 可逐步返回修改任意信息
- 修改后可重新提交

---

#### AC3: 重复提交防护

**场景描述**: 访客快速点击两次提交按钮，系统防止重复提交

**Given** 前置条件
- 访客在预约确认页面
- 网络正常

**When** 用户操作
- 访客快速点击两次"提交预约"按钮

**Then** 预期结果
- 第一次点击后按钮变为"提交中..."并置灰
- 第二次点击无效
- 只生成一个预约单
- 提交成功后按钮恢复但跳转到成功页

---

#### AC4: 网络异常处理

**场景描述**: 提交时网络异常，系统给出友好提示

**Given** 前置条件
- 访客在预约确认页面
- 网络连接不稳定

**When** 用户操作
- 访客点击"提交预约"按钮
- 请求超时（>10秒）

**Then** 预期结果
- 显示错误提示："网络异常，请重试"
- 提交按钮恢复可点击状态
- 已填写信息不丢失
- 提供"重试"按钮

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 被访人已离职 | 提交时被访人状态变更 | 提示"被访人已不在职，请重新选择" |
| 来访时间已过 | 提交时来访时间已过期 | 提示"来访时间已过，请重新选择" |
| 当日预约已满 | 当日预约数达上限 | 提示"当日预约已满，请选择其他日期" |
| 同一访客重复预约 | 同一访客同一天已有预约 | 提示"您已有当日预约，请勿重复申请" |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 提交响应时间 | <3秒 | 从点击提交到显示成功页 |
| 通知发送时间 | <5分钟 | 从提交成功到被访人收到通知 |
| 并发提交 | 100并发 | 压测100个访客同时提交 |

---

### 界面要求

**必要元素**:
- 预约信息汇总（访客信息、被访人、来访时间）
- 提交预约按钮
- 返回修改按钮
- 预约须知/协议勾选

**交互行为**:
- 信息分区展示，清晰易读
- 提交前需勾选"已阅读预约须知"
- 提交中显示加载动画
- 成功后显示预约二维码

---

### 测试建议

**测试类型**: 功能测试 + 接口测试 + 性能测试
**测试数据**: 
- 正常预约数据
- 边界场景数据（离职员工、过期时间等）
**自动化建议**: 高优先级，核心流程适合E2E自动化

---

## US008: 审批访客预约

### 用户故事
> 作为 被访人，
> 我希望 查看访客信息并审批预约，
> 以便 确认是否接待该访客。

---

### 验收标准

#### AC1: 查看待审批预约详情

**场景描述**: 被访人查看访客预约的详细信息

**Given** 前置条件
- 被访人已登录系统
- 有1条待审批的访客预约
- 访客为"李四"，来访时间"2025-01-15 上午"

**When** 用户操作
- 被访人点击待审批通知
- 或进入"我的审批"页面点击该预约

**Then** 预期结果
- 显示预约详情页
- 显示访客信息：姓名"李四"、手机号（中间4位脱敏）、身份证号（中间8位脱敏）
- 显示来访信息：来访时间、来访事由
- 显示"通过"和"拒绝"按钮

---

#### AC2: 通过访客预约

**场景描述**: 被访人审批通过访客预约

**Given** 前置条件
- 被访人在预约详情页
- 预约状态为"待审批"

**When** 用户操作
- 被访人点击"通过"按钮
- 确认通过操作

**Then** 预期结果
- 预约状态变更为"已通过"
- 显示审批成功提示
- 访客"李四"收到通过通知（含签到二维码）
- 审批记录保存（审批人、审批时间、审批结果）

---

#### AC3: 拒绝访客预约

**场景描述**: 被访人拒绝访客预约，需填写拒绝原因

**Given** 前置条件
- 被访人在预约详情页
- 预约状态为"待审批"

**When** 用户操作
- 被访人点击"拒绝"按钮
- 弹出拒绝原因输入框
- 被访人输入"当天有会议，无法接待"
- 点击"确认拒绝"

**Then** 预期结果
- 预约状态变更为"已拒绝"
- 显示拒绝成功提示
- 访客"李四"收到拒绝通知（含拒绝原因）
- 审批记录保存（审批人、审批时间、拒绝原因）

---

#### AC4: 拒绝原因必填校验

**场景描述**: 被访人拒绝时未填写原因，系统提示必填

**Given** 前置条件
- 被访人点击"拒绝"按钮
- 弹出拒绝原因输入框

**When** 用户操作
- 被访人不输入任何内容
- 点击"确认拒绝"

**Then** 预期结果
- 显示错误提示："请填写拒绝原因"
- 拒绝操作不执行
- 输入框获得焦点

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 拒绝原因过短 | 输入少于5个字符 | 提示"拒绝原因至少5个字符" |
| 拒绝原因过长 | 输入超过200个字符 | 限制最多输入200个字符 |
| 预约已过期 | 来访时间已过 | 显示"预约已过期，无需审批" |
| 预约已被处理 | 其他人已审批 | 显示"该预约已被处理" |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 详情加载时间 | <2秒 | 从点击到详情页完全加载 |
| 审批响应时间 | <1秒 | 从点击通过/拒绝到状态变更 |
| 通知发送时间 | <1分钟 | 从审批完成到访客收到通知 |

---

### 界面要求

**必要元素**:
- 访客信息卡片（头像、姓名、联系方式）
- 来访信息（时间、事由）
- 通过按钮（绿色）
- 拒绝按钮（红色）
- 拒绝原因输入框（弹窗）

**交互行为**:
- 敏感信息脱敏显示
- 通过/拒绝前二次确认
- 审批后按钮置灰不可再操作
- 支持左滑快速审批（移动端）

---

### 测试建议

**测试类型**: 功能测试 + 通知测试
**测试数据**: 
- 正常预约数据
- 边界场景数据
**自动化建议**: 高优先级，审批流程适合自动化

---

## US010: 扫码签到

### 用户故事
> 作为 访客，
> 我希望 在园区入口扫码签到，
> 以便 快速完成入园登记。

---

### 验收标准

#### AC1: 扫描二维码成功签到

**场景描述**: 访客使用预约二维码在入口扫码签到

**Given** 前置条件
- 访客预约已通过审批
- 访客持有预约二维码（手机显示）
- 当前时间在来访时间范围内
- 园区入口扫码设备正常

**When** 用户操作
- 访客将手机二维码对准扫码设备
- 设备扫描二维码

**Then** 预期结果
- 设备显示"签到成功"
- 显示访客姓名和被访人信息
- 生成访客通行证（电子版显示在访客手机）
- 记录签到时间
- 被访人收到"访客已到达"通知

---

#### AC2: 选择打印通行证

**场景描述**: 访客签到后选择打印纸质通行证

**Given** 前置条件
- 访客已完成扫码签到
- 签到成功页面显示

**When** 用户操作
- 访客点击"打印通行证"按钮

**Then** 预期结果
- 打印机打印访客通行证
- 通行证包含：访客姓名、被访人、来访日期、有效时间、二维码
- 显示"打印成功，请取走通行证"

---

#### AC3: 预约未通过无法签到

**场景描述**: 访客预约未通过审批，扫码无法签到

**Given** 前置条件
- 访客预约状态为"待审批"或"已拒绝"
- 访客持有预约二维码

**When** 用户操作
- 访客将二维码对准扫码设备

**Then** 预期结果
- 设备显示"签到失败"
- 显示原因："预约未通过审批"或"预约已被拒绝"
- 显示"请联系被访人或前台"
- 不生成通行证

---

#### AC4: 来访时间不在范围内

**场景描述**: 访客在预约时间之外尝试签到

**Given** 前置条件
- 访客预约时间为"2025-01-15 上午（9:00-12:00）"
- 当前时间为"2025-01-15 14:00"
- 访客预约已通过审批

**When** 用户操作
- 访客扫码签到

**Then** 预期结果
- 设备显示"签到失败"
- 显示原因："不在预约时间范围内"
- 显示预约时间"9:00-12:00"
- 提示"如需入园请联系前台"

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 提前签到 | 预约时间前30分钟内 | 允许签到，显示"提前到达" |
| 迟到签到 | 预约时间后30分钟内 | 允许签到，显示"迟到" |
| 二维码过期 | 预约日期已过 | 显示"二维码已过期" |
| 二维码已使用 | 已签到过 | 显示"您已签到，请勿重复操作" |
| 二维码无效 | 非系统生成的二维码 | 显示"无效二维码" |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 扫码识别时间 | <1秒 | 从扫描到识别完成 |
| 签到处理时间 | <2秒 | 从识别到显示结果 |
| 通行证生成时间 | <3秒 | 从签到成功到通行证显示 |
| 打印时间 | <10秒 | 从点击打印到打印完成 |

---

### 界面要求

**必要元素**:
- 扫码区域指示
- 签到结果显示（成功/失败）
- 访客信息确认
- 电子通行证二维码
- 打印通行证按钮

**交互行为**:
- 扫码成功播放提示音
- 签到失败显示红色警告
- 通行证支持保存到手机相册
- 支持截图分享

---

### 测试建议

**测试类型**: 功能测试 + 设备集成测试
**测试数据**: 
- 正常预约二维码
- 各种异常状态二维码
**自动化建议**: 中优先级，需配合硬件设备测试

---

## US011: 核验访客身份

### 用户故事
> 作为 安保人员，
> 我希望 核验访客的身份信息，
> 以便 确保入园人员与预约信息一致。

---

### 验收标准

#### AC1: 扫码获取预约信息

**场景描述**: 安保人员扫描访客通行证获取预约信息

**Given** 前置条件
- 安保人员已登录核验终端
- 访客持有有效通行证（电子或纸质）

**When** 用户操作
- 安保人员使用核验终端扫描通行证二维码

**Then** 预期结果
- 显示访客预约信息
- 信息包含：访客姓名、身份证号（部分脱敏）、被访人、来访时间
- 显示访客证件照片（如已上传）
- 显示"核验通过"和"标记异常"按钮

---

#### AC2: 确认放行

**场景描述**: 安保人员核验无误后确认放行

**Given** 前置条件
- 安保人员已扫描访客通行证
- 显示访客预约信息
- 访客出示身份证，信息与预约一致

**When** 用户操作
- 安保人员点击"核验通过"按钮

**Then** 预期结果
- 显示"核验通过，请放行"
- 记录核验结果（核验人、核验时间、核验结果）
- 通行证状态更新为"已核验"
- 被访人收到"访客已入园"通知

---

#### AC3: 标记异常访客

**场景描述**: 安保人员发现访客信息不符，标记异常

**Given** 前置条件
- 安保人员已扫描访客通行证
- 访客出示身份证，信息与预约不一致

**When** 用户操作
- 安保人员点击"标记异常"按钮
- 选择异常原因："证件信息不符"
- 点击"确认标记"

**Then** 预期结果
- 显示"已标记异常，请联系前台处理"
- 记录异常信息（异常原因、核验人、时间）
- 访客通行证状态更新为"异常"
- 前台收到异常通知

---

#### AC4: 通行证已过期

**场景描述**: 安保人员扫描已过期的通行证

**Given** 前置条件
- 访客通行证有效期为"2025-01-15"
- 当前日期为"2025-01-16"

**When** 用户操作
- 安保人员扫描该通行证

**Then** 预期结果
- 显示"通行证已过期"
- 显示过期时间
- 不显示"核验通过"按钮
- 显示"请联系前台处理"

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 通行证已核验 | 同一通行证再次扫描 | 显示"已核验"，显示上次核验时间 |
| 访客已签退 | 扫描已签退访客通行证 | 显示"访客已离园" |
| 黑名单访客 | 访客在黑名单中 | 显示红色警告"黑名单访客"，需主管审批 |
| 网络异常 | 核验时网络中断 | 使用本地缓存数据核验，标记"离线核验" |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 扫码识别时间 | <1秒 | 从扫描到识别完成 |
| 信息加载时间 | <2秒 | 从识别到显示完整信息 |
| 核验记录保存 | <1秒 | 从点击确认到保存完成 |
| 离线缓存容量 | 1000条 | 支持最近1000条预约离线核验 |

---

### 界面要求

**必要元素**:
- 扫码区域
- 访客信息卡片（照片、姓名、证件号）
- 预约信息（被访人、时间）
- 核验通过按钮（绿色）
- 标记异常按钮（红色）
- 异常原因选择器

**交互行为**:
- 扫码成功播放提示音
- 黑名单访客显示红色警告
- 核验通过显示绿色确认
- 支持语音播报核验结果

---

### 测试建议

**测试类型**: 功能测试 + 设备集成测试 + 安全测试
**测试数据**: 
- 正常通行证
- 异常状态通行证
- 黑名单访客数据
**自动化建议**: 中优先级，需配合硬件设备测试

---

---

## 复杂案例：全球化员工入职管理平台 - 员工类型识别模块

### 输入材料

> 以下输入来自 ba-04 INVEST 评估的 Must Have 用户故事（含拆分后故事）

```
【故事ID】US-001a
【故事标题】基础类型判定（正式员工-社招/校招、实习生）
【用户故事】作为 系统，我希望 根据合同类型和用工方式自动判定正式员工（社招/校招）和实习生类型，以便 覆盖80%的常规入职场景，减少SSC手动选择错误。
【功能要点】
- 入职申请提交时，系统读取合同类型（劳动合同/实习协议）和用工方式（全职/实习）
- 规则匹配：劳动合同+全职+社会招聘 → 正式员工-社招
- 规则匹配：劳动合同+全职+校园招聘 → 正式员工-校招
- 规则匹配：实习协议+实习 → 实习生
- 判定结果记录日志（输入条件、匹配规则、判定结果）

【故事ID】US-001b
【故事标题】外部人员类型判定（外包、派遣、返聘顾问）
【用户故事】作为 系统，我希望 根据用工方式和雇佣主体自动判定外包、派遣、返聘顾问类型，以便 确保外部人员入职流程正确路由。
【功能要点】
- 读取用工方式（外包/派遣/返聘）和雇佣主体（第三方公司/本公司）
- 规则匹配：外包+第三方公司 → 外包人员
- 规则匹配：派遣+第三方公司 → 派遣人员
- 规则匹配：返聘+本公司 → 返聘顾问
- 判定结果记录日志

【故事ID】US-003
【故事标题】手动选择员工类型
【用户故事】作为 SSC专员，我希望 在系统无法自动判定时手动选择员工类型，以便 确保特殊情况下入职流程不被阻塞。
【功能要点】
- 显示待处理的判定失败列表
- 查看入职申请详细信息
- 从12种类型中手动选择
- 填写手动选择原因

【故事ID】US-007b
【故事标题】规则条件配置（4维度）
【用户故事】作为 COE专家，我希望 可视化配置员工类型判定的4维度条件，以便 业务规则变更时无需开发介入。
【功能要点】
- 新增规则：选择目标员工类型
- 配置4维度条件：合同类型（下拉）、雇佣主体（下拉）、用工方式（下拉）、特殊条件（多选）
- 条件组合：支持 AND/OR 逻辑组合
- 规则优先级：拖拽调整优先级顺序
- 保存为草稿
```

---

### 输出示例

## US-001a: 基础类型判定（正式员工-社招/校招、实习生）

### 用户故事
> 作为 系统，
> 我希望 根据合同类型和用工方式自动判定正式员工（社招/校招）和实习生类型，
> 以便 覆盖80%的常规入职场景，减少SSC手动选择错误。

---

### 验收标准

#### AC1: 自动判定正式员工-社招类型

**场景描述**: 系统根据合同类型和招聘来源自动判定为正式员工-社招

**Given** 前置条件
- 入职申请已提交
- 合同类型为"劳动合同"
- 用工方式为"全职"
- 招聘来源为"社会招聘"

**When** 系统触发
- 系统执行员工类型判定规则

**Then** 预期结果
- 员工类型判定为"正式员工-社招"
- 判定日志记录：输入条件（合同类型=劳动合同，用工方式=全职，招聘来源=社招）
- 判定日志记录：匹配规则（规则ID=R001）
- 判定日志记录：判定结果（正式员工-社招）
- 判定日志记录：判定时间戳

---

#### AC2: 自动判定实习生类型 - 数据驱动

**Scenario Outline**: 根据合同类型和用工方式判定基础员工类型

**Given** 前置条件
- 入职申请已提交
- 规则引擎服务正常

**When** 系统触发
- 系统读取合同类型为 <合同类型>
- 系统读取用工方式为 <用工方式>
- 系统读取招聘来源为 <招聘来源>
- 系统执行员工类型判定规则

**Then** 预期结果
- 员工类型判定为 <判定结果>
- 判定日志记录完整

**Examples**:
| 合同类型 | 用工方式 | 招聘来源 | 判定结果 |
|---------|---------|---------|---------|
| 劳动合同 | 全职 | 社会招聘 | 正式员工-社招 |
| 劳动合同 | 全职 | 校园招聘 | 正式员工-校招 |
| 实习协议 | 实习 | 校园招聘 | 实习生 |
| 实习协议 | 实习 | 社会招聘 | 实习生 |

---

#### AC3: 无法匹配规则时标记待人工判定

**场景描述**: 系统无法匹配任何规则时，标记为待人工判定

**Given** 前置条件
- 入职申请已提交
- 合同类型为"劳务合同"（不在规则范围内）
- 用工方式为"全职"

**When** 系统触发
- 系统执行员工类型判定规则
- 无规则匹配

**Then** 预期结果
- 员工类型标记为"待人工判定"
- 入职申请进入SSC待处理队列
- 判定日志记录：无匹配规则
- 发送通知给SSC专员

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 合同类型为空 | 未选择合同类型 | 标记为"待人工判定"，提示"合同类型缺失" |
| 用工方式为空 | 未选择用工方式 | 标记为"待人工判定"，提示"用工方式缺失" |
| 多规则匹配 | 同时满足多条规则 | 按规则优先级取最高优先级规则 |
| 规则服务不可用 | 规则引擎超时 | 使用缓存规则判定，标记"离线判定" |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 判定响应时间 | <500ms | 从申请提交到判定完成 |
| 日志记录时间 | <100ms | 判定完成到日志写入 |
| 规则匹配时间 | <200ms | 单次规则匹配耗时 |
| 并发判定 | 100并发 | 压测100个申请同时判定 |

---

### 测试建议

**测试类型**: 功能测试 + 规则测试 + 性能测试
**测试数据**: 
- 覆盖3种基础类型的组合
- 边界条件数据（缺失字段、异常值）
**自动化建议**: 高优先级，规则判定适合参数化自动化测试

---

## 场景覆盖检查

| 场景类型 | 最少数量 | 当前数量 | 检查状态 |
|---------|---------|---------|---------|
| Happy Path（正常判定） | 1 | 4（数据驱动） | ✅ |
| 异常处理（无匹配规则） | 2 | 1 | ⚠️ 建议补充规则服务异常场景 |
| 边界条件 | 2 | 4 | ✅ |

---

## US-003: 手动选择员工类型

### 用户故事
> 作为 SSC专员，
> 我希望 在系统无法自动判定时手动选择员工类型，
> 以便 确保特殊情况下入职流程不被阻塞。

---

### 验收标准

#### AC1: 查看待处理的判定失败列表

**场景描述**: SSC专员查看所有待人工判定的入职申请

**Given** 前置条件
- SSC专员已登录系统
- 存在3条"待人工判定"的入职申请

**When** 用户操作
- SSC专员进入"待处理"页面

**Then** 预期结果
- 显示待处理列表，共3条记录
- 每条记录显示：申请编号、申请人姓名、提交时间、判定失败原因
- 列表按提交时间倒序排列
- 支持按判定失败原因筛选

---

#### AC2: 查看入职申请详细信息

**场景描述**: SSC专员查看入职申请的完整信息以辅助判定

**Given** 前置条件
- SSC专员在待处理列表页
- 存在待处理申请"ONB-2025-001"

**When** 用户操作
- SSC专员点击申请"ONB-2025-001"

**Then** 预期结果
- 显示申请详情页
- 显示申请人基本信息（姓名、身份证号、联系方式）
- 显示4维度信息（合同类型、雇佣主体、用工方式、特殊条件）
- 显示系统判定失败原因
- 显示"选择员工类型"按钮

---

#### AC3: 手动选择员工类型并提交

**场景描述**: SSC专员手动选择员工类型并填写原因

**Given** 前置条件
- SSC专员在申请详情页
- 申请状态为"待人工判定"

**When** 用户操作
- SSC专员点击"选择员工类型"按钮
- 从12种类型中选择"返聘顾问"
- 在原因输入框填写"该员工为退休返聘，合同类型为劳务合同"
- 点击"确认提交"

**Then** 预期结果
- 员工类型更新为"返聘顾问"
- 申请状态变更为"类型已确定"
- 记录操作日志（操作人、操作时间、选择类型、选择原因）
- 入职流程继续执行
- 该申请从待处理列表移除

---

#### AC4: 选择原因必填校验

**场景描述**: SSC专员未填写选择原因时，系统提示必填

**Given** 前置条件
- SSC专员已选择员工类型"返聘顾问"
- 选择原因输入框为空

**When** 用户操作
- SSC专员点击"确认提交"

**Then** 预期结果
- 显示错误提示："请填写选择原因"
- 提交操作不执行
- 原因输入框获得焦点并显示红色边框

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 选择原因过短 | 输入少于10个字符 | 提示"选择原因至少10个字符" |
| 选择原因过长 | 输入超过500个字符 | 限制最多输入500个字符 |
| 待处理列表为空 | 无待人工判定申请 | 显示空状态"暂无待处理申请" |
| 申请已被他人处理 | 其他SSC专员已处理 | 提示"该申请已被处理"，刷新列表 |
| 并发处理同一申请 | 两人同时处理 | 先提交者成功，后提交者提示冲突 |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 列表加载时间 | <2秒 | 从进入页面到列表完全加载 |
| 详情加载时间 | <1秒 | 从点击到详情页完全加载 |
| 提交响应时间 | <1秒 | 从点击提交到状态变更 |

---

### 界面要求

**必要元素**:
- 待处理列表（申请编号、申请人、时间、失败原因）
- 申请详情卡片
- 员工类型选择器（12种类型）
- 选择原因输入框
- 确认提交按钮

**交互行为**:
- 列表支持分页（每页20条）
- 类型选择器支持搜索过滤
- 原因输入框显示字数统计
- 提交前二次确认

---

### 测试建议

**测试类型**: 功能测试 + 并发测试
**测试数据**: 
- 12种员工类型的选择场景
- 并发处理场景
**自动化建议**: 高优先级，适合E2E自动化

---

## US-007b: 规则条件配置（4维度）

### 用户故事
> 作为 COE专家，
> 我希望 可视化配置员工类型判定的4维度条件，
> 以便 业务规则变更时无需开发介入。

---

### 验收标准

#### AC1: 新增判定规则

**场景描述**: COE专家创建新的员工类型判定规则

**Given** 前置条件
- COE专家已登录规则配置平台
- COE专家有规则配置权限
- 在规则列表页面

**When** 用户操作
- COE专家点击"新增规则"按钮
- 输入规则名称"博士后判定规则"
- 选择目标员工类型"博士后"
- 配置条件：
  - 合同类型 = "劳动合同"
  - 雇佣主体 = "本公司"
  - 用工方式 = "全职"
  - 特殊条件 包含 "博士后站"
- 点击"保存为草稿"

**Then** 预期结果
- 规则保存成功，状态为"草稿"
- 规则列表显示新规则"博士后判定规则"
- 显示保存成功提示
- 规则版本号为"v1.0-draft"

---

#### AC2: 配置条件组合逻辑（AND/OR）

**场景描述**: COE专家配置复杂的条件组合

**Given** 前置条件
- COE专家在规则编辑页面
- 正在编辑"高管判定规则"

**When** 用户操作
- 配置条件组1：职级 >= "VP"
- 选择逻辑运算符"OR"
- 配置条件组2：职务 = "董事"
- 点击"保存"

**Then** 预期结果
- 条件组合保存为：(职级 >= VP) OR (职务 = 董事)
- 规则预览显示条件逻辑
- 规则说明自动生成："满足以下任一条件：职级VP及以上 或 职务为董事"

---

#### AC3: 调整规则优先级

**场景描述**: COE专家通过拖拽调整规则优先级

**Given** 前置条件
- 规则列表存在3条规则
- 优先级顺序：规则A(1) → 规则B(2) → 规则C(3)

**When** 用户操作
- COE专家将规则C拖拽到规则A之前

**Then** 预期结果
- 优先级顺序变更为：规则C(1) → 规则A(2) → 规则B(3)
- 显示"优先级已更新"提示
- 变更记录保存到操作日志

---

#### AC4: 条件配置校验 - 数据驱动

**Scenario Outline**: 校验4维度条件配置的完整性

**Given** 前置条件
- COE专家在规则编辑页面

**When** 用户操作
- 配置合同类型为 <合同类型>
- 配置雇佣主体为 <雇佣主体>
- 配置用工方式为 <用工方式>
- 配置特殊条件为 <特殊条件>
- 点击"保存"

**Then** 预期结果
- 系统显示 <校验结果>

**Examples**:
| 合同类型 | 雇佣主体 | 用工方式 | 特殊条件 | 校验结果 |
|---------|---------|---------|---------|---------|
| 劳动合同 | 本公司 | 全职 | 无 | 保存成功 |
| (空) | 本公司 | 全职 | 无 | 提示"请选择合同类型" |
| 劳动合同 | (空) | 全职 | 无 | 提示"请选择雇佣主体" |
| 劳动合同 | 本公司 | (空) | 无 | 提示"请选择用工方式" |

---

#### AC5: 规则冲突检测

**场景描述**: 系统检测新规则与现有规则的冲突

**Given** 前置条件
- 已存在规则"正式员工-社招"：劳动合同 + 本公司 + 全职 + 社会招聘
- COE专家创建新规则

**When** 用户操作
- 配置条件：劳动合同 + 本公司 + 全职 + 社会招聘（与现有规则完全相同）
- 选择目标类型"正式员工-校招"
- 点击"保存"

**Then** 预期结果
- 显示冲突警告："该条件组合已被规则'正式员工-社招'使用"
- 显示冲突规则详情
- 提供选项："覆盖现有规则"或"修改条件"
- 不自动保存，需用户确认

---

### 边界条件

| 边界场景 | 输入条件 | 预期行为 |
|---------|---------|---------|
| 规则名称重复 | 输入已存在的规则名称 | 提示"规则名称已存在" |
| 规则名称过长 | 输入超过50个字符 | 限制最多输入50个字符 |
| 条件全为空 | 4维度都未选择 | 提示"请至少配置一个条件" |
| 规则数量上限 | 已有100条规则 | 提示"规则数量已达上限" |
| 特殊条件多选 | 选择超过5个特殊条件 | 提示"特殊条件最多选择5个" |

---

### 性能要求

| 性能指标 | 要求 | 测试方法 |
|---------|------|---------|
| 规则保存时间 | <1秒 | 从点击保存到成功提示 |
| 冲突检测时间 | <2秒 | 从保存到冲突检测完成 |
| 优先级调整响应 | <500ms | 从拖拽释放到顺序更新 |
| 规则列表加载 | <2秒 | 100条规则的列表加载 |

---

### 界面要求

**必要元素**:
- 规则名称输入框
- 目标员工类型选择器
- 4维度条件配置区域（合同类型、雇佣主体、用工方式、特殊条件）
- AND/OR逻辑运算符选择
- 规则优先级拖拽区域
- 保存为草稿按钮
- 规则预览区域

**交互行为**:
- 条件配置使用下拉选择器
- 特殊条件支持多选标签
- 拖拽调整优先级时显示占位符
- 保存前显示规则预览
- 冲突检测结果高亮显示

---

### 测试建议

**测试类型**: 功能测试 + 规则冲突测试 + 可用性测试
**测试数据**: 
- 12种员工类型的规则配置
- 冲突规则场景
- 边界条件数据
**自动化建议**: 中优先级，规则配置UI适合E2E自动化

---

## 场景覆盖检查

| 场景类型 | 最少数量 | 当前数量 | 检查状态 |
|---------|---------|---------|---------|
| Happy Path（规则创建、条件配置、优先级调整） | 3 | 3 | ✅ |
| 异常处理（校验失败、冲突检测） | 2 | 2 | ✅ |
| 边界条件 | 2 | 5 | ✅ |
| 数据驱动测试 | 1 | 1 | ✅ |

---

## 整体场景覆盖总结

### 简单案例：智能访客管理系统

| 故事ID | 故事标题 | AC数量 | 边界条件 | 性能要求 | 覆盖状态 |
|--------|---------|--------|---------|---------|---------|
| US001 | 填写预约基本信息 | 4 | 6 | 3 | ✅ 完整 |
| US003 | 搜索并选择被访人 | 4 | 4 | 3 | ✅ 完整 |
| US005 | 提交预约申请 | 4 | 4 | 3 | ✅ 完整 |
| US008 | 审批访客预约 | 4 | 4 | 3 | ✅ 完整 |
| US010 | 扫码签到 | 4 | 5 | 4 | ✅ 完整 |
| US011 | 核验访客身份 | 4 | 4 | 4 | ✅ 完整 |

### 复杂案例：全球化员工入职管理平台

| 故事ID | 故事标题 | AC数量 | 边界条件 | 性能要求 | 覆盖状态 |
|--------|---------|--------|---------|---------|---------|
| US-001a | 基础类型判定 | 3 | 4 | 4 | ✅ 完整 |
| US-003 | 手动选择员工类型 | 4 | 5 | 3 | ✅ 完整 |
| US-007b | 规则条件配置 | 5 | 5 | 4 | ✅ 完整 |

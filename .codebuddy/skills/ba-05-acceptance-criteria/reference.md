# 验收标准编写参考指南

## Given-When-Then 格式详解

### Given（给定/前置条件）

**作用**：描述场景开始时的系统状态和环境条件

**包含内容**：
- 用户状态（已登录/未登录、角色类型）
- 数据状态（购物车有商品、账户余额充足）
- 系统配置（功能开关、规则设置）
- 环境条件（网络正常、设备类型）

**示例**：
```
Given 前置条件
- 客户已登录系统
- 购物车中有3件商品
- 商品库存充足
- 客户已绑定支付方式
```

**常见错误**：
- ❌ 条件过于模糊："用户在页面上"
- ✅ 条件具体明确："用户已登录，且在订单确认页面"

---

### When（当/用户操作）

**作用**：描述触发行为的用户操作或系统事件

**包含内容**：
- 用户点击、输入、选择等操作
- 系统定时任务触发
- 外部事件（如支付回调）

**示例**：
```
When 用户操作
- 客户点击"提交订单"按钮
```

**常见错误**：
- ❌ 操作不具体："用户操作页面"
- ✅ 操作具体明确："用户点击'提交订单'按钮"

---

### Then（那么/预期结果）

**作用**：描述操作后的预期结果，必须可验证

**包含内容**：
- 界面变化（显示内容、跳转页面）
- 数据变化（库存减少、订单生成）
- 系统响应（提示信息、通知发送）
- 状态变化（订单状态、用户状态）

**示例**：
```
Then 预期结果
- 页面跳转到订单成功页
- 显示订单号（格式：ORD + 日期 + 6位序号）
- 库存减少3件
- 发送订单确认短信给客户
```

**常见错误**：
- ❌ 结果不可测试："用户体验良好"
- ✅ 结果可测试："页面加载时间<3秒"

---

## 验收标准类型

### 1. 功能验收
验证功能是否正确实现

```
AC: 订单提交成功
Given 客户已登录，购物车有商品
When 客户点击"提交订单"
Then 生成订单号，订单状态为"待支付"
```

### 2. 数据验收
验证数据计算和存储是否正确

```
AC: 订单金额计算正确
Given 购物车有3件商品，单价100元
When 客户查看订单确认页
Then 显示商品总价300元，运费10元，订单总额310元
```

### 3. 界面验收
验证界面元素和交互是否符合要求

```
AC: 订单列表显示正确
Given 客户有5个历史订单
When 客户进入"我的订单"页面
Then 显示订单列表，每个订单显示订单号、状态、金额、时间
```

### 4. 性能验收
验证性能指标是否达标

```
AC: 页面加载性能
Given 网络正常
When 客户进入订单列表页
Then 页面完全加载时间<3秒
```

### 5. 安全验收
验证安全要求是否满足

```
AC: 敏感信息脱敏显示
Given 客户查看订单详情
When 页面显示收货人信息
Then 手机号中间4位显示为****
```

---

## 边界条件识别方法

### 数值边界
| 边界类型 | 示例 |
|---------|------|
| 最小值 | 数量为1 |
| 最大值 | 数量为999 |
| 边界值-1 | 数量为0 |
| 边界值+1 | 数量为1000 |
| 空值 | 数量为空 |

### 状态边界
| 边界类型 | 示例 |
|---------|------|
| 首次使用 | 新用户第一次下单 |
| 重复使用 | 老用户再次下单 |
| 空数据 | 购物车为空 |
| 满数据 | 购物车达到上限 |

### 时间边界
| 边界类型 | 示例 |
|---------|------|
| 超时 | 支付超时30分钟 |
| 并发 | 多人同时抢购 |
| 重复提交 | 快速点击两次提交 |

---

## Scenario Outline（场景大纲）

### 概述

Scenario Outline 是 Gherkin 语法中用于数据驱动测试的结构，当多个测试场景只有输入数据和预期结果不同时，使用 Scenario Outline 可以避免重复编写相似的测试场景。

### 格式模板

```gherkin
### AC-X: {场景标题} - 数据驱动

**Scenario Outline**: {场景描述}

**Given** {前置条件}
- {条件描述}

**When** {用户操作}
- 用户输入 <输入参数1> 和 <输入参数2>

**Then** {预期结果}
- 系统显示 <预期结果>

**Examples**:
| 输入参数1 | 输入参数2 | 预期结果 |
|-----------|-----------|----------|
| {值1} | {值2} | {结果1} |
| {值3} | {值4} | {结果2} |
| {值5} | {值6} | {结果3} |
```

### 使用场景

| 场景类型 | 说明 | 示例 |
|---------|------|------|
| 登录验证 | 多种用户名/密码组合 | 正确凭证、错误密码、空值等 |
| 格式校验 | 多种输入格式验证 | 手机号、身份证、邮箱格式 |
| 权限校验 | 不同角色访问不同资源 | 管理员、普通用户、访客 |
| 业务规则 | 不同输入产生不同结果 | 金额计算、折扣规则 |
| 边界值测试 | 多组边界数据 | 最小值、最大值、临界值 |
| 状态流转 | 不同状态触发不同行为 | 订单状态、审批状态 |

### 示例1：用户登录验证

```gherkin
### AC1: 用户登录验证 - 数据驱动

**Scenario Outline**: 验证不同凭证的登录结果

**Given** 用户在登录页面
- 系统正常运行

**When** 用户登录
- 用户输入 <用户名> 和 <密码>
- 点击"登录"按钮

**Then** 系统响应
- 系统显示 <登录结果>
- 页面跳转到 <目标页面>

**Examples**:
| 用户名 | 密码 | 登录结果 | 目标页面 |
|--------|------|----------|----------|
| admin | correct123 | 登录成功 | 首页 |
| admin | wrong | 密码错误，请重试 | 登录页 |
| invalid | any | 用户不存在 | 登录页 |
| admin | (空) | 请输入密码 | 登录页 |
| (空) | any | 请输入用户名 | 登录页 |
```

### 示例2：手机号格式校验

```gherkin
### AC2: 手机号格式校验 - 数据驱动

**Scenario Outline**: 验证不同手机号格式的校验结果

**Given** 用户在注册页面
- 已填写其他必填信息

**When** 用户输入手机号
- 用户在手机号输入框输入 <手机号>
- 点击"下一步"按钮

**Then** 系统校验
- 系统显示 <校验结果>
- 按钮状态为 <按钮状态>

**Examples**:
| 手机号 | 校验结果 | 按钮状态 |
|--------|----------|----------|
| 13812345678 | 校验通过 | 可点击 |
| 1381234567 | 手机号格式错误，应为11位 | 禁用 |
| 138123456789 | 手机号格式错误，应为11位 | 禁用 |
| 23812345678 | 手机号格式错误，应以1开头 | 禁用 |
| (空) | 请输入手机号 | 禁用 |
| abcdefghijk | 手机号格式错误，应为数字 | 禁用 |
```

### 示例3：员工类型判定规则

```gherkin
### AC3: 员工类型判定 - 数据驱动

**Scenario Outline**: 验证不同条件组合的员工类型判定结果

**Given** 系统已配置员工类型判定规则
- 规则版本为最新发布版本

**When** 系统判定员工类型
- 输入合同类型为 <合同类型>
- 输入用工方式为 <用工方式>
- 输入招聘渠道为 <招聘渠道>

**Then** 判定结果
- 系统判定员工类型为 <员工类型>
- 判定日志记录完整

**Examples**:
| 合同类型 | 用工方式 | 招聘渠道 | 员工类型 |
|----------|----------|----------|----------|
| 劳动合同 | 全职 | 社会招聘 | 正式员工-社招 |
| 劳动合同 | 全职 | 校园招聘 | 正式员工-校招 |
| 实习协议 | 实习 | 校园招聘 | 实习生 |
| 劳务合同 | 外包 | 第三方 | 外包人员 |
| 派遣协议 | 派遣 | 第三方 | 派遣人员 |
```

### 编写要点

| 要点 | 说明 |
|------|------|
| **参数命名** | 使用 `<参数名>` 格式，参数名应清晰表达含义 |
| **Examples 表格** | 第一行为列标题，后续行为具体数据 |
| **覆盖完整性** | 确保覆盖正常值、边界值、异常值 |
| **结果明确** | 每组数据的预期结果必须明确、可验证 |
| **数据独立** | 每行数据应独立，不依赖其他行的执行结果 |

### 常见错误

| 错误类型 | 错误示例 | 正确做法 |
|---------|---------|---------|
| 参数名不一致 | When 中用 `<用户名>`，Examples 中用 `用户ID` | 保持参数名完全一致 |
| 数据覆盖不全 | 只有正常值，缺少边界值和异常值 | 补充边界值和异常值 |
| 结果不可验证 | 预期结果为"处理成功" | 明确具体的成功表现 |
| Examples 过多 | 超过 10 行数据 | 拆分为多个 Scenario Outline |

---

## 场景覆盖检查表

| 场景类型 | 最少数量 | 说明 |
|---------|---------|------|
| Happy Path | 1 | 正常流程，用户成功完成操作 |
| 异常处理 | 2 | 错误输入、权限不足、网络异常等 |
| 边界条件 | 2 | 空值、最大值、超时等 |
| 权限控制 | 1（如适用） | 不同角色的访问权限 |

---

## 质量检查清单

- [ ] 每条 AC 是否使用 Given-When-Then 格式？
- [ ] Given 条件是否具体明确？
- [ ] When 操作是否可执行？
- [ ] Then 结果是否可测试？
- [ ] 是否覆盖正常流程（Happy Path）？
- [ ] 是否覆盖至少2种异常情况？
- [ ] 是否识别关键边界条件？
- [ ] 是否避免主观性描述？

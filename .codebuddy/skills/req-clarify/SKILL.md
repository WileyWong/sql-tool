---
name: req-clarify
description: 通过结构化提问识别需求中的模糊点和缺失信息,每个问题提供2-4个可选方案,聚焦业务逻辑和功能性需求,不涉及技术实现。
category: requirements
keywords: [需求澄清, clarify, 确认项, confirmation, 业务逻辑]
trigger_words: [需求澄清, 澄清需求, clarify requirements, 确认需求, 需求确认]
---

# Skill: Requirements Clarification (需求澄清)

在设计前通过结构化提问发现需求中的模糊点和缺失信息,每个问题提供 2-4 个可选方案,帮助快速决策。

**聚焦范围**: 业务逻辑和功能性需求,不涉及技术实现、接口设计、性能、安全等。

## 输入/输出

**输入**:
- 需求文档(PRD/用户故事/TAPD链接/口头描述)
- 可选: `workspace/{变更ID}/requirements/requirement-review.md`

**输出**:
- `workspace/{变更ID}/requirements/clarifications.md` (澄清问题和决议)
- 可选: 更新 `requirement-review.md`

**变更ID格式**: `YYYY-MM-DD-feature-name`

## 核心原则

1. **每个问题提供 2-4 个可选方案** (含优缺点和建议)
2. **只澄清业务逻辑** (不涉及技术实现)
3. **按推进方式组织** (单个/按FR/一次性)
4. **所有决议必须记录**

**不澄清的内容**:
- 技术实现、接口设计、技术选型
- 性能指标、安全要求、运维方案

**只澄清的内容**:
- 业务规则、数据实体、权限规则、异常边界

## 执行流程

### 1. 选择推进方式

询问用户选择推进方式,写入 `clarifications.md` 的执行策略章节:

- **单个问题逐一确认** - 适合高精度决策
- **按模块/功能点逐项确认** - 适合结构化推进(已有FR清单时推荐)
- **一次性全部确认** - 适合快速闭环

### 2. 识别问题(4大维度)

按以下维度扫描需求,识别模糊点:

**业务规则**:
- 正常流程、异常场景(失败/超时/重复/并发)
- 边界条件、业务约束

示例:
```markdown
❌ 模糊: 用户可以下单
✅ 需澄清: 库存不足时?(拒绝/预下单/等待补货)
```

**数据模型**:
- 实体属性、字段类型、必填/可选
- 唯一性约束、实体关系

**权限可见性**:
- 访问/编辑权限、数据范围
- 检查粒度(页面/按钮/字段)

**异常边界**:
- 输入空/超长/非法如何处理
- 并发冲突、依赖服务失败

### 3. 生成确认项

为每个问题生成确认项,写入 `clarifications.md`:

```markdown
## [NEEDS CLARIFICATION] {类别}: {标题}

**当前描述**: {原始描述}
**关联功能**: {功能名}(FR编号,如有)

**需要澄清的问题**:
1. {问题1}
2. {问题2}

**方案选项**(N选一):
- **方案A**: {描述}
  - 优点: {优点}
  - 缺点: {缺点}
- **方案B**: ...

**建议方案**: {方案X}
- 理由: {理由}

**影响评估**: 如不澄清,可能导致: {风险}
```

### 4. 提问并记录决议

按推进方式向用户提问,将决议记录为:

```markdown
## [CLARIFIED] {类别}: {标题}

**关联功能**: {功能名}(FR编号,如有)
**决议**: {选择的方案}
**理由**: {理由}

**验收标准**:
1. {标准1}
2. {标准2}

**影响范围**: {影响的功能}
**决议时间**: {时间}
**决议人**: {姓名}
```

### 5. 回填审查文档(可选)

如存在 `requirement-review.md`,将决议同步回填到对应FR的确认项。

### 6. 验证闭环

生成摘要报告,确保所有问题已处理:
- 统计已澄清/待澄清/不需澄清数量
- 列出影响的功能和文档
- 明确后续行动

## 示例

<details>
<summary>完整澄清示例: 库存不足处理</summary>

```markdown
## [NEEDS CLARIFICATION] 业务规则: 库存不足处理

**当前描述**: 用户可以下单购买商品

**关联功能**: 订单功能(FR-1)

**需要澄清的问题**:
1. 库存不足时,是否允许下单?
2. 如何提示用户?

**方案选项**(三选一):
- **方案A: 拒绝下单**
  - 提示 "库存不足",不创建订单
  - 优点: 逻辑简单,避免超卖
  - 缺点: 用户体验稍差
  
- **方案B: 支持预下单**
  - 订单状态为 "待补货",补货后发货
  - 优点: 用户体验好,不丢失订单
  - 缺点: 增加状态管理复杂度

**建议方案**: 方案A
- 理由: 初期逻辑简单,后期可升级为方案B

**影响评估**:
- 业务流程无法确定
- 用户体验不一致
- 后期大量返工

---

## [CLARIFIED] 业务规则: 库存不足处理

**决议**: 方案A(拒绝下单)
**理由**: 初期逻辑简单,避免超卖风险

**验收标准**:
1. 库存不足时提示 "库存不足,请稍后再试"
2. 不创建订单记录
3. 不扣减库存

**影响范围**: 订单功能、库存功能
**决议时间**: 2025-11-07 10:30
**决议人**: 产品经理张三
```

</details>

## 常见问题

**Q: 需求审查文档不存在怎么办?**  
A: 可独立使用,直接基于PRD/用户故事进行澄清。

**Q: 产品经理拒绝回答?**  
A: 标记状态为 `[NOT-NEEDED]`,记录拒绝原因。

**Q: 如何处理跨功能问题?**  
A: 关联到主要功能,在影响范围中说明其他功能。

## 相关技能

- [需求审查](mdc:skills/req-review/SKILL.md) - 前置技能(可选)
- [需求分解](mdc:skills/req-breakdown/SKILL.md) - 后置技能(可选)
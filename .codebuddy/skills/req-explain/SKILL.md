---
name: req-explain
description: 将原始需求转化为清晰的功能性需求和验收标准，通过澄清循环消除歧义
category: requirements
keywords: [需求解释, 需求说明, 文档编写, 用例说明, 通俗易懂]
---

# Skill: 需求解读

> ⚠️ **必须遵守**: [通用规范](mdc:.codebuddy/spec/global/standards/common/index.md)、[文档生成规则](mdc:.codebuddy/spec/global/standards/common/document-generation-rules.md)、[输出目录规范](mdc:.codebuddy/spec/global/standards/common/output-directory-standard.md)

## 🎯 目标与范围

将原始需求转化为结构化的功能性需求，通过澄清循环消除歧义，为后续设计开发提供明确基线。

**核心职责**:
- 分析业务目标和用户价值
- 分解功能点（FR）与非功能需求（NFR）
- 识别业务规则和异常场景
- 通过澄清闭环消除理解歧义
- 定义可测试的验收标准

**不涉及**: 技术选型、架构设计、接口定义、数据库设计

## 📋 前置条件

**必需输入**:
- 需求来源（PRD、用户故事、文档链接）
- 变更 ID（格式: `YYYY-MM-DD-feature-name`）

**可选参考**:
- `workspace/{变更ID}/requirements/requirement-review.md`
- `workspace/{变更ID}/requirements/clarifications.md`

**输出约束**:
- 未提供变更 ID → 仅分析，不生成文档
- 有待澄清项 → 直接澄清，不调用其他技能
- 用户未确认 → 不输出文档

## 🔄 执行流程

## 🔄 执行流程

### 1. 收集和验证输入

询问需求来源和变更 ID，读取相关文档（requirement-review.md、clarifications.md）。

**验证项**:
- [ ] 需求来源已提供
- [ ] 变更 ID 格式正确
- [ ] 识别待澄清项数量

### 2. 需求分析

#### 业务目标理解
- 业务背景和解决的问题
- 用户价值和业务目标
- 成功指标（可量化）

#### 功能点分解（FR）

每个功能点包含:
```markdown
### FR-001: [功能名称]

**功能描述**: [核心目标和用户价值]
**用户场景**: [使用场景描述]
**输入/输出**: [关键参数和返回]
**业务规则**: [约束条件和逻辑]
**异常处理**: [错误场景和处理]

**验收标准**:
- [ ] 正常场景: [具体测试]
- [ ] 边界条件: [边界测试]
- [ ] 异常情况: [异常测试]

**确认项** (P0/P1/P2):
- [NEEDS CLARIFICATION] [待澄清问题]
- [CLARIFIED] [已澄清问题]
  - 决议: [选择方案]
  - 理由: [决策依据]
  - 验收标准: [具体标准]
```

#### 非功能需求（NFR）

关注用户可感知的要求:
- 性能: 响应时间、并发处理
- 安全: 权限控制、数据保护
- 可用性: 稳定性、容错性
- 易用性: 用户体验、操作流程

### 3. 澄清循环（强约束）

**触发条件**: 任一 FR 存在 `[NEEDS CLARIFICATION]` 标记

**澄清流程**:
1. 提取待澄清项，按优先级排序（P0 > P1 > P2）
2. 逐个发起澄清，提供 2-4 个互斥选项
3. 记录决议到对应 FR，更新状态为 `[CLARIFIED]`
4. 重复直至所有 P0/P1 确认项关闭

**提问模板**:
```
📋 澄清问题: [问题描述]

选项:
a) [方案 A] - [说明和影响]
b) [方案 B] - [说明和影响]
c) [方案 C] - [说明和影响]

请选择（a/b/c）或提供其他建议。
```

**保护性规则**:
- ❌ 不删除既有确认项原有内容
- ✅ 只能追加决议、理由、验收标准
- ✅ 同步更新 requirement-review.md 和 clarifications.md

### 4. 补充信息收集

所有确认项处理完成后，主动询问:
```
✅ 待澄清项已处理。请确认:

1. 是否还有其他功能需求？
2. 是否有其他非功能性需求？
3. 是否有其他业务规则或异常场景？

无补充请回复\"无补充\"。
```

优先原地修改现有文档（requirement-review.md）。

### 5. 生成最终文档（输出控制）

**前置条件**（全部满足才输出）:
- ✅ 用户确认\"无待澄清项\"
- ✅ 用户确认\"无补充信息\"
- ✅ 用户回复\"确认生成\"
- ✅ 提供了有效变更 ID

**文档结构**:
```yaml
---
change_id: YYYY-MM-DD-feature-name
stage: requirements
document_type: requirements_specification
author: [用户名]
status: final
---

# 需求规格说明书

## 1. 概述
- 需求来源
- 变更 ID
- 变更范围

## 2. 业务目标
[步骤 2 的业务目标分析]

## 3. 功能性需求（FR）
[所有 FR，包含确认项状态]

## 4. 非功能性需求（NFR）
[性能、安全、可用性、易用性]

## 5. 验收标准总览
- 功能验收清单
- 非功能验收清单

## 6. 附录
- 变更历史
- 参考文档
```

**输出路径**: `workspace/{变更ID}/requirements/requirements.md`

## ✅ 验收清单

**需求理解**:
- [ ] 业务目标清晰
- [ ] 所有功能点有验收标准
- [ ] 业务规则明确
- [ ] 异常场景有处理方式

**澄清完整性**:
- [ ] P0/P1 确认项已澄清
- [ ] 用户确认无待澄清项
- [ ] 决议已记录到 FR

**文档质量**:
- [ ] YAML Frontmatter 正确
- [ ] 路径符合规范
- [ ] 无空章节
- [ ] 确认项已标记状态

## 💡 关键原则

1. **关注业务而非技术**: 描述"做什么"，不描述"怎么做"
2. **验收标准可测试**: 使用具体、可验证的描述
3. **及时澄清疑问**: 提供选项而非开放式问题
4. **覆盖异常场景**: 正常、边界、异常三类情况

**常见错误**:
```
❌ 使用 MySQL 存储用户信息 (这是设计)
✅ 系统能够持久化存储用户信息 (这是需求)

❌ 用户注册功能正常工作 (不可测试)
✅ 输入有效邮箱和密码，系统成功创建账号 (可测试)
```

## 🔗 联动关系

**前置技能**（可选参考）:
- [需求审查](mdc:skills/req-review/SKILL.md) → requirement-review.md
- [需求澄清](mdc:skills/req-clarify/SKILL.md) → clarifications.md

**后续技能**:
- [需求拆解](mdc:skills/req-breakdown/SKILL.md) - 拆解为开发任务
- 数据库设计、接口设计、架构设计等

**独立性**: 可直接基于用户提供的需求来源运行，不强制依赖前置技能产物。

## 📚 使用方式

```
需求解读: [需求来源或链接]，变更ID: [YYYY-MM-DD-feature-name]
```

**示例**:
```
需求解读: https://tapd.xxx/story/detail/xxx，变更ID: 2025-11-04-user-registration
需求解读: ./docs/requirements.md，变更ID: 2025-11-04-payment-flow
```
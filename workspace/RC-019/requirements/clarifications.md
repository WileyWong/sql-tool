# RC-019 需求澄清文档

---
name: 多语言遗漏修复与文件标题优化
change_id: RC-019
created_at: 2026-02-04
updated_at: 2026-02-04
---

## 执行策略

**推进方式**: 一次性全部确认（需求较为明确，功能点相互独立）

**澄清范围**: 
- 业务规则（执行历史容量、淘汰策略）
- 异常边界（文件保存冲突、拖拽边界）
- 交互细节（Tooltip 显示逻辑）

---

## [CLARIFIED] 业务规则: 消息面板历史记录容量管理

**当前描述**: 消息面板最多保留 100 条执行记录，采用 FIFO 淘汰策略

**关联功能**: 消息面板执行历史(FR-8)

**决议**: 采用方案A的变体 - 单标签页独立计算，不持久化，不支持下动清空

**决议详情**:
1. ✅ 100 条限制是每个标签页独立计算
2. ✅ 历史记录不需要持久化
3. ✅ 不提供手动清空历史记录的功能
4. ✅ 编辑器标签页关闭后，该标签页的历史记录数据随之销毁

**理由**: 单标签页历史更符合编辑器使用习惯，逻辑简单，隔离性好

**验收标准**:
- 每个编辑器标签页维护自己的 100 条历史记录
- 应用重启后历史清空
- 标签页关闭后该标签历史清空
- 达到 100 条时自动淘汰最旧的一条

**影响范围**: 消息面板执行历史功能
**决议时间**: 2026-02-04
**决议人**: 产品经理

---

## [CLARIFIED] 业务规则: 未保存文件的 Tooltip 显示

**当前描述**: 鼠标悬停在未保存文件标签上，Tooltip 显示"未保存"或不显示路径

**关联功能**: 文件标题显示优化(FR-4)

**决议**: 采用方案B - 区分两种状态显示

**决议详情**:
- 从未保存: 显示 "未保存"
- 已保存但已修改: 显示完整路径 + "(已修改)"

**理由**: 已保存后修改的文件，用户需要知道原文件路径；VSCode 等编辑器也是这种处理方式

**验收标准**:
1. 从未保存文件悬停显示 "未保存"
2. 已保存但已修改的文件悬停显示 `{完整路径} (已修改)`
3. 已保存且未修改的文件悬停显示完整路径

**影响范围**: 文件标题显示优化功能
**决议时间**: 2026-02-04
**决议人**: 产品经理

---

## [CLARIFIED] 异常边界: SQL 语句超长截断显示

**当前描述**: SQL 语句截断规则：单行显示，超长时截断并添加 "..." 后缀，建议最大显示长度 80-100 字符

**关联功能**: 消息面板执行历史(FR-6)

**决议**: 采用方案A - 固定最大长度 100 字符，复制完整 SQL

**决议详情**:
- SQL 语句最大显示长度固定为 100 字符
- 超长时截断并添加 "..." 后缀
- 点击复制按钮复制完整 SQL（非截断版本）

**理由**: RC-019 是修复类需求，避免引入过多复杂度；100 字符已足够显示关键 SQL 信息

**验收标准**:
1. SQL 语句显示最大长度为 100 字符
2. 超过 100 字符时截断并添加 "..." 后缀
3. 点击复制按钮复制完整 SQL 语句

**影响范围**: 消息面板执行历史功能
**决议时间**: 2026-02-04
**决议人**: 产品经理

---

## [CLARIFIED] 业务规则: 标签页拖拽排序持久化

**当前描述**: 支持鼠标拖拽标签页改变其排列顺序，拖拽结束后标签顺序立即生效

**关联功能**: 编辑器标签页拖动排序(FR-9)

**决议**: 采用方案A - 不持久化，仅内存中调整

**决议详情**:
- 标签拖拽排序仅在当前会话有效
- 应用重启后不恢复上次调整的顺序
- 保持现有逻辑不变

**理由**: RC-019 是修复类需求，保持简单；且标签页通常是临时工作区，重启后重新排列是可接受的

**验收标准**:
1. 拖拽可改变标签页顺序
2. 重启应用后标签顺序不保留
3. 保持现有标签打开逻辑不变

**影响范围**: 编辑器标签页拖动排序功能
**决议时间**: 2026-02-04
**决议人**: 产品经理

---

## [CLARIFIED] 业务规则: 复制成功提示方式

**当前描述**: 点击"复制"链接后复制该次执行的完整 SQL 语句到剪贴板，复制成功后给出短暂提示

**关联功能**: 消息面板执行历史(FR-7)

**决议**: 采用方案B - 按钮文字变化

**决议详情**:
- 按钮文字从"复制"变为"已复制"
- 2 秒后恢复"复制"
- 无需额外组件

**理由**: 轻量实现，符合当前项目的简洁风格；类似 GitHub 的复制按钮交互

**验收标准**:
1. 点击复制按钮后，按钮文字变为"已复制"
2. 2 秒后按钮文字自动恢复为"复制"
3. 完整 SQL 语句被复制到剪贴板

**影响范围**: 消息面板执行历史功能
**决议时间**: 2026-02-04
**决议人**: 产品经理

---

## 澄清问题汇总

| 序号 | 问题类别 | 问题概述 | 决议方案 | 状态 |
|------|----------|----------|----------|------|
| 1 | 业务规则 | 历史记录容量管理 | 单标签页独立，不持久化，不支持下动清空 | ✅ 已确认 |
| 2 | 业务规则 | 未保存文件 Tooltip | 方案B：区分状态显示 | ✅ 已确认 |
| 3 | 异常边界 | SQL 截断显示规则 | 方案A：固定 100 字符 | ✅ 已确认 |
| 4 | 业务规则 | 拖拽排序持久化 | 方案A：不持久化 | ✅ 已确认 |
| 5 | 业务规则 | 复制成功提示方式 | 方案B：按钮文字变化 | ✅ 已确认 |

---

## 验证闭环

**统计**:
- 已澄清: 5 个
- 待澄清: 0 个
- 不需澄清: 0 个

**影响的功能**:
- FR-4: 文件路径悬停提示
- FR-6: 消息面板执行历史 - 显示 SQL 语句
- FR-7: 消息面板执行历史 - 复制 SQL 功能
- FR-8: 消息面板执行历史 - 追加策略
- FR-9: 编辑器标签页拖动排序

**后续行动**:
1. ✅ 所有澄清问题已确认
2. 🔄 更新验收标准（见 requirement-review.md）
3. ✅ 可进入设计阶段

---

*文档创建时间: 2026-02-04*  
*更新时间: 2026-02-04*  
*所有问题已澄清，可进入设计阶段*

# RC-018 多语言支持（国际化）

## 1. 需求概述

| 项目 | 内容 |
|------|------|
| 需求编号 | RC-018 |
| 需求名称 | 多语言支持（国际化 / i18n） |
| 提出日期 | 2026-01-29 |
| 优先级 | 中 |

### 1.1 背景
当前应用的所有界面文本均为硬编码中文，无法满足不同语言用户的使用需求。为了提升产品的国际化能力和用户体验，需要为应用添加多语言支持。

### 1.2 目标
1. 建立完整的国际化框架
2. 支持简体中文、繁体中文、英文三种语言
3. 用户可在设置中切换语言
4. 语言偏好持久化存储

---

## 2. 需求详情

### 2.1 支持的语言

| 语言代码 | 语言名称 | 说明 |
|----------|----------|------|
| zh-CN | 简体中文 | - |
| zh-TW | 繁體中文 | - |
| en-US | English | 默认回退语言 |

**默认语言**：跟随系统语言，如系统语言不在支持列表中则使用英文（en-US）

### 2.2 国际化范围

所有界面上显示的文字，包括提示消息、按钮、标签等文字，均需支持国际化。

### 2.3 功能设计

#### 2.3.1 设置对话框

**入口位置**
- 菜单路径：文件 → 设置
- 快捷键：无（可选后续添加）

**对话框布局**
```
┌─────────────────────────────────────────────────────┐
│  设置                                          [×] │
├─────────────────────────────────────────────────────┤
│  ┌──────────┐  ┌──────────────────────────────────┐ │
│  │          │  │                                  │ │
│  │  语言    │  │  界面语言                        │ │
│  │  ←选中   │  │                                  │ │
│  │          │  │  ○ 简体中文                      │ │
│  │          │  │  ○ 繁體中文                      │ │
│  │          │  │  ● English                       │ │
│  │          │  │                                  │ │
│  │          │  │                                  │ │
│  │          │  │                                  │ │
│  └──────────┘  └──────────────────────────────────┘ │
│                              [ 重置 ]  [ 应用 ]    │
└─────────────────────────────────────────────────────┘
     左侧导航              右侧设置内容
```

**布局说明**
| 区域 | 说明 |
|------|------|
| 左侧导航 | 设置分类列表，当前仅"语言"一项，预留扩展空间 |
| 右侧内容 | 当前选中分类的具体设置项 |
| 底部按钮 | 重置、应用按钮 |

**语言设置项**
| 设置项 | 控件类型 | 选项 |
|--------|----------|------|
| 界面语言 | 单选按钮组 | 简体中文、繁體中文、English |

**按钮说明**
| 按钮 | 说明 |
|------|------|
| 应用 | 保存设置并应用语言切换 |
| 重置 | 撤销未保存的修改，恢复到当前生效的设置 |

**交互行为**
1. 点击左侧导航项切换右侧内容
2. 选择语言后，点击"应用"按钮才生效
3. 点击"重置"按钮撤销未保存的修改
4. 关闭对话框时，未应用的修改将丢失

#### 2.3.2 语言偏好存储
| 存储位置 | 说明 |
|----------|------|
| localStorage | 存储用户选择的语言偏好 |
| 键名 | `sql-tool-locale` |
| 默认值 | 跟随系统语言 |

#### 2.3.3 初始化逻辑
```
1. 读取 localStorage 中的语言偏好
2. 如果未设置，检测系统语言（navigator.language）
3. 如果系统语言不在支持列表中（zh-CN、zh-TW、en-US），使用英文（en-US）
4. 应用语言设置
```

### 2.4 不处理的内容
| 内容 | 说明 |
|------|------|
| 日期格式 | 保持统一格式，不随语言变化 |
| 数字格式 | 保持统一格式，不随语言变化 |
| SQL 关键字 | 保持英文（SELECT、FROM、WHERE 等） |
| 技术术语 | 保持英文（NULL、PRIMARY KEY 等） |

---

## 3. 验收标准

### 3.1 功能验收
| 编号 | 测试场景 | 预期结果 |
|------|----------|----------|
| TC01 | 点击"文件 → 设置"菜单 | 打开设置对话框 |
| TC02 | 设置对话框布局 | 左侧导航、右侧设置内容、底部按钮（重置、应用） |
| TC03 | 选择语言后点击"应用" | 界面文本切换，设置保存 |
| TC04 | 选择语言后点击"重置" | 恢复到当前生效的语言选项 |
| TC05 | 选择语言后直接关闭对话框 | 设置不生效，保持原语言 |
| TC06 | 默认启动应用（系统简体中文） | 界面显示简体中文 |
| TC07 | 默认启动应用（系统繁体中文） | 界面显示繁体中文 |
| TC08 | 默认启动应用（系统英文） | 界面显示英文 |
| TC09 | 默认启动应用（系统日文等其他语言） | 界面显示英文 |
| TC10 | 重启应用 | 保持上次应用的语言 |
| TC11 | 清除缓存后启动 | 跟随系统语言 |

### 3.2 覆盖率验收
| 检查项 | 标准 |
|--------|------|
| 按钮文本 | 100% 国际化 |
| 菜单项 | 100% 国际化 |
| 提示消息 | 100% 国际化 |
| 表单标签 | 100% 国际化 |
| 占位符 | 100% 国际化 |
| 对话框 | 100% 国际化 |

---

## 4. 非功能需求

| 需求类型 | 描述 |
|----------|------|
| 性能 | 语言切换应即时生效，无明显延迟 |
| 可维护性 | 语言包结构清晰，便于添加新语言 |
| 可扩展性 | 预留添加其他语言的能力 |
| 兼容性 | 不影响现有功能 |

---

## 5. 变更历史

| 日期 | 变更内容 | 状态 |
|------|----------|------|
| 2026-01-29 | 初始创建 | 待确认 |

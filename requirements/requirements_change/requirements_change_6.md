# 需求变更单

## 基本信息

| 项目 | 内容 |
|------|------|
| 变更编号 | RC-006 |
| 变更日期 | 2026-01-12 |
| 提出人 | |
| 优先级 | P1-高低 |
| 影响范围 | 全栈 |

---

## 1. 变更概述

> 一些在使用过程中发现的使用上的问题，转成需求
>
> 使用相关技能，【必须】先进行需求分析、澄清、方案设计后，再开始编码。同时需要更新memory和workplace

---

## 2. 变更内容

### 2.1 功能需求

> 详细描述需要实现的功能

| 序号 | 功能点 | 描述 | 验收标准 |
|------|--------|------|----------|
| 1 | 每一个编辑器中的sql查询结果页签只需要显示一个 | 执行一个新的后，覆盖上次执行的。而不是像现在一样每执行一次sql查询都多了一个结果页签。结果N，改名为“结果” | |
| 2 | 优化：一个编辑器打开过久， 连接貌似会关闭，再次执行sql语句会提示没有连接 | 一个编辑器连接的数据库太久，再次执行sql时，会提示：[E4003] 切换数据库失败: Can't add new command when connection is in closed state。修复这个问题 | |
| 3 | 每一个编辑器上方的服务器、数据库 太多时不好找，允许输入过滤 | 下拉选择，改成根据输入内容过滤后选择下拉值 | |
| 4 | 左侧数据库的树状组件允许输入过滤 | 鼠标划到数据库节点时，后面多出“过滤”浮动按钮，点击后，变成文本框，输入内容后，下方的表、视图、函数等所有子节点，根据输入内容过滤 | |
| 5 | 在sql查询结果中编辑json字段类型的问题 | 双击json字段类型，显示的是 [object Object],[object Object]，无法直接编辑 | |
| 6 | 左侧树状组件点刷新有新增表，sql编辑器中没有刷新这个表相关的列信息 | 输入时可以联想这张新表，但是联想不了这个表中的列 | |

---

## 4. 输入输出示例及需求的操作说明

### 每一个编辑器中的sql查询结果只需要显示一个

**操作：**
打开一个新的编辑器，输入一个select语句，执行。再输入另一个select语句，执行。

**期望输出：**
- 第一个sql语句显示“结果”页签 。 第二个sql语句在“结果”页签显示执行结果，覆盖第一个sql语句的执行结果。
- 如果第一个Sql的结果有修改，在执行第二个语句前提示用户是否保存，还是放弃 ，或者是取消（弹窗提醒用户，有三个按钮：提交、放弃、取消）
- 提交：提交第一个的修改，并执行第二个sql语句。
- 放弃：放弃第一个的修改，执行第二个sql语句。
- 取消：取消本次sql语句的执行。

### 每一个编辑器上方的服务器、数据库 太多时不好找，允许输入过滤

**操作：**
sql编辑器上方的服务器、数据库 允许输入，输入后过滤下拉的值，以方便用户选择

### 左侧数据库的树状组件允许输入过滤

**操作：**
sql编辑器上方的服务器、数据库 允许输入，输入后过滤下拉的值，以方便用户选择

---

## 6. 测试用例

> 用于验证变更是否正确实现

| 用例ID | 场景 | 输入 | 期望结果 |
|--------|------|------|----------|
| TC01 | 每一个编辑器中的sql查询结果页签只需要显示一个 | 在同一个编辑器中依次执行两个sql语句 | 第二个会覆盖第一个sql语句的执行结果 |
| TC02 | 每一个编辑器中的sql查询结果页签只需要显示一个：如果前一个结果有修改需要提示 | 在同一个编辑器中依次执行两个sql语句 | 第二个会覆盖第一个sql语句的执行结果，如果前一个结果有修改需要提示 |
| TC03 | 一个编辑器打开过久， 连接貌似会关闭，再次执行sql语句会提示没有连接 | 在一个编辑器，连接数据库，输入sql后，停留半天， 再次执行sql | 可以正常执行 |
| TC04 | 每一个编辑器上方的服务器、数据库 太多时不好找，允许输入过滤 | 编辑器上方的服务器、数据库下拉选择，可以输入联想过滤 | 选择过滤后的数据库服务器或者库，当前编辑器切换到这个数据库服务器或者库 |
| TC05 | 在sql查询结果中编辑json字段类型的问题 | select一个结果，其中包含json字段类型，双击json字段 | 可以直接编辑，其中内容按字符串展示JSO数据 |
| TC06 | 左侧树状组件点刷新有新增表，sql编辑器中没有刷新这个表相关的列信息 | 给表新加一个新列（修改一个列、删除一个列），在左侧树状组件对应的“表”节点上，右键点击刷新 | 在sql编辑器中输入sql语句，可以联想这个新增、修改的列，删除掉的列联想不到 |
---